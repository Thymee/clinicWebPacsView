/*! cornerstone-tools - 2.1.0 - 2018-03-13 | (c) 2017 Chris Hafey | https://github.com/cornerstonejs/cornerstoneTools */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("cornerstoneTools",[],t):"object"==typeof exports?exports.cornerstoneTools=t():e.cornerstoneTools=t()}("undefined"!=typeof self?self:this,function(){return function(e){function t(n){if(a[n])return a[n].exports;var o=a[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var a={};return t.m=e,t.c=a,t.d=function(e,a,n){t.o(e,a)||Object.defineProperty(e,a,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var a=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(a,"a",a),a},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=61)}([function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=window.cornerstone,o=window.cornerstoneMath,r=window.$,i=window.Hammer;t.default={set cornerstone(e){n=e},get cornerstone(){return n},set cornerstoneMath(e){o=e},get cornerstoneMath(){return o},set $(e){r=e},get $(){return r},set Hammer(e){i=e},get Hammer(){return i}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={IMAGE_RENDERED:"cornerstoneimagerendered",NEW_IMAGE:"cornerstonenewimage",IMAGE_CACHE_PROMISE_REMOVED:"cornerstoneimagecachepromiseremoved",ELEMENT_DISABLED:"cornerstoneelementdisabled",MOUSE_DOWN:"cornerstonetoolsmousedown",MOUSE_UP:"cornerstonetoolsmouseup",MOUSE_DOWN_ACTIVATE:"cornerstonetoolsmousedownactivate",MOUSE_DRAG:"cornerstonetoolsmousedrag",MOUSE_MOVE:"cornerstonetoolsmousemove",MOUSE_CLICK:"cornerstonetoolsmouseclick",MOUSE_DOUBLE_CLICK:"cornerstonetoolsmousedoubleclick",MOUSE_WHEEL:"cornerstonetoolsmousewheel",TOUCH_START:"cornerstonetoolstouchstart",TOUCH_START_ACTIVE:"cornerstonetoolstouchstartactive",TOUCH_END:"cornerstonetoolstouchend",TOUCH_DRAG:"cornerstonetoolstouchdrag",TOUCH_DRAG_END:"cornerstonetoolstouchdragend",TOUCH_PINCH:"cornerstonetoolstouchpinch",TOUCH_ROTATE:"cornerstonetoolstouchrotate",TOUCH_PRESS:"cornerstonetoolstouchpress",TAP:"cornerstonetoolstap",DOUBLE_TAP:"cornerstonetoolsdoubletap",MULTI_TOUCH_START:"cornerstonetoolsmultitouchstart",MULTI_TOUCH_START_ACTIVE:"cornerstonetoolsmultitouchstartactive",MULTI_TOUCH_DRAG:"cornerstonetoolsmultitouchdrag",KEY_DOWN:"cornerstonetoolskeydown",KEY_UP:"cornerstonetoolskeyup",KEY_PRESS:"cornerstonetoolskeypress",MEASUREMENT_ADDED:"cornerstonetoolsmeasurementadded",MEASUREMENT_MODIFIED:"cornerstonetoolsmeasurementmodified",MEASUREMENT_REMOVED:"cornerstonemeasurementremoved",TOOL_DEACTIVATED:"cornerstonetoolstooldeactivated",CLIP_STOPPED:"cornerstonetoolsclipstopped",STACK_SCROLL:"cornerstonestackscroll",LINE_SAMPLE_UPDATED:"cornerstonelinesampleupdated"};t.default=n},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e){var t=v.default.cornerstone.getEnabledElement(e);return void 0===t.toolStateManager&&(t.toolStateManager=m.globalImageIdSpecificToolStateManager),t.toolStateManager}function r(e,t,a){o(e).add(e,t,a);var n=c.default.MEASUREMENT_ADDED,r={toolType:t,element:e,measurementData:a};(0,h.default)(e,n,r)}function i(e,t){return o(e).get(e,t)}function l(e,t,a){for(var n=o(e),r=n.get(e,t),i=-1,l=0;l<r.data.length;l++)r.data[l]===a&&(i=l);if(-1!==i){r.data.splice(i,1);var d=c.default.MEASUREMENT_REMOVED,u={toolType:t,element:e,measurementData:a};(0,h.default)(e,d,u)}}function d(e,t){var a=o(e),n=a.get(e,t);void 0!==n&&(n.data=[])}function u(e,t){v.default.cornerstone.getEnabledElement(e).toolStateManager=t}Object.defineProperty(t,"__esModule",{value:!0}),t.getElementToolStateManager=t.setElementToolStateManager=t.clearToolState=t.removeToolState=t.getToolState=t.addToolState=void 0;var s=a(1),c=n(s),f=a(0),v=n(f),m=a(19),g=a(5),h=n(g);t.addToolState=r,t.getToolState=i,t.removeToolState=l,t.clearToolState=d,t.setElementToolStateManager=u,t.getElementToolStateManager=o},function(e,t,a){"use strict";function n(e,t){if(!d[e])return{};var a=d[e],n=a.find(function(e){return e.element===t});return n?n.options:{}}function o(e,t,a){if(!d[e])return void(d[e]=[{element:t,options:a}]);var n=d[e],o=n.findIndex(function(e){return e.element===t});if(-1===o)d[e].push({element:t,options:a});else{var r=d[e][o].options||{};d[e][o].options=Object.assign(r,a)}}function r(e,t){var a=d[e];a&&(d[e]=a.filter(function(e){return e.element!==t}))}function i(e){delete d[e]}function l(e){for(var t in d)d[t]=d[t].filter(function(t){return t.element!==e})}Object.defineProperty(t,"__esModule",{value:!0});var d={};t.getToolOptions=n,t.setToolOptions=o,t.clearToolOptions=r,t.clearToolOptionsByToolType=i,t.clearToolOptionsByElement=l},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return 0!=(t&1<<e-1)}},function(e,t,a){"use strict";function n(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=void 0;return"function"==typeof window.CustomEvent?n=new CustomEvent(t,{detail:a,cancelable:!0}):(n=document.createEvent("CustomEvent"),n.initCustomEvent(t,!0,!0,a)),e.dispatchEvent(n)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=n},function(e,t,a){"use strict";function n(e){f=e}function o(){return f}function r(e){s=e}function i(){return s}function l(e){c=e}function d(){return c}function u(e){return e?c:s}Object.defineProperty(t,"__esModule",{value:!0});var s="yellow",c="greenyellow",f="transparent",v={setFillColor:n,getFillColor:o,setToolColor:r,getToolColor:i,setActiveColor:l,getActiveColor:d,getColorIfActive:u};t.default=v},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,a,n,r,i){"[object Array]"!==Object.prototype.toString.call(t)&&(t=[t]);var l=o.default.getFont(),d=o.default.getFontSize(),u=o.default.getBackgroundColor();e.save(),e.font=l,e.textBaseline="top",e.strokeStyle=r;var s=0;t.forEach(function(t){var a=e.measureText(t).width;s=Math.max(s,a)}),e.fillStyle=u;var c={width:s+10,height:5+t.length*(d+5)};return i&&i.centering&&!0===i.centering.x&&(a-=c.width/2),i&&i.centering&&!0===i.centering.y&&(n-=c.height/2),c.left=a,c.top=n,i&&!0===i.debug&&(e.fillStyle="#FF0000"),e.fillRect(c.left,c.top,c.width,c.height),t.forEach(function(t,o){e.fillStyle=r,e.fillText(t,a+5,n+5+o*(d+5))}),e.restore(),c};var n=a(14),o=function(e){return e&&e.__esModule?e:{default:e}}(n)},function(e,t,a){"use strict";function n(e){l=e}function o(){return l}function r(e){d=e}function i(){return d}Object.defineProperty(t,"__esModule",{value:!0});var l=1,d=2,u={setToolWidth:n,getToolWidth:o,setActiveWidth:r,getActiveWidth:i};t.default=u},function(e,t,a){"use strict";function n(e){u=e}function o(){return u}function r(e){s=e}function i(){return s}function l(e){c=e}function d(){return c}Object.defineProperty(t,"__esModule",{value:!0});var u=void 0,s=void 0,c=void 0,f={setStartLoadHandler:n,getStartLoadHandler:o,setEndLoadHandler:r,getEndLoadHandler:i,setErrorLoadingHandler:l,getErrorLoadingHandler:d};t.default=f},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){function t(t){var a=t.detail,n=a.element,r=(0,S.getToolOptions)(M,n);(0,O.default)(a.which,r.mouseButtonMask)&&(e.addNewMeasurement?e.addNewMeasurement(a):o(a),t.preventDefault(),t.stopPropagation())}function a(t){var a=t.detail;u.default.setCoords(a);var n=(0,P.getToolState)(a.element,M);if(n){for(var o=!1,r=0;r<n.data.length;r++){var i=a.currentPoints.canvas,d=n.data[r];!0===(0,v.default)(a.element,d.handles,i)&&(o=!0),(e.pointNearTool(a.element,d,i)&&!d.active||!e.pointNearTool(a.element,d,i)&&d.active)&&(d.active=!d.active,o=!0)}!0===o&&l.default.cornerstone.updateImage(a.element)}}function n(t){function a(){o.invalidated=!0,(0,y.default)(n,o.handles)&&(0,P.removeToolState)(i,M,o),l.default.cornerstone.updateImage(i),i.addEventListener(r.default.MOUSE_MOVE,x)}var n=t.detail,o=void 0,i=n.element,d=(0,S.getToolOptions)(M,i);if((0,O.default)(n.which,d.mouseButtonMask)){var u=n.startPoints.canvas,s=(0,P.getToolState)(t.currentTarget,M);if(s){var f=void 0,v=void 0;for(v=!(!e.options||void 0===e.options.preventHandleOutsideImage)&&e.options.preventHandleOutsideImage,f=0;f<s.data.length;f++){o=s.data[f];var m=(0,c.default)(i,o.handles,u,6);if(m)return i.removeEventListener(r.default.MOUSE_MOVE,x),o.active=!0,(0,g.default)(n,M,o,m,a,v),t.stopImmediatePropagation(),t.stopPropagation(),void t.preventDefault()}if(e.pointNearTool){var h=e.options||{deleteIfHandleOutsideImage:!0,preventHandleOutsideImage:!1};for(f=0;f<s.data.length;f++)if(o=s.data[f],o.active=!1,e.pointNearTool(i,o,u))return o.active=!0,i.removeEventListener(r.default.MOUSE_MOVE,x),(0,T.default)(t,o,s,M,h,a),t.stopImmediatePropagation(),t.stopPropagation(),void t.preventDefault()}}}}function o(t){var a=l.default.cornerstone,n=t.element,o=e.createNewMeasurement(t);if(o){(0,P.addToolState)(t.element,M,o),n.removeEventListener(r.default.MOUSE_MOVE,x),n.removeEventListener(r.default.MOUSE_DOWN,_),n.removeEventListener(r.default.MOUSE_DOWN_ACTIVATE,C),I&&n.removeEventListener(r.default.MOUSE_DOUBLE_CLICK,I),a.updateImage(n);var i=void 0;i=1===Object.keys(o.handles).length?g.default:p.default;var d=void 0;d=!(!e.options||void 0===e.options.preventHandleOutsideImage)&&e.options.preventHandleOutsideImage,i(t,M,o,o.handles.end,function(){o.active=!1,o.invalidated=!0,(0,y.default)(t,o.handles)&&(0,P.removeToolState)(n,M,o),n.addEventListener(r.default.MOUSE_MOVE,x),n.addEventListener(r.default.MOUSE_DOWN,_),n.addEventListener(r.default.MOUSE_DOWN_ACTIVATE,C),I&&n.addEventListener(r.default.MOUSE_DOUBLE_CLICK,I),a.updateImage(n)},d)}}function i(t){t.removeEventListener(r.default.IMAGE_RENDERED,e.onImageRendered),t.removeEventListener(r.default.MOUSE_MOVE,x),t.removeEventListener(r.default.MOUSE_DOWN,_),t.removeEventListener(r.default.MOUSE_DOWN_ACTIVATE,C),I&&t.removeEventListener(r.default.MOUSE_DOUBLE_CLICK,I),l.default.cornerstone.updateImage(t)}function d(t){t.removeEventListener(r.default.IMAGE_RENDERED,e.onImageRendered),t.removeEventListener(r.default.MOUSE_MOVE,x),t.removeEventListener(r.default.MOUSE_DOWN,_),t.removeEventListener(r.default.MOUSE_DOWN_ACTIVATE,C),I&&t.removeEventListener(r.default.MOUSE_DOUBLE_CLICK,I),t.addEventListener(r.default.IMAGE_RENDERED,e.onImageRendered),l.default.cornerstone.updateImage(t)}function s(t,a){(0,S.setToolOptions)(M,t,{mouseButtonMask:a}),t.removeEventListener(r.default.IMAGE_RENDERED,e.onImageRendered),t.removeEventListener(r.default.MOUSE_MOVE,x),t.removeEventListener(r.default.MOUSE_DOWN,_),t.removeEventListener(r.default.MOUSE_DOWN_ACTIVATE,C),t.addEventListener(r.default.IMAGE_RENDERED,e.onImageRendered),t.addEventListener(r.default.MOUSE_MOVE,x),t.addEventListener(r.default.MOUSE_DOWN,_),t.addEventListener(r.default.MOUSE_DOWN_ACTIVATE,C),I&&(t.removeEventListener(r.default.MOUSE_DOUBLE_CLICK,I),t.addEventListener(r.default.MOUSE_DOUBLE_CLICK,I)),l.default.cornerstone.updateImage(t)}function f(t,a){(0,S.setToolOptions)(M,t,{mouseButtonMask:a});var n=r.default.TOOL_DEACTIVATED,o={mouseButtonMask:a,toolType:M,type:n};(0,b.default)(t,n,o),t.removeEventListener(r.default.IMAGE_RENDERED,e.onImageRendered),t.removeEventListener(r.default.MOUSE_MOVE,x),t.removeEventListener(r.default.MOUSE_DOWN,_),t.removeEventListener(r.default.MOUSE_DOWN_ACTIVATE,C),t.addEventListener(r.default.IMAGE_RENDERED,e.onImageRendered),t.addEventListener(r.default.MOUSE_MOVE,x),t.addEventListener(r.default.MOUSE_DOWN,_),I&&(t.removeEventListener(r.default.MOUSE_DOUBLE_CLICK,I),t.addEventListener(r.default.MOUSE_DOUBLE_CLICK,I)),e.deactivate&&e.deactivate(t,a),l.default.cornerstone.updateImage(t)}function m(){return E}function h(e){E=e}var E={},M=e.toolType,x=e.mouseMoveCallback||a,_=e.mouseDownCallback||n,C=e.mouseDownActivateCallback||t,I=e.mouseDoubleClickCallback,w={enable:d,disable:i,activate:s,deactivate:f,getConfiguration:m,setConfiguration:h,mouseDownCallback:n,mouseMoveCallback:a,mouseDownActivateCallback:t};return e.pointNearTool&&(w.pointNearTool=e.pointNearTool),I&&(w.mouseDoubleClickCallback=I),e.addNewMeasurement&&(w.addNewMeasurement=e.addNewMeasurement),w};var o=a(1),r=n(o),i=a(0),l=n(i),d=a(37),u=n(d),s=a(21),c=n(s),f=a(38),v=n(f),m=a(23),g=n(m),h=a(24),p=n(h),E=a(39),T=n(E),M=a(15),y=n(M),x=a(4),O=n(x),P=a(2),_=a(5),b=n(_),S=a(3)},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,a,n,o){e.strokeStyle=n,Object.keys(a).forEach(function(n){var i=a[n];if(!0!==i.drawnIndependently&&(!o||!0!==o.drawHandlesIfActive||i.active)){e.beginPath(),i.active?e.lineWidth=l.default.getActiveWidth():e.lineWidth=l.default.getToolWidth();var u=r.default.cornerstone.pixelToCanvas(t.element,i);e.arc(u.x,u.y,d,0,2*Math.PI),o&&o.fill&&(e.fillStyle=o.fill,e.fill()),e.stroke()}})};var o=a(0),r=n(o),i=a(8),l=n(i),d=4},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if(e.boundingBox)return o.default.cornerstoneMath.point.insideRect(t,e.boundingBox)};var n=a(0),o=function(e){return e&&e.__esModule?e:{default:e}}(n)},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e){Object.keys(e).forEach(function(t){e[t].active=!1})}function r(e){if(e)for(var t=0;t<e.data.length;t++){var a=e.data[t];a.active=!1,a.handles&&o(a.handles)}}function i(e){function t(t){var r=s.default.cornerstone,i=t.element,l=e.createNewMeasurement(t);if(l){if((0,y.addToolState)(i,e.toolType,l),1===Object.keys(l.handles).length&&t.type===d.default.TAP)return l.active=!1,l.handles.end.active=!1,l.handles.end.highlight=!1,l.invalidated=!0,(0,f.default)(t,l.handles)&&(0,y.removeToolState)(i,e.toolType,l),void r.updateImage(i);i.removeEventListener(d.default.TOUCH_START_ACTIVE,e.touchDownActivateCallback||a),i.removeEventListener(d.default.TAP,e.tapCallback||n),i.removeEventListener(d.default.TOUCH_START,e.touchStartCallback||o),r.updateImage(i),(0,E.default)(t,e.toolType,l,l.handles.end,function(){l.active=!1,l.invalidated=!0,(0,f.default)(t,l.handles)&&(0,y.removeToolState)(i,e.toolType,l),i.addEventListener(d.default.TOUCH_START_ACTIVE,e.touchDownActivateCallback||a),i.addEventListener(d.default.TAP,e.tapCallback||n),i.addEventListener(d.default.TOUCH_START,e.touchStartCallback||o),r.updateImage(i)})}}function a(a){var n=a.detail;e.addNewMeasurement?e.addNewMeasurement(n):t(n),a.stopImmediatePropagation(),a.preventDefault()}function n(t){function i(){r(g),(0,f.default)(l,p.handles)&&(0,y.removeToolState)(c,e.toolType,p),u.updateImage(c),c.addEventListener(d.default.TOUCH_START,e.touchStartCallback||o),c.addEventListener(d.default.TAP,e.tapCallback||n)}var l=t.detail,u=s.default.cornerstone,c=l.element,v=l.currentPoints.canvas,g=(0,y.getToolState)(t.currentTarget,e.toolType),p=void 0,E=void 0;if(r(g),g)for(E=0;E<g.data.length;E++){p=g.data[E];var T=(0,m.default)(c,p.handles,v,25);if(T)return c.removeEventListener(d.default.TOUCH_START,e.touchStartCallback||o),c.removeEventListener(d.default.TAP,e.tapCallback||n),p.active=!0,T.active=!0,u.updateImage(c),(0,h.default)(t,e.toolType,p,T,i),t.stopImmediatePropagation(),void t.preventDefault()}if(g&&e.pointNearTool)for(E=0;E<g.data.length;E++)if(p=g.data[E],e.pointNearTool(c,p,v))return c.removeEventListener(d.default.TOUCH_START,e.touchStartCallback||o),c.removeEventListener(d.default.TAP,e.tapCallback||n),p.active=!0,u.updateImage(c),(0,M.default)(t,p,g,e.toolType,!0,i),t.stopImmediatePropagation(),void t.preventDefault();return e.touchDownActivateCallback?e.touchDownActivateCallback(t):a(t),!1}function o(t){function a(t,a){c.active=!1,c.invalidated=!0,(0,f.default)(r,c.handles)&&(0,y.removeToolState)(r.element,e.toolType,c),i.updateImage(r.element),l.addEventListener(d.default.TOUCH_START,e.touchStartCallback||o),l.addEventListener(d.default.TAP,e.tapCallback||n),e.pressCallback&&l.addEventListener(d.default.TOUCH_PRESS,e.pressCallback),t&&t.type===d.default.TOUCH_PRESS&&(0,O.default)(l,t.type,a)}var r=t.detail,i=s.default.cornerstone,l=r.element,u=r.startPoints.canvas,c=void 0,v=(0,y.getToolState)(t.currentTarget,e.toolType),g=void 0;if(v){for(g=0;g<v.data.length;g++){c=v.data[g];var p=(0,m.default)(r.element,c.handles,u,28);if(p)return l.removeEventListener(d.default.TOUCH_START,e.touchStartCallback||o),l.removeEventListener(d.default.TAP,e.tapCallback||n),e.pressCallback&&l.removeEventListener(d.default.TOUCH_PRESS,e.pressCallback),c.active=!0,(0,h.default)(t,e.toolType,c,p,a),t.stopImmediatePropagation(),t.preventDefault(),void t.stopPropagation()}if(e.pointNearTool)for(g=0;g<v.data.length;g++)if(c=v.data[g],e.pointNearTool(r.element,c,u))return l.removeEventListener(d.default.TOUCH_START,e.touchStartCallback||o),l.removeEventListener(d.default.TAP,e.tapCallback||n),e.pressCallback&&l.removeEventListener(d.default.TOUCH_PRESS,e.pressCallback),(0,M.default)(t,c,v,e.toolType,!0,a),t.stopImmediatePropagation(),t.preventDefault(),void t.stopPropagation()}}function i(t){t.removeEventListener(d.default.IMAGE_RENDERED,e.onImageRendered),t.removeEventListener(d.default.TOUCH_START,e.touchStartCallback||o),t.removeEventListener(d.default.TOUCH_START_ACTIVE,e.touchDownActivateCallback||a),t.removeEventListener(d.default.TAP,e.tapCallback||n),e.doubleTapCallback&&t.removeEventListener(d.default.DOUBLE_TAP,e.doubleTapCallback),e.pressCallback&&t.removeEventListener(d.default.TOUCH_PRESS,e.pressCallback),s.default.cornerstone.updateImage(t)}function l(t){t.removeEventListener(d.default.IMAGE_RENDERED,e.onImageRendered),t.removeEventListener(d.default.TOUCH_START,e.touchStartCallback||o),t.removeEventListener(d.default.TOUCH_START_ACTIVE,e.touchDownActivateCallback||a),t.removeEventListener(d.default.TAP,e.tapCallback||n),t.addEventListener(d.default.IMAGE_RENDERED,e.onImageRendered),e.doubleTapCallback&&t.removeEventListener(d.default.DOUBLE_TAP,e.doubleTapCallback),e.pressCallback&&t.removeEventListener(d.default.TOUCH_PRESS,e.pressCallback),s.default.cornerstone.updateImage(t)}function u(t){t.removeEventListener(d.default.IMAGE_RENDERED,e.onImageRendered),t.removeEventListener(d.default.TOUCH_START,e.touchStartCallback||o),t.removeEventListener(d.default.TOUCH_START_ACTIVE,e.touchDownActivateCallback||a),t.removeEventListener(d.default.TAP,e.tapCallback||n),t.addEventListener(d.default.IMAGE_RENDERED,e.onImageRendered),t.addEventListener(d.default.TOUCH_START,e.touchStartCallback||o),t.addEventListener(d.default.TOUCH_START_ACTIVE,e.touchDownActivateCallback||a),t.addEventListener(d.default.TAP,e.tapCallback||n),e.doubleTapCallback&&(t.removeEventListener(d.default.DOUBLE_TAP,e.doubleTapCallback),t.addEventListener(d.default.DOUBLE_TAP,e.doubleTapCallback)),e.pressCallback&&(t.removeEventListener(d.default.TOUCH_PRESS,e.pressCallback),t.addEventListener(d.default.TOUCH_PRESS,e.pressCallback)),s.default.cornerstone.updateImage(t)}function c(t){var r=d.default.TOOL_DEACTIVATED,i={toolType:e.toolType,type:r};(0,O.default)(t,r,i),t.removeEventListener(d.default.IMAGE_RENDERED,e.onImageRendered),t.removeEventListener(d.default.TOUCH_START,e.touchStartCallback||o),t.removeEventListener(d.default.TOUCH_START_ACTIVE,e.touchDownActivateCallback||a),t.removeEventListener(d.default.TAP,e.tapCallback||n),t.addEventListener(d.default.IMAGE_RENDERED,e.onImageRendered),t.addEventListener(d.default.TOUCH_START,e.touchStartCallback||o),e.doubleTapCallback&&t.removeEventListener(d.default.DOUBLE_TAP,e.doubleTapCallback),e.pressCallback&&t.removeEventListener(d.default.TOUCH_PRESS,e.pressCallback),s.default.cornerstone.updateImage(t)}var v={enable:l,disable:i,activate:u,deactivate:c,touchStartCallback:e.touchStartCallback||o,touchDownActivateCallback:e.touchDownActivateCallback||a,tapCallback:e.tapCallback||n};return e.pointNearTool&&(v.pointNearTool=e.pointNearTool),e.doubleTapCallback&&(v.doubleTapCallback=e.doubleTapCallback),e.pressCallback&&(v.pressCallback=e.pressCallback),e.addNewMeasurement&&(v.addNewMeasurement=e.addNewMeasurement),v}Object.defineProperty(t,"__esModule",{value:!0});var l=a(1),d=n(l),u=a(0),s=n(u),c=a(15),f=n(c),v=a(21),m=n(v),g=a(53),h=n(g),p=a(27),E=n(p),T=a(52),M=n(T),y=a(2),x=a(5),O=n(x);t.default=i},function(e,t,a){"use strict";function n(e){s=e}function o(){return s}function r(e){u=e}function i(){return u}function l(e){c=e}function d(){return c}Object.defineProperty(t,"__esModule",{value:!0});var u=13,s=u+"px Arial",c="transparent",f={setFont:n,getFont:o,setFontSize:r,getFontSize:i,setBackgroundColor:l,getBackgroundColor:d};t.default=f},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var a=e.image,n={left:0,top:0,width:a.width,height:a.height},r=!1;return Object.keys(t).forEach(function(e){var a=t[e];!0!==a.allowedOutsideImage&&!1===o.default.cornerstoneMath.point.insideRect(a,n)&&(r=!0)}),r};var n=a(0),o=function(e){return e&&e.__esModule?e:{default:e}}(n)},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,a){var n=[o.default.TOUCH_DRAG];return a&&!0===a.fireOnTouchStart&&n.push(o.default.TOUCH_START),{activate:function(o){a&&a.eventData&&(0,r.setToolOptions)(t,o,a.eventData),n.forEach(function(t){o.removeEventListener(t,e),o.addEventListener(t,e)}),a&&a.activateCallback&&a.activateCallback(o)},disable:function(t){n.forEach(function(a){t.removeEventListener(a,e)}),a&&a.disableCallback&&a.disableCallback(t)},enable:function(t){n.forEach(function(a){t.removeEventListener(a,e)}),a&&a.enableCallback&&a.enableCallback(t)},deactivate:function(t){n.forEach(function(a){t.removeEventListener(a,e)}),a&&a.deactivateCallback&&a.deactivateCallback(t)}}};var n=a(1),o=function(e){return e&&e.__esModule?e:{default:e}}(n),r=a(3)},function(e,t,a){"use strict";function n(e){var t=r.default.cornerstoneMath;return e instanceof t.Vector3?e:new t.Vector3(e[0],e[1],e[2])}Object.defineProperty(t,"__esModule",{value:!0}),t.default=n;var o=a(0),r=function(e){return e&&e.__esModule?e:{default:e}}(o)},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if(!t)throw new Error("simpleMouseButtonTool: toolType is required");var a={};return{activate:function(a,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};i.mouseButtonMask=n,(0,r.setToolOptions)(t,a,i),a.removeEventListener(o.default.MOUSE_DOWN_ACTIVATE,e),a.addEventListener(o.default.MOUSE_DOWN_ACTIVATE,e)},disable:function(t){t.removeEventListener(o.default.MOUSE_DOWN_ACTIVATE,e)},enable:function(t){t.removeEventListener(o.default.MOUSE_DOWN_ACTIVATE,e)},deactivate:function(t){t.removeEventListener(o.default.MOUSE_DOWN_ACTIVATE,e)},getConfiguration:function(){return a},setConfiguration:function(e){a=e}}};var n=a(1),o=function(e){return e&&e.__esModule?e:{default:e}}(n),r=a(3)},function(e,t,a){"use strict";function n(){function e(e){return d[e]}function t(e,t){d[e]=t}function a(){return d}function n(e){d=e}function o(e,t,a){var n=r.default.cornerstone.getEnabledElement(e);n.image&&!1!==d.hasOwnProperty(n.image.imageId)||(d[n.image.imageId]={});var o=d[n.image.imageId];!1===o.hasOwnProperty(t)&&(o[t]={data:[]}),o[t].data.push(a)}function i(e,t){var a=r.default.cornerstone.getEnabledElement(e);if(a.image&&!1!==d.hasOwnProperty(a.image.imageId)){var n=d[a.image.imageId];if(!1!==n.hasOwnProperty(t)){return n[t]}}}function l(e){var t=r.default.cornerstone.getEnabledElement(e);t.image&&!1!==d.hasOwnProperty(t.image.imageId)&&delete d[t.image.imageId]}var d={};return{get:i,add:o,clear:l,saveImageIdToolState:e,restoreImageIdToolState:t,saveToolState:a,restoreToolState:n,toolState:d}}Object.defineProperty(t,"__esModule",{value:!0}),t.globalImageIdSpecificToolStateManager=t.newImageIdSpecificToolStateManager=void 0;var o=a(0),r=function(e){return e&&e.__esModule?e:{default:e}}(o),i=n();t.newImageIdSpecificToolStateManager=n,t.globalImageIdSpecificToolStateManager=i},function(e,t,a){"use strict";function n(e){return parseFloat("."+e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var a=r.default.cornerstone,o=a.metaData.get("patientStudyModule",e.imageId),i=a.metaData.get("generalSeriesModule",e.imageId);if(o&&i){if("PT"===i.modality){var l=t*e.slope+e.intercept,d=o.patientWeight;if(d){var u=a.metaData.get("petIsotopeModule",e.imageId);if(u){var s=u.radiopharmaceuticalInfo,c=s.radiopharmaceuticalStartTime,f=s.radionuclideTotalDose,v=s.radionuclideHalfLife,m=i.seriesTime;if(c&&f&&v&&m){var g=n(m.fractionalSeconds||0)+m.seconds+60*m.minutes+60*m.hours*60,h=n(c.fractionalSeconds)+c.seconds+60*c.minutes+60*c.hours*60,p=g-h;return l*d/(f*Math.exp(-p*Math.log(2)/v))*1e3}}}}}};var o=a(0),r=function(e){return e&&e.__esModule?e:{default:e}}(o)},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,a,n){var o=void 0;if(t)return Object.keys(t).forEach(function(i){var d=t[i];if(d.hasOwnProperty("pointNearHandle")){if(d.pointNearHandle(e,d,a))return void(o=d)}else if(!0===d.hasBoundingBox){if((0,l.default)(d,a))return void(o=d)}else{var u=r.default.cornerstone.pixelToCanvas(e,d),s=r.default.cornerstoneMath.point.distance(u,a);if(s<=n)return void(o=d)}}),o};var o=a(0),r=n(o),i=a(12),l=n(i)},function(e,t,a){"use strict";function n(){var e=navigator.userAgent,t=e.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[],a=void 0;return/trident/i.test(t[1])?(a=/\brv[ :]+(\d+)/g.exec(e)||[],"IE "+(a[1]||"")):"Chrome"===t[1]&&null!==(a=e.match(/\b(OPR|Edge)\/(\d+)/))?a.slice(1).join(" ").replace("OPR","Opera"):(t=t[2]?[t[1],t[2]]:[navigator.appName,navigator.appVersion,"-?"],null!==(a=e.match(/version\/(\d+)/i))&&t.splice(1,1,a[1]),t.join(" "))}function o(e){d=e}function r(){return d||i()}function i(){var e=n(),t=e.split(" "),a=t[0],o=t[1],r=u[a];return r?r[o]?r[o]:r.default:u.default}function l(){return new RegExp("Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini").test(navigator.userAgent)}Object.defineProperty(t,"__esModule",{value:!0});var d=void 0,u={default:6,IE:{9:6,10:8,default:8},Firefox:{default:6},Opera:{10:8,11:6,12:6,default:6},Chrome:{default:6},Safari:{default:6}};t.getDefaultSimultaneousRequests=i,t.getMaxSimultaneousRequests=r,t.setMaxSimultaneousRequests=o,t.getBrowserInfo=n,t.isMobileDevice=l},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,a,n,o,i){function d(e){var o=e.detail;!1===n.hasMoved&&(n.hasMoved=!0),n.active=!0,n.x=o.currentPoints.image.x+v.x,n.y=o.currentPoints.image.y+v.y,i&&(n.x=Math.max(n.x,0),n.x=Math.min(n.x,o.image.width),n.y=Math.max(n.y,0),n.y=Math.min(n.y,o.image.height)),c.updateImage(f);var l=r.default.MEASUREMENT_MODIFIED,d={toolType:t,element:f,measurementData:a};(0,u.default)(f,l,d)}function s(){n.active=!1,f.removeEventListener(r.default.MOUSE_DRAG,d),f.removeEventListener(r.default.MOUSE_UP,s),f.removeEventListener(r.default.MOUSE_CLICK,s),c.updateImage(f),"function"==typeof o&&o()}var c=l.default.cornerstone,f=e.element,v={x:n.x-e.currentPoints.image.x,y:n.y-e.currentPoints.image.y};f.addEventListener(r.default.MOUSE_DRAG,d),f.addEventListener(r.default.MOUSE_UP,s),f.addEventListener(r.default.MOUSE_CLICK,s)};var o=a(1),r=n(o),i=a(0),l=n(i),d=a(5),u=n(d)},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,a,n,o,i){function d(e){var o=e.detail;n.active=!0,n.x=o.currentPoints.image.x,n.y=o.currentPoints.image.y,i&&(n.x=Math.max(n.x,0),n.x=Math.min(n.x,o.image.width),n.y=Math.max(n.y,0),n.y=Math.min(n.y,o.image.height)),m.updateImage(g);var l=r.default.MEASUREMENT_MODIFIED,d={toolType:t,element:g,measurementData:a};(0,u.default)(g,l,d)}function s(e){g.removeEventListener(r.default.MOUSE_MOVE,s),g.removeEventListener(r.default.MOUSE_DRAG,s),g.addEventListener(r.default.MOUSE_MOVE,d),g.addEventListener(r.default.MOUSE_DRAG,d),g.addEventListener(r.default.MOUSE_CLICK,v),e.type===r.default.MOUSE_DRAG&&g.addEventListener(r.default.MOUSE_UP,v)}function c(e){e.detail.measurementData===a&&v()}function f(e){e.detail.toolType===t&&(g.removeEventListener(r.default.MOUSE_MOVE,d),g.removeEventListener(r.default.MOUSE_DRAG,d),g.removeEventListener(r.default.MOUSE_CLICK,v),g.removeEventListener(r.default.MOUSE_UP,v),g.removeEventListener(r.default.MEASUREMENT_REMOVED,c),g.removeEventListener(r.default.TOOL_DEACTIVATED,f),n.active=!1,m.updateImage(g))}function v(){g.removeEventListener(r.default.MOUSE_MOVE,d),g.removeEventListener(r.default.MOUSE_DRAG,d),g.removeEventListener(r.default.MOUSE_CLICK,v),g.removeEventListener(r.default.MOUSE_UP,v),g.removeEventListener(r.default.MEASUREMENT_REMOVED,c),g.removeEventListener(r.default.TOOL_DEACTIVATED,f),n.active=!1,m.updateImage(g),"function"==typeof o&&o()}var m=l.default.cornerstone,g=e.element;g.addEventListener(r.default.MOUSE_DRAG,s),g.addEventListener(r.default.MOUSE_MOVE,s),g.addEventListener(r.default.MEASUREMENT_REMOVED,c),g.addEventListener(r.default.TOOL_DEACTIVATED,f)};var o=a(1),r=n(o),i=a(0),l=n(i),d=a(5),u=n(d)},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return{activate:function(t){t.removeEventListener(o.default.MOUSE_WHEEL,e),t.addEventListener(o.default.MOUSE_WHEEL,e)},disable:function(t){t.removeEventListener(o.default.MOUSE_WHEEL,e)},enable:function(t){t.removeEventListener(o.default.MOUSE_WHEEL,e)},deactivate:function(t){t.removeEventListener(o.default.MOUSE_WHEEL,e)}}};var n=a(1),o=function(e){return e&&e.__esModule?e:{default:e}}(n)},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t={};return{disable:function(t){t.removeEventListener(r.default.IMAGE_RENDERED,e)},enable:function(t){t.removeEventListener(r.default.IMAGE_RENDERED,e),t.addEventListener(r.default.IMAGE_RENDERED,e),l.default.cornerstone.updateImage(t)},getConfiguration:function(){return t},setConfiguration:function(e){t=e}}};var o=a(1),r=n(o),i=a(0),l=n(i)},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,a,n,o,i){function d(e){var o=e.detail;n.x=o.currentPoints.image.x+h.x,n.y=o.currentPoints.image.y+h.y,i&&(n.x=Math.max(n.x,0),n.x=Math.min(n.x,o.image.width),n.y=Math.max(n.y,0),n.y=Math.min(n.y,o.image.height)),v.updateImage(m);var l=r.default.MEASUREMENT_MODIFIED,d={toolType:t,element:m,measurementData:a};(0,u.default)(m,l,d)}function s(e){var t=e.detail;if(m.removeEventListener(r.default.TOUCH_DRAG,d),m.removeEventListener(r.default.TOUCH_PINCH,s),m.removeEventListener(r.default.TOUCH_END,s),m.removeEventListener(r.default.TAP,s),m.removeEventListener(r.default.TOUCH_START,c),m.removeEventListener(r.default.TOOL_DEACTIVATED,f),e.type===r.default.TOUCH_PINCH||e.type===r.default.TOUCH_PRESS)return n.active=!1,v.updateImage(m),void o();n.active=!1,a.active=!1,n.x=t.currentPoints.image.x+h.x,n.y=t.currentPoints.image.y+h.y,i&&(n.x=Math.max(n.x,0),n.x=Math.min(n.x,t.image.width),n.y=Math.max(n.y,0),n.y=Math.min(n.y,t.image.height)),v.updateImage(m),"function"==typeof o&&o()}function c(e){return e.stopImmediatePropagation(),!1}function f(){m.removeEventListener(r.default.TOUCH_DRAG,d),m.removeEventListener(r.default.TOUCH_PINCH,s),m.removeEventListener(r.default.TOUCH_END,s),m.removeEventListener(r.default.TAP,s),m.removeEventListener(r.default.TOUCH_START,c),m.removeEventListener(r.default.TOOL_DEACTIVATED,f),n.active=!1,a.active=!1,n.x=e.currentPoints.image.x+h.x,n.y=e.currentPoints.image.y+h.y,i&&(n.x=Math.max(n.x,0),n.x=Math.min(n.x,e.image.width),n.y=Math.max(n.y,0),n.y=Math.min(n.y,e.image.height)),v.updateImage(m)}var v=l.default.cornerstone,m=e.element,g=v.pageToPixel(m,e.currentPoints.page.x,e.currentPoints.page.y+50),h={x:n.x-g.x,y:n.y-g.y};n.active=!0,a.active=!0,m.addEventListener(r.default.TOUCH_DRAG,d),m.addEventListener(r.default.TOUCH_PINCH,s),m.addEventListener(r.default.TOUCH_END,s),m.addEventListener(r.default.TAP,s),m.addEventListener(r.default.TOUCH_START,c),m.addEventListener(r.default.TOOL_DEACTIVATED,f)};var o=a(1),r=n(o),i=a(0),l=n(i),d=a(5),u=n(d)},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){var a=(0,f.default)(t.rowCosines),n=(0,f.default)(t.columnCosines),o=(0,f.default)(t.imagePositionPatient),r=e.clone().sub(o);return{x:a.dot(r)/t.columnPixelSpacing,y:n.dot(r)/t.rowPixelSpacing}}function r(e,t){var a=(0,f.default)(t.rowCosines),n=(0,f.default)(t.columnCosines),o=(0,f.default)(t.imagePositionPatient),r=a.clone().multiplyScalar(e.x);r.multiplyScalar(t.columnPixelSpacing);var i=n.clone().multiplyScalar(e.y);i.multiplyScalar(t.rowPixelSpacing);var l=r.add(i);return l.add(o),l}function i(e){var t=r({x:0,y:0},e),a=r({x:e.columns,y:0},e),n=r({x:0,y:e.rows},e),o=r({x:e.columns,y:e.rows},e);return{top:new s.default.cornerstoneMath.Line3(t,a),left:new s.default.cornerstoneMath.Line3(t,n),right:new s.default.cornerstoneMath.Line3(a,o),bottom:new s.default.cornerstoneMath.Line3(n,o)}}function l(e,t){var a=[];return Object.keys(t).forEach(function(n){var o=t[n],r=e.intersectLine(o);r&&a.push(r)}),a}function d(e,t){var a=(0,f.default)(e.rowCosines),n=(0,f.default)(e.columnCosines),o=(0,f.default)(e.imagePositionPatient),d=(0,f.default)(t.rowCosines),u=(0,f.default)(t.columnCosines),c=(0,f.default)(t.imagePositionPatient),v=a.clone().cross(n),m=new s.default.cornerstoneMath.Plane;m.setFromNormalAndCoplanarPoint(v,o);var g=d.clone().cross(u),h=new s.default.cornerstoneMath.Plane;h.setFromNormalAndCoplanarPoint(g,c);var p=h.clone().intersectPlane(m),E=p.origin,T=p.direction,M=r({x:t.columns,y:t.rows},t),y=c.distanceTo(M),x=new s.default.cornerstoneMath.Line3;x.start=E,x.end=E.clone().add(T.multiplyScalar(y));var O=i(t),P=l(x,O);if(2===P.length)return{start:P[0],end:P[1]}}Object.defineProperty(t,"__esModule",{value:!0}),t.projectPatientPointToImagePlane=o,t.imagePointToPatientPoint=r,t.planePlaneIntersection=d;var u=a(0),s=n(u),c=a(17),f=n(c)},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,a,n){var o=r.default.cornerstone,i=o.getEnabledElement(a).image,d=o.getEnabledElement(n).image;if(i&&d){var s=o.metaData.get("imagePlaneModule",i.imageId),f=o.metaData.get("imagePlaneModule",d.imageId);if(s&&f&&s.rowCosines&&s.columnCosines&&s.imagePositionPatient&&f.rowCosines&&f.columnCosines&&f.imagePositionPatient&&s.frameOfReferenceUID===f.frameOfReferenceUID){s.rowCosines=(0,h.default)(s.rowCosines),s.columnCosines=(0,h.default)(s.columnCosines),s.imagePositionPatient=(0,h.default)(s.imagePositionPatient),f.rowCosines=(0,h.default)(f.rowCosines),f.columnCosines=(0,h.default)(f.columnCosines),f.imagePositionPatient=(0,h.default)(f.imagePositionPatient);var g=s.rowCosines.clone().cross(s.columnCosines),p=f.rowCosines.clone().cross(f.columnCosines),E=g.angleTo(p);if(!((E=Math.abs(E))<.5)){var T=(0,l.default)(s,f);if(T){var M=o.pixelToCanvas(t.element,T.start),y=o.pixelToCanvas(t.element,T.end);if(M.x>y.x){var x=M;M=y,y=x}var O=c.default.getToolWidth(),P=u.default.getActiveColor(),_=e.getContext("2d"),b=e.width,S=e.height;if(void 0!==b&&void 0!==S&&null!==b&&null!==S&&0!==b&&0!==S){_.setTransform(1,0,0,1,0,0),M.x=Math.min(Math.max(M.x,5),e.width-5),M.y=Math.min(Math.max(M.y,5),e.height-5),y.x=Math.min(Math.max(y.x,5),e.width-5),y.y=Math.min(Math.max(y.y,5),e.height-5),_.save(),_.beginPath(),_.strokeStyle="red",_.lineWidth=O,_.moveTo(M.x,M.y),_.lineTo(y.x,y.y),_.stroke(),_.restore();var C=(0,m.getToolState)(n,"stack");if(void 0!==C&&void 0!==C.data&&0!==C.data.length){var I=C.data[0],w=I.currentImageIdIndex,L=""+(w+1),D={x:y.x+3,y:y.y-3};D.x=Math.min(Math.max(D.x,5),e.width-20),D.y=Math.min(Math.max(D.y,5),e.height-20),_.fillStyle="red",(0,v.default)(_,L,D.x,D.y,P)}}}}}}};var o=a(0),r=n(o),i=a(42),l=n(i),d=a(6),u=n(d),s=a(8),c=n(s),f=a(7),v=n(f),m=a(2),g=a(17),h=n(g)},function(e,t,a){"use strict";function n(e,t,a,n,o,r,i){if(!v.hasOwnProperty(a))throw new Error("Request type must be one of interaction, thumbnail, or prefetch");if(e&&t){var l={type:a,imageId:t,preventCache:n,doneCallback:o,failCallback:r},d=c.default.cornerstone.imageCache.getImageLoadObject(t);if(d)return void d.promise.then(function(e){o(e)},function(e){r(e)});i?v[a].unshift(l):v[a].push(l)}}function o(e){if(!v.hasOwnProperty(e))throw new Error("Request type must be one of interaction, thumbnail, or prefetch");v[e]=[]}function r(){h&&setTimeout(function(){l()},p)}function i(e){var t=c.default.cornerstone,a=e.type;m[a]++,h=!0;var n=e.imageId,o=e.doneCallback,i=e.failCallback,l=t.imageCache.getImageLoadObject(n);if(l)return void l.promise.then(function(e){m[a]--,o(e),r()},function(e){m[a]--,i(e),r()});var d=function(e){return"prefetch"===e.type?-5:"interactive"===e.type?0:"thumbnail"===e.type?5:void 0}(e),u=void 0;u=!0===e.preventCache?t.loadImage(n,{priority:d,type:e.type}):t.loadAndCacheImage(n,{priority:d,type:e.type}),u.then(function(e){m[a]--,o(e),r()},function(e){m[a]--,i(e),r()})}function l(){var e=(0,f.getMaxSimultaneousRequests)();g={interaction:Math.max(e,1),thumbnail:Math.max(e-2,1),prefetch:Math.max(e-1,1)};for(var t=m.interaction+m.thumbnail+m.prefetch,a=e-t,n=0;n<a;n++){var o=d();o&&i(o)}}function d(){return v.interaction.length&&m.interaction<g.interaction?v.interaction.shift():v.thumbnail.length&&m.thumbnail<g.thumbnail?v.thumbnail.shift():v.prefetch.length&&m.prefetch<g.prefetch?v.prefetch.shift():(v.interaction.length||v.thumbnail.length||v.prefetch.length||(h=!1),!1)}function u(){return v}Object.defineProperty(t,"__esModule",{value:!0});var s=a(0),c=function(e){return e&&e.__esModule?e:{default:e}}(s),f=a(22),v={interaction:[],thumbnail:[],prefetch:[]},m={interaction:0,thumbnail:0,prefetch:0},g={interaction:6,thumbnail:6,prefetch:5},h=!1,p=20;t.default={addRequest:n,clearRequestStack:o,startGrabbing:l,getRequestPool:u}},function(e,t,a){"use strict";function n(e,t,a){if(e.pending[0]===t){if(e.currentImageIdIndex===t.index)return e.pending.splice(e.pending.indexOf(t),1),void(e.pending.length>0&&n(e,e.pending[0],a));var o=function o(r){e.imageIds.indexOf(r.detail.image.imageId)===t.index&&(e.pending.splice(e.pending.indexOf(t),1),a.removeEventListener("cornerstonenewimage",o),e.pending.length>0&&n(e,e.pending[0],a))};a.addEventListener("cornerstonenewimage",o),(0,r.default)(a,t.index)}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],l=(0,i.getToolState)(e,"stack");if(l&&l.data&&l.data.length){var d=l.data[0];d.pending||(d.pending=[]);var u=d.currentImageIdIndex+t;if(a){u%=d.imageIds.length}else u=Math.min(d.imageIds.length-1,u),u=Math.max(0,u);if(o)(0,r.default)(e,u);else{var s={index:u};d.pending.push(s),n(d,s,e)}}};var o=a(45),r=function(e){return e&&e.__esModule?e:{default:e}}(o),i=a(2)},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var a=Math.pow(10,t);return Math.round(e*a)/a}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var a=e.width/2,n=e.height/2;if(a<=0||n<=0)return!1;var o={x:e.left+a,y:e.top+n},r={x:t.x-o.x,y:t.y-o.y};return r.x*r.x/(a*a)+r.y*r.y/(n*n)<=1}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault(),e.cancelBubble=!0,e.returnValue=!1,!1}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,a,n,r){if(!e)throw new Error("getRGBPixels: parameter element must not be undefined");t=Math.round(t),a=Math.round(a);var i=o.default.cornerstone.getEnabledElement(e),l=[],d=0,u=i.image.getPixelData(),s=void 0,c=void 0,f=void 0;if(i.image.color)for(c=0;c<r;c++)for(f=0;f<n;f++){s=4*((c+a)*i.image.columns+(f+t));var v=u[s],m=u[s+1],g=u[s+2],h=u[s+3];l[d++]=v,l[d++]=m,l[d++]=g,l[d++]=h}return l};var n=a(0),o=function(e){return e&&e.__esModule?e:{default:e}}(n)},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return{page:o.default.cornerstoneMath.point.copy(e.page),image:o.default.cornerstoneMath.point.copy(e.image),client:o.default.cornerstoneMath.point.copy(e.client),canvas:o.default.cornerstoneMath.point.copy(e.canvas)}};var n=a(0),o=function(e){return e&&e.__esModule?e:{default:e}}(n)},function(e,t,a){"use strict";function n(e){r=e.currentPoints.canvas}function o(){return r}Object.defineProperty(t,"__esModule",{value:!0});var r=void 0,i={setCoords:n,getCoords:o};t.default=i},function(e,t,a){"use strict";function n(e){var t=void 0;return Object.keys(e).forEach(function(a){var n=e[a];if(!0===n.active)return void(t=n)}),t}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,a,o){o||(o=6);var i=n(t),l=(0,r.default)(e,t,a,o);return i!==l&&(void 0!==l&&(l.active=!0),void 0!==i&&(i.active=!1),!0)};var o=a(21),r=function(e){return e&&e.__esModule?e:{default:e}}(o)},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,a,n,o,i){function d(e){var a=e.detail;t.active=!0,Object.keys(t.handles).forEach(function(e){var n=t.handles[e];!0!==n.movesIndependently&&(n.x+=a.deltaPoints.image.x,n.y+=a.deltaPoints.image.y,!0===o.preventHandleOutsideImage&&(n.x=Math.max(n.x,0),n.x=Math.min(n.x,a.image.width),n.y=Math.max(n.y,0),n.y=Math.min(n.y,a.image.height)))}),v.updateImage(g);var i=r.default.MEASUREMENT_MODIFIED,l={toolType:n,element:g,measurementData:t};(0,f.default)(g,i,l),e.preventDefault(),e.stopPropagation()}function c(e){var a=e.detail;t.invalidated=!0,g.removeEventListener(r.default.MOUSE_DRAG,d),g.removeEventListener(r.default.MOUSE_UP,c),g.removeEventListener(r.default.MOUSE_CLICK,c),!0===o.deleteIfHandleOutsideImage&&(0,u.default)(a,t.handles)&&(0,s.removeToolState)(g,n,t),v.updateImage(g),"function"==typeof i&&i()}var v=l.default.cornerstone,m=e.detail,g=m.element;return g.addEventListener(r.default.MOUSE_DRAG,d),g.addEventListener(r.default.MOUSE_UP,c),g.addEventListener(r.default.MOUSE_CLICK,c),!0};var o=a(1),r=n(o),i=a(0),l=n(i),d=a(15),u=n(d),s=a(2),c=a(5),f=n(c)},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,a){var n=(0,i.getToolState)(e,"timeSeries");if(n&&n.data&&n.data.length){var o=r.default.cornerstone,l=n.data[0],u=l.stacks[l.currentStackIndex],s=u.currentImageIdIndex,c=l.currentStackIndex+t;if(a?(c>=l.stacks.length&&(c=0),c<0&&(c=l.stacks.length-1)):(c=Math.min(l.stacks.length-1,c),c=Math.max(0,c)),c!==l.currentStackIndex){var f=o.getViewport(e),v=l.stacks[c],m=d.default.getStartLoadHandler(),g=d.default.getEndLoadHandler(),h=d.default.getErrorLoadingHandler();m&&m(e);var p=void 0;p=!0===v.preventCache?o.loadImage(v.imageIds[s]):o.loadAndCacheImage(v.imageIds[s]),p.then(function(t){l.currentImageIdIndex!==s&&(v.currentImageIdIndex=s,l.currentStackIndex=c,o.displayImage(e,t,f),g&&g(e,t))},function(t){var a=v.imageIds[s];h&&h(e,a,t)})}}};var o=a(0),r=n(o),i=a(2),l=a(9),d=n(l)},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var a={},n=[o.default.MULTI_TOUCH_DRAG];return t&&!0===t.fireOnTouchStart&&n.push(o.default.MULTI_TOUCH_START),{activate:function(a){n.forEach(function(t){a.removeEventListener(t,e),a.addEventListener(t,e)}),t&&t.activateCallback&&t.activateCallback(a)},disable:function(a){n.forEach(function(t){a.removeEventListener(t,e)}),t&&t.disableCallback&&t.disableCallback(a)},enable:function(a){n.forEach(function(t){a.removeEventListener(t,e)}),t&&t.enableCallback&&t.enableCallback(a)},deactivate:function(a){n.forEach(function(t){a.removeEventListener(t,e)}),t&&t.deactivateCallback&&t.deactivateCallback(a)},getConfiguration:function(){return a},setConfiguration:function(e){a=e}}};var n=a(1),o=function(e){return e&&e.__esModule?e:{default:e}}(n)},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var a=(0,n.planePlaneIntersection)(e,t);if(a)return{start:(0,n.projectPatientPointToImagePlane)(a.start,e),end:(0,n.projectPatientPointToImagePlane)(a.end,e)}};var n=a(28)},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){var a=Math.sqrt((e.x*e.x+e.y*e.y+e.z*e.z)*(t.x*t.x+t.y*t.y+t.z*t.z));return a<1e-5?a<1e-5:Math.abs(e.x*t.x+e.y*t.y+e.z*t.z)/a>.99}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,a){var n=i.default.cornerstone;t.rowCosines=(0,d.default)(t.rowCosines),t.columnCosines=(0,d.default)(t.columnCosines),t.imagePositionPatient=(0,d.default)(t.imagePositionPatient),a.rowCosines=(0,d.default)(a.rowCosines),a.columnCosines=(0,d.default)(a.columnCosines),a.imagePositionPatient=(0,d.default)(a.imagePositionPatient);var r=t.rowCosines.clone().cross(t.columnCosines),l=a.rowCosines.clone().cross(a.columnCosines),u={},s={},c=t.columnPixelSpacing*(t.columns/2),f=t.rowPixelSpacing*(t.rows/2),v={};if(v.x=t.imagePositionPatient.x+t.rowCosines.x*c+t.columnCosines.x*f,v.y=t.imagePositionPatient.y+t.rowCosines.y*c+t.columnCosines.y*f,v.z=t.imagePositionPatient.z+t.rowCosines.z*c+t.columnCosines.z*f,r&&l){return o(r,l)&&(e.imageIds.forEach(function(e,a){var o=n.metaData.get("imagePlaneModule",e);if(o&&o.pixelSpacing&&o.rowCosines&&o.columnCosines&&o.imagePositionPatient){o.rowCosines=(0,d.default)(o.rowCosines),o.columnCosines=(0,d.default)(o.columnCosines),o.imagePositionPatient=(0,d.default)(o.imagePositionPatient);var r=Math.abs(t.imagePositionPatient.x-o.imagePositionPatient.x),i=Math.abs(t.imagePositionPatient.y-o.imagePositionPatient.y),l=Math.abs(t.imagePositionPatient.z-o.imagePositionPatient.z);if(Math.max(r,i,l)<=.001)return a;var c=o.rowCosines.clone().cross(o.columnCosines),f=Math.abs(c.x*(v.x-o.imagePositionPatient.x)+c.y*(v.y-o.imagePositionPatient.y)+c.z*(v.z-o.imagePositionPatient.z));s.distance=f,s.index=a,(!u.distance||s.distance<u.distance)&&(u.distance=s.distance,u.index=a)}}),u.distance<10)?u.index:void 0}};var r=a(0),i=n(r),l=a(17),d=n(l)},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=a(65),r=n(o),i=a(66),l=n(i),d={getOrientationString:r.default,invertOrientationString:l.default};t.default=d},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){function a(a){if(v.currentImageIdIndex===t){try{i.getEnabledElement(e)}catch(e){return}u?(u.currentImageIdIndex=t,u.render(e,o.data)):i.displayImage(e,a),h&&h(e,a)}}function n(a){var n=v.imageIds[t];p&&p(e,n,a)}var o=(0,d.getToolState)(e,"stack");if(o&&o.data&&o.data.length){var i=l.default.cornerstone,u=void 0;if(o.data.length>1){var c=(0,d.getToolState)(e,"stackRenderer");c&&c.data&&c.data.length&&(u=c.data[0])}var v=o.data[0];t<0&&(t+=v.imageIds.length);var g=f.default.getStartLoadHandler(),h=f.default.getEndLoadHandler(),p=f.default.getErrorLoadingHandler();if(t!==v.currentImageIdIndex){g&&g(e);var E={newImageIdIndex:t,direction:t-v.currentImageIdIndex};v.currentImageIdIndex=t;var T=v.imageIds[t],M=Boolean(v.preventCache),y=void 0;y=M?i.loadImage(T):i.loadAndCacheImage(T),y.then(a,n),s.default.startGrabbing(),(0,m.default)(e,r.default.STACK_SCROLL,E)}}};var o=a(1),r=n(o),i=a(0),l=n(i),d=a(2),u=a(30),s=n(u),c=a(9),f=n(c),v=a(5),m=n(v)},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,a,n,r){if(!e)throw new Error("getLuminance: parameter element must not be undefined");t=Math.round(t),a=Math.round(a);var i=o.default.cornerstone.getEnabledElement(e),l=i.image,d=[],u=0,s=l.getPixelData(),c=void 0,f=void 0,v=void 0;if(l.color)for(f=0;f<r;f++)for(v=0;v<n;v++){c=4*((f+a)*l.columns+(v+t));var m=s[c],g=s[c+1],h=s[c+2];d[u++]=.2126*m+.7152*g+.0722*h}else for(f=0;f<r;f++)for(v=0;v<n;v++)c=(f+a)*l.columns+(v+t),d[u++]=s[c]*l.slope+l.intercept;return d};var n=a(0),o=function(e){return e&&e.__esModule?e:{default:e}}(n)},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,a,n,o){var r=n/2*.5522848,i=o/2*.5522848,l=t+n,d=a+o,u=t+n/2,s=a+o/2;e.beginPath(),e.moveTo(t,s),e.bezierCurveTo(t,s-i,u-r,a,u,a),e.bezierCurveTo(u+r,a,l,s-i,l,s),e.bezierCurveTo(l,s+i,u+r,d,u,d),e.bezierCurveTo(u-r,d,t,s+i,t,s),e.closePath(),e.stroke()}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,a,n){e.beginPath(),e.strokeStyle=a,e.lineWidth=n,e.arc(t.x,t.y,6,0,2*Math.PI),e.stroke()}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,a,n,o){var r=Math.atan2(a.y-t.y,a.x-t.x);e.beginPath(),e.moveTo(t.x,t.y),e.lineTo(a.x,a.y),e.strokeStyle=n,e.lineWidth=o,e.stroke(),e.beginPath(),e.moveTo(a.x,a.y),e.lineTo(a.x-10*Math.cos(r-Math.PI/7),a.y-10*Math.sin(r-Math.PI/7)),e.lineTo(a.x-10*Math.cos(r+Math.PI/7),a.y-10*Math.sin(r+Math.PI/7)),e.lineTo(a.x,a.y),e.lineTo(a.x-10*Math.cos(r-Math.PI/7),a.y-10*Math.sin(r-Math.PI/7)),e.strokeStyle=n,e.lineWidth=o,e.stroke(),e.fillStyle=n,e.fill()}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){for(var a=0,n=0,r=0,i=0,l=t.top;l<t.top+t.height;l++)for(var d=t.left;d<t.left+t.width;d++){var u={x:d,y:l};(0,o.default)(t,u)&&(a+=e[i],n+=e[i]*e[i],r++),i++}if(0===r)return{count:r,mean:0,variance:0,stdDev:0};var s=a/r,c=n/r-s*s;return{count:r,mean:s,variance:c,stdDev:Math.sqrt(c)}};var n=a(33),o=function(e){return e&&e.__esModule?e:{default:e}}(n)},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t={};return{activate:function(t){t.removeEventListener(o.default.KEY_DOWN,e),t.addEventListener(o.default.KEY_DOWN,e)},disable:function(t){t.removeEventListener(o.default.KEY_DOWN,e)},enable:function(t){t.removeEventListener(o.default.KEY_DOWN,e)},deactivate:function(t){t.removeEventListener(o.default.KEY_DOWN,e)},getConfiguration:function(){return t},setConfiguration:function(e){t=e}}};var n=a(1),o=function(e){return e&&e.__esModule?e:{default:e}}(n)},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,a,n,o,i){function d(e){var a=e.detail;t.active=!0,Object.keys(t.handles).forEach(function(e){var n=t.handles[e];!0!==n.movesIndependently&&(n.x+=a.deltaPoints.image.x,n.y+=a.deltaPoints.image.y)}),g.updateImage(m);var o=r.default.MEASUREMENT_MODIFIED,i={toolType:n,element:m,measurementData:t};(0,f.default)(m,o,i),e.preventDefault(),e.stopPropagation()}function c(e){var a=e.detail;t.active=!1,t.invalidated=!1,m.removeEventListener(r.default.TOUCH_DRAG,d),m.removeEventListener(r.default.TOUCH_PINCH,c),m.removeEventListener(r.default.TOUCH_PRESS,c),m.removeEventListener(r.default.TOUCH_END,c),m.removeEventListener(r.default.TOUCH_DRAG_END,c),m.removeEventListener(r.default.TAP,c);var l=(0,u.default)(a,t.handles);!0===o&&!0===l&&(0,s.removeToolState)(m,n,t),g.updateImage(m),"function"==typeof i&&i(e)}var v=e.detail,m=v.element,g=l.default.cornerstone;return m.addEventListener(r.default.TOUCH_DRAG,d),m.addEventListener(r.default.TOUCH_PINCH,c),m.addEventListener(r.default.TOUCH_PRESS,c),m.addEventListener(r.default.TOUCH_END,c),m.addEventListener(r.default.TOUCH_DRAG_END,c),m.addEventListener(r.default.TAP,c),!0};var o=a(1),r=n(o),i=a(0),l=n(i),d=a(15),u=n(d),s=a(2),c=a(5),f=n(c)},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t,a,n,r){if(a.value){var i=d.default.cornerstone,l=(new Date).getTime(),u=Math.abs(t.y-r.y),s=u/10;if(u<1)return t.y=r.y,void(a.value=!1);t.y>r.y?t.y-=s:t.y<r.y&&(t.y+=s),i.updateImage(n.element),i.requestAnimationFrame(function(){o(l,t,a,n,r)})}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,a,n,r){function l(e){var o=e.detail;c.value=!1,!1===n.hasMoved&&(n.hasMoved=!0),n.active=!0;var r=o.currentPoints,l={x:r.page.x,y:r.page.y+E};M=m.pageToPixel(g,l.x,l.y),n.x=M.x,n.y=M.y,m.updateImage(g);var d=i.default.MEASUREMENT_MODIFIED,u={toolType:t,element:g,measurementData:a};(0,s.default)(g,d,u)}function u(e){var t=e.detail;c.value=!1,n.active=!1,g.removeEventListener(i.default.TOUCH_DRAG,l),f.forEach(function(e){g.removeEventListener(e,u)}),m.updateImage(g),e.type===i.default.TOUCH_PRESS&&(t.handlePressed=a,n.x=v.currentPoints.image.x,n.y=v.currentPoints.image.y),"function"==typeof r&&r(e)}c.value=!0;var v=e.detail,m=d.default.cornerstone,g=v.element,h=m.getEnabledElement(g),p=(new Date).getTime(),E=-57,T={x:v.currentPoints.page.x,y:v.currentPoints.page.y+E},M=m.pageToPixel(g,T.x,T.y);g.addEventListener(i.default.TOUCH_DRAG,l),f.forEach(function(e){g.addEventListener(e,u)}),o(p,n,c,h,M)};var r=a(1),i=n(r),l=a(0),d=n(l),u=a(5),s=n(u),c={value:!1},f=[i.default.TOUCH_END,i.default.TOUCH_DRAG_END,i.default.TOUCH_PINCH,i.default.TOUCH_PRESS,i.default.TAP]},function(e,t,a){"use strict";function n(e,t){var a=Date.now();if(e!==s){if(a-c<=d)return t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation(),!1;s=e}c=a}function o(e,t,a){var n=a?f:v;t.forEach(function(t){e.addEventListener(t,n)})}function r(e,t,a){var n=a?f:v;t.forEach(function(t){e.removeEventListener(t,n)})}function i(e){r(e,m,u.mouse),r(e,g,u.touch)}function l(e){i(e),o(e,m,u.mouse),o(e,g,u.touch)}Object.defineProperty(t,"__esModule",{value:!0});var d=2e3,u={mouse:0,touch:1},s=void 0,c=void 0,f=n.bind(null,u.mouse),v=n.bind(null,u.touch),m=["mousedown","mouseup"],g=["touchstart","touchend"],h={enable:l,disable:i};t.default=h},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return{activate:function(t){t.removeEventListener(o.default.DOUBLE_TAP,e),t.addEventListener(o.default.DOUBLE_TAP,e)},disable:function(t){t.removeEventListener(o.default.DOUBLE_TAP,e)},enable:function(t){t.removeEventListener(o.default.DOUBLE_TAP,e)},deactivate:function(t){t.removeEventListener(o.default.DOUBLE_TAP,e)}}};var n=a(1),o=function(e){return e&&e.__esModule?e:{default:e}}(n)},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){function a(a){var n=a.element,i=e.createNewMeasurement(a);i&&((0,x.addToolState)(a.element,h,i),n.removeEventListener(r.default.MOUSE_MOVE,o),(0,g.default)(a,h,i,i.handles.end,function(){i.active=!1,(0,T.default)(a,i.handles)&&(0,x.removeToolState)(a.element,h,i),n.addEventListener(r.default.MOUSE_MOVE,o)},t))}function n(e){var t=e.detail,n=t.element,o=(0,O.getToolOptions)(h,n);if((0,y.default)(t.which,o.mouseButtonMask))return a(t),!1}function o(t){var a=t.detail;u.default.setCoords(a);var n=(0,x.getToolState)(a.element,h);if(void 0!==n){for(var o=!1,r=a.currentPoints.canvas,i=0;i<n.data.length;i++){var d=n.data[i];!0===(0,v.default)(a.element,d.handles,r)&&(o=!0),(e.pointInsideRect(a.element,d,r)&&!d.active||!e.pointInsideRect(a.element,d,r)&&d.active)&&(d.active=!d.active,o=!0)}!0===o&&l.default.cornerstone.updateImage(a.element)}}function i(a){function n(){s.active=!1,(0,T.default)(i,s.handles)&&(0,x.removeToolState)(i.element,h,s),u.updateImage(i.element),d.addEventListener(r.default.MOUSE_MOVE,o)}var i=a.detail,d=i.element,u=l.default.cornerstone,s=void 0,f=(0,O.getToolOptions)(h,d);if((0,y.default)(i.which,f.mouseButtonMask)){var v=i.startPoints.canvas,m=(0,x.getToolState)(a.currentTarget,h),E=void 0;if(void 0!==m)for(E=0;E<m.data.length;E++){s=m.data[E];var M=(0,c.default)(i.element,s.handles,v,25);if(void 0!==M)return d.removeEventListener(r.default.MOUSE_MOVE,o),s.active=!0,(0,g.default)(i,h,s,M,n,t),a.stopImmediatePropagation(),!1}var P={deleteIfHandleOutsideImage:!0,preventHandleOutsideImage:t};if(void 0!==m&&void 0!==e.pointInsideRect)for(E=0;E<m.data.length;E++)if(s=m.data[E],e.pointInsideRect(i.element,s,v))return d.removeEventListener(r.default.MOUSE_MOVE,o),(0,p.default)(a,s,m,h,P,n),d.addEventListener(r.default.MOUSE_MOVE,o),a.stopImmediatePropagation(),!1}}function d(t){t.removeEventListener(r.default.IMAGE_RENDERED,e.onImageRendered),t.removeEventListener(r.default.MOUSE_MOVE,o),t.removeEventListener(r.default.MOUSE_DOWN,i),t.removeEventListener(r.default.MOUSE_DOWN_ACTIVATE,n),l.default.cornerstone.updateImage(t)}function s(t){t.removeEventListener(r.default.IMAGE_RENDERED,e.onImageRendered),t.removeEventListener(r.default.MOUSE_MOVE,o),t.removeEventListener(r.default.MOUSE_DOWN,i),t.removeEventListener(r.default.MOUSE_DOWN_ACTIVATE,n),t.addEventListener(r.default.IMAGE_RENDERED,e.onImageRendered),l.default.cornerstone.updateImage(t)}function f(t,a){(0,O.setToolOptions)(h,t,{mouseButtonMask:a}),t.removeEventListener(r.default.IMAGE_RENDERED,e.onImageRendered),t.removeEventListener(r.default.MOUSE_MOVE,o),t.removeEventListener(r.default.MOUSE_DOWN,i),t.removeEventListener(r.default.MOUSE_DOWN_ACTIVATE,n),t.addEventListener(r.default.IMAGE_RENDERED,e.onImageRendered),t.addEventListener(r.default.MOUSE_MOVE,o),t.addEventListener(r.default.MOUSE_DOWN,i),t.addEventListener(r.default.MOUSE_DOWN_ACTIVATE,n),l.default.cornerstone.updateImage(t)}function m(t,a){(0,O.setToolOptions)(h,t,{mouseButtonMask:a}),t.removeEventListener(r.default.IMAGE_RENDERED,e.onImageRendered),t.removeEventListener(r.default.MOUSE_MOVE,o),t.removeEventListener(r.default.MOUSE_DOWN,i),t.removeEventListener(r.default.MOUSE_DOWN_ACTIVATE,n),t.addEventListener(r.default.IMAGE_RENDERED,e.onImageRendered),t.addEventListener(r.default.MOUSE_MOVE,o),t.addEventListener(r.default.MOUSE_DOWN,i),l.default.cornerstone.updateImage(t)}var h=e.toolType;return{enable:s,disable:d,activate:f,deactivate:m}};var o=a(1),r=n(o),i=a(0),l=n(i),d=a(37),u=n(d),s=a(21),c=n(s),f=a(38),v=n(f),m=a(23),g=n(m),h=a(39),p=n(h),E=a(15),T=n(E),M=a(4),y=n(M),x=a(2),O=a(3)},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return{activate:function(t){t.removeEventListener(o.default.TOUCH_PINCH,e),t.addEventListener(o.default.TOUCH_PINCH,e)},disable:function(t){t.removeEventListener(o.default.TOUCH_PINCH,e)},enable:function(t){t.removeEventListener(o.default.TOUCH_PINCH,e)},deactivate:function(t){t.removeEventListener(o.default.TOUCH_PINCH,e)}}};var n=a(1),o=function(e){return e&&e.__esModule?e:{default:e}}(n)},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e){function t(t){e.onMouseMove(t)}function a(o){var r=o.detail,l=r.element;e.onMouseUp(o),l.removeEventListener(i.default.MOUSE_DRAG,t),l.removeEventListener(i.default.MOUSE_DRAG,n),l.removeEventListener(i.default.MOUSE_UP,a),l.removeEventListener(i.default.MOUSE_CLICK,a)}function n(t){return e.onDrag(t),!1}function o(o){var r=o.detail,l=r.element,d=(0,m.getToolOptions)(f,l);if((0,v.default)(r.which,d.mouseButtonMask))return l.addEventListener(i.default.MOUSE_DRAG,n),l.addEventListener(i.default.MOUSE_UP,a),l.addEventListener(i.default.MOUSE_CLICK,a),e.onMouseDown(o),!1;l.addEventListener(i.default.MOUSE_DRAG,t),l.addEventListener(i.default.MOUSE_UP,a)}function r(t){var a=t.detail,n=a.element,o=(0,u.getToolState)(n,g),r=void 0;o?r=o.data[0].pixelData:(r=new Uint8ClampedArray(a.image.width*a.image.height),(0,u.addToolState)(n,g,{pixelData:r}));var i=d.default.cornerstone.getLayer(a.element,h);i.image.setPixelData(r),i.invalid=!0,d.default.cornerstone.updateImage(n),e.onImageRendered(t)}function l(e,a){(0,m.setToolOptions)(f,e,{mouseButtonMask:a}),e.removeEventListener(i.default.IMAGE_RENDERED,r),e.addEventListener(i.default.IMAGE_RENDERED,r),e.removeEventListener(i.default.MOUSE_DOWN_ACTIVATE,o),e.addEventListener(i.default.MOUSE_DOWN_ACTIVATE,o),e.removeEventListener(i.default.MOUSE_MOVE,t),e.addEventListener(i.default.MOUSE_MOVE,t);var n=d.default.cornerstone.getEnabledElement(e),l=n.image,s=l.width,c=l.height,v=new Uint8ClampedArray(s*c),E=p.getConfiguration(),T=E.colormapId;if(!T){T="BrushColorMap";var M=d.default.cornerstone.colors.getColormap(T);M.setNumberOfColors(2),M.setColor(0,[0,0,0,0]),M.setColor(1,[255,0,0,255])}var y={minPixelValue:0,maxPixelValue:1,slope:1,intercept:0,getPixelData:function(){return v},rows:n.image.height,columns:n.image.width,height:c,width:s,pixelData:v,setPixelData:function(e){v=e},colormap:T,color:!1,rgba:!1,labelmap:!0,invert:!1,columnPixelSpacing:1,rowPixelSpacing:1,sizeInBytes:n.image.width*n.image.height},x=void 0,O={viewport:{pixelReplication:!0}};h&&(x=d.default.cornerstone.getLayer(e,h)),x||(h=d.default.cornerstone.addLayer(e,y,O)),(0,u.addToolState)(e,g,{pixelData:v}),E.brushLayerId=h,p.setConfiguration(E),d.default.cornerstone.updateImage(e)}function s(e){e.removeEventListener(i.default.IMAGE_RENDERED,r),e.removeEventListener(i.default.MOUSE_DOWN_ACTIVATE,o),e.removeEventListener(i.default.MOUSE_MOVE,t)}var f=e.toolType,p=(0,c.default)({mouseMoveCallback:t,mouseDownActivateCallback:o,onImageRendered:r,deactivate:s});return p.activate=l,p}Object.defineProperty(t,"__esModule",{value:!0}),t.default=o;var r=a(1),i=n(r),l=a(0),d=n(l),u=a(2),s=a(10),c=n(s),f=a(4),v=n(f),m=a(3),g="brush",h=void 0},function(e,t,a){"use strict";function n(e,t,a){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,r=Math.round(n),i=Math.round(o);if(1===e)return[[r,i]];for(var l=[],d=0,u=-e;u<=e;u++){var s=i+u;if(!(s>t||s<0))for(var c=-e;c<=e;c++){var f=r+c;f>a||f<0||c*c+u*u<e*e&&(l[d++]=[r+c,i+u])}}return l}Object.defineProperty(t,"__esModule",{value:!0}),t.default=n},function(e,t,a){"use strict";function n(e,t,a,n){var o=function(e,t){return t*n+e};e.forEach(function(e){var n=o(e[0],e[1]);t[n]=a})}function o(e,t,a,n){var o=i.default.cornerstone.pixelToCanvas(n,{x:0,y:0}),r=i.default.cornerstone.pixelToCanvas(n,{x:1,y:1}),l=r.x-o.x,d=r.y-o.y;t.save(),t.fillStyle=a,e.forEach(function(e){var a=i.default.cornerstone.pixelToCanvas(n,{x:e[0],y:e[1]});t.fillRect(a.x,a.y,l,d)}),t.restore()}Object.defineProperty(t,"__esModule",{value:!0}),t.drawBrushOnCanvas=t.drawBrushPixels=void 0;var r=a(0),i=function(e){return e&&e.__esModule?e:{default:e}}(r);t.drawBrushPixels=n,t.drawBrushOnCanvas=o},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=a(0);Object.defineProperty(t,"external",{enumerable:!0,get:function(){return n(o).default}});var r=a(62);Object.defineProperty(t,"referenceLines",{enumerable:!0,get:function(){return r.referenceLines}}),Object.defineProperty(t,"automaticPlanePositioning",{enumerable:!0,get:function(){return r.automaticPlanePositioning}});var i=a(44);Object.defineProperty(t,"orientation",{enumerable:!0,get:function(){return n(i).default}});var l=a(30);Object.defineProperty(t,"requestPoolManager",{enumerable:!0,get:function(){return n(l).default}});var d=a(67);Object.defineProperty(t,"setContextToDisplayFontSize",{enumerable:!0,get:function(){return n(d).default}});var u=a(31);Object.defineProperty(t,"scroll",{enumerable:!0,get:function(){return n(u).default}});var s=a(45);Object.defineProperty(t,"scrollToIndex",{enumerable:!0,get:function(){return n(s).default}});var c=a(32);Object.defineProperty(t,"roundToDecimal",{enumerable:!0,get:function(){return n(c).default}});var f=a(28);Object.defineProperty(t,"projectPatientPointToImagePlane",{enumerable:!0,get:function(){return f.projectPatientPointToImagePlane}}),Object.defineProperty(t,"imagePointToPatientPoint",{enumerable:!0,get:function(){return f.imagePointToPatientPoint}}),Object.defineProperty(t,"planePlaneIntersection",{enumerable:!0,get:function(){return f.planePlaneIntersection}});var v=a(12);Object.defineProperty(t,"pointInsideBoundingBox",{enumerable:!0,get:function(){return n(v).default}});var m=a(33);Object.defineProperty(t,"pointInEllipse",{enumerable:!0,get:function(){return n(m).default}});var g=a(34);Object.defineProperty(t,"pauseEvent",{enumerable:!0,get:function(){return n(g).default}});var h=a(4);Object.defineProperty(t,"isMouseButtonEnabled",{enumerable:!0,get:function(){return n(h).default}});var p=a(35);Object.defineProperty(t,"getRGBPixels",{enumerable:!0,get:function(){return n(p).default}});var E=a(22);Object.defineProperty(t,"getDefaultSimultaneousRequests",{enumerable:!0,get:function(){return E.getDefaultSimultaneousRequests}}),Object.defineProperty(t,"getMaxSimultaneousRequests",{enumerable:!0,get:function(){return E.getMaxSimultaneousRequests}}),Object.defineProperty(t,"getBrowserInfo",{enumerable:!0,get:function(){return E.getBrowserInfo}}),Object.defineProperty(t,"isMobileDevice",{enumerable:!0,get:function(){return E.isMobileDevice}});var T=a(46);Object.defineProperty(t,"getLuminance",{enumerable:!0,get:function(){return n(T).default}});var M=a(7);Object.defineProperty(t,"drawTextBox",{enumerable:!0,get:function(){return n(M).default}});var y=a(47);Object.defineProperty(t,"drawEllipse",{enumerable:!0,get:function(){return n(y).default}});var x=a(48);Object.defineProperty(t,"drawCircle",{enumerable:!0,get:function(){return n(x).default}});var O=a(49);Object.defineProperty(t,"drawArrow",{enumerable:!0,get:function(){return n(O).default}});var P=a(36);Object.defineProperty(t,"copyPoints",{enumerable:!0,get:function(){return n(P).default}});var _=a(20);Object.defineProperty(t,"calculateSUV",{enumerable:!0,get:function(){return n(_).default}});var b=a(50);Object.defineProperty(t,"calculateEllipseStatistics",{enumerable:!0,get:function(){return n(b).default}});var S=a(68);Object.defineProperty(t,"probeTool4D",{enumerable:!0,get:function(){return n(S).default}});var C=a(40);Object.defineProperty(t,"incrementTimePoint",{enumerable:!0,get:function(){return n(C).default}});var I=a(71);Object.defineProperty(t,"timeSeriesPlayer",{enumerable:!0,get:function(){return n(I).default}});var w=a(72);Object.defineProperty(t,"timeSeriesScroll",{enumerable:!0,get:function(){return w.timeSeriesScroll}}),Object.defineProperty(t,"timeSeriesScrollWheel",{enumerable:!0,get:function(){return w.timeSeriesScrollWheel}}),Object.defineProperty(t,"timeSeriesScrollTouchDrag",{enumerable:!0,get:function(){return w.timeSeriesScrollTouchDrag}});var L=a(73);Object.defineProperty(t,"wwwcSynchronizer",{enumerable:!0,get:function(){return n(L).default}});var D=a(74);Object.defineProperty(t,"updateImageSynchronizer",{enumerable:!0,get:function(){return n(D).default}});var U=a(75);Object.defineProperty(t,"Synchronizer",{enumerable:!0,get:function(){return n(U).default}});var A=a(76);Object.defineProperty(t,"stackScrollSynchronizer",{enumerable:!0,get:function(){return n(A).default}});var k=a(77);Object.defineProperty(t,"stackImagePositionSynchronizer",{enumerable:!0,get:function(){return n(k).default}});var R=a(78);Object.defineProperty(t,"stackImagePositionOffsetSynchronizer",{enumerable:!0,get:function(){return n(R).default}});var j=a(79);Object.defineProperty(t,"stackImageIndexSynchronizer",{enumerable:!0,get:function(){return n(j).default}});var N=a(80);Object.defineProperty(t,"panZoomSynchronizer",{enumerable:!0,get:function(){return n(N).default}});var H=a(81);Object.defineProperty(t,"rotationSynchronizer",{enumerable:!0,get:function(){return n(H).default}});var V=a(82);Object.defineProperty(t,"layoutStackScrollSynchronizer",{enumerable:!0,get:function(){return n(V).default}});var B=a(83);Object.defineProperty(t,"automaticPlanePositioningSynchronizer",{enumerable:!0,get:function(){return n(B).default}});var W=a(8);Object.defineProperty(t,"toolStyle",{enumerable:!0,get:function(){return n(W).default}});var G=a(2);Object.defineProperty(t,"addToolState",{enumerable:!0,get:function(){return G.addToolState}}),Object.defineProperty(t,"getToolState",{enumerable:!0,get:function(){return G.getToolState}}),Object.defineProperty(t,"removeToolState",{enumerable:!0,get:function(){return G.removeToolState}}),Object.defineProperty(t,"clearToolState",{enumerable:!0,get:function(){return G.clearToolState}}),Object.defineProperty(t,"setElementToolStateManager",{enumerable:!0,get:function(){return G.setElementToolStateManager}}),Object.defineProperty(t,"getElementToolStateManager",{enumerable:!0,get:function(){return G.getElementToolStateManager}});var z=a(37);Object.defineProperty(t,"toolCoordinates",{enumerable:!0,get:function(){return n(z).default}});var F=a(6);Object.defineProperty(t,"toolColors",{enumerable:!0,get:function(){return n(F).default}});var Y=a(84);Object.defineProperty(t,"addTimeSeriesStateManager",{enumerable:!0,get:function(){return Y.addTimeSeriesStateManager}}),Object.defineProperty(t,"newTimeSeriesSpecificToolStateManager",{enumerable:!0,get:function(){return Y.newTimeSeriesSpecificToolStateManager}});var K=a(14);Object.defineProperty(t,"textStyle",{enumerable:!0,get:function(){return n(K).default}});var X=a(85);Object.defineProperty(t,"stackSpecificStateManager",{enumerable:!0,get:function(){return X.stackSpecificStateManager}}),Object.defineProperty(t,"newStackSpecificToolStateManager",{enumerable:!0,get:function(){return X.newStackSpecificToolStateManager}}),Object.defineProperty(t,"addStackStateManager",{enumerable:!0,get:function(){return X.addStackStateManager}});var q=a(9);Object.defineProperty(t,"loadHandlerManager",{enumerable:!0,get:function(){return n(q).default}});var $=a(19);Object.defineProperty(t,"newImageIdSpecificToolStateManager",{enumerable:!0,get:function(){return $.newImageIdSpecificToolStateManager}}),Object.defineProperty(t,"globalImageIdSpecificToolStateManager",{enumerable:!0,get:function(){return $.globalImageIdSpecificToolStateManager}});var Z=a(86);Object.defineProperty(t,"newFrameOfReferenceSpecificToolStateManager",{enumerable:!0,get:function(){return Z.newFrameOfReferenceSpecificToolStateManager}}),Object.defineProperty(t,"globalFrameOfReferenceSpecificToolStateManager",{enumerable:!0,get:function(){return Z.globalFrameOfReferenceSpecificToolStateManager}});var J=a(87);Object.defineProperty(t,"appState",{enumerable:!0,get:function(){return n(J).default}});var Q=a(88);Object.defineProperty(t,"stackScrollKeyboard",{enumerable:!0,get:function(){return n(Q).default}});var ee=a(89);Object.defineProperty(t,"stackScroll",{enumerable:!0,get:function(){return ee.stackScroll}}),Object.defineProperty(t,"stackScrollWheel",{enumerable:!0,get:function(){return ee.stackScrollWheel}}),Object.defineProperty(t,"stackScrollTouchDrag",{enumerable:!0,get:function(){return ee.stackScrollTouchDrag}}),Object.defineProperty(t,"stackScrollMultiTouch",{enumerable:!0,get:function(){return ee.stackScrollMultiTouch}});var te=a(90);Object.defineProperty(t,"stackPrefetch",{enumerable:!0,get:function(){return n(te).default}});var ae=a(91);Object.defineProperty(t,"scrollIndicator",{enumerable:!0,get:function(){return n(ae).default}});var ne=a(92);Object.defineProperty(t,"stackRenderers",{enumerable:!0,get:function(){return n(ne).default}});var oe=a(94);Object.defineProperty(t,"playClip",{enumerable:!0,get:function(){return oe.playClip}}),Object.defineProperty(t,"stopClip",{enumerable:!0,get:function(){return oe.stopClip}});var re=a(15);Object.defineProperty(t,"anyHandlesOutsideImage",{enumerable:!0,get:function(){return n(re).default}});var ie=a(11);Object.defineProperty(t,"drawHandles",{enumerable:!0,get:function(){return n(ie).default}});var le=a(21);Object.defineProperty(t,"getHandleNearImagePoint",{enumerable:!0,get:function(){return n(le).default}});var de=a(38);Object.defineProperty(t,"handleActivator",{enumerable:!0,get:function(){return n(de).default}});var ue=a(39);Object.defineProperty(t,"moveAllHandles",{enumerable:!0,get:function(){return n(ue).default}});var se=a(23);Object.defineProperty(t,"moveHandle",{enumerable:!0,get:function(){return n(se).default}});var ce=a(24);Object.defineProperty(t,"moveNewHandle",{enumerable:!0,get:function(){return n(ce).default}});var fe=a(27);Object.defineProperty(t,"moveNewHandleTouch",{enumerable:!0,get:function(){return n(fe).default}});var ve=a(52);Object.defineProperty(t,"touchMoveAllHandles",{enumerable:!0,get:function(){return n(ve).default}});var me=a(53);Object.defineProperty(t,"touchMoveHandle",{enumerable:!0,get:function(){return n(me).default}});var ge=a(95);Object.defineProperty(t,"keyboardInput",{enumerable:!0,get:function(){return n(ge).default}});var he=a(96);Object.defineProperty(t,"mouseInput",{enumerable:!0,get:function(){return n(he).default}});var pe=a(97);Object.defineProperty(t,"mouseWheelInput",{enumerable:!0,get:function(){return n(pe).default}});var Ee=a(54);Object.defineProperty(t,"preventGhostClick",{enumerable:!0,get:function(){return n(Ee).default}});var Te=a(98);Object.defineProperty(t,"touchInput",{enumerable:!0,get:function(){return n(Te).default}});var Me=a(99);Object.defineProperty(t,"angle",{enumerable:!0,get:function(){return Me.angle}}),Object.defineProperty(t,"angleTouch",{enumerable:!0,get:function(){return Me.angleTouch}});var ye=a(100);Object.defineProperty(t,"arrowAnnotate",{enumerable:!0,get:function(){return ye.arrowAnnotate}}),Object.defineProperty(t,"arrowAnnotateTouch",{enumerable:!0,get:function(){return ye.arrowAnnotateTouch}});var xe=a(101);Object.defineProperty(t,"crosshairs",{enumerable:!0,get:function(){return xe.crosshairs}}),Object.defineProperty(t,"crosshairsTouch",{enumerable:!0,get:function(){return xe.crosshairsTouch}});var Oe=a(26);Object.defineProperty(t,"displayTool",{enumerable:!0,get:function(){return n(Oe).default}});var Pe=a(55);Object.defineProperty(t,"doubleTapTool",{enumerable:!0,get:function(){return n(Pe).default}});var _e=a(102);Object.defineProperty(t,"doubleTapZoom",{enumerable:!0,get:function(){return n(_e).default}});var be=a(103);Object.defineProperty(t,"dragProbe",{enumerable:!0,get:function(){return be.dragProbe}}),Object.defineProperty(t,"dragProbeTouch",{enumerable:!0,get:function(){return be.dragProbeTouch}});var Se=a(104);Object.defineProperty(t,"ellipticalRoi",{enumerable:!0,get:function(){return Se.ellipticalRoi}}),Object.defineProperty(t,"ellipticalRoiTouch",{enumerable:!0,get:function(){return Se.ellipticalRoiTouch}});var Ce=a(105);Object.defineProperty(t,"freehand",{enumerable:!0,get:function(){return Ce.freehand}});var Ie=a(106);Object.defineProperty(t,"highlight",{enumerable:!0,get:function(){return Ie.highlight}}),Object.defineProperty(t,"highlightTouch",{enumerable:!0,get:function(){return Ie.highlightTouch}});var we=a(107);Object.defineProperty(t,"imageStats",{enumerable:!0,get:function(){return n(we).default}});var Le=a(51);Object.defineProperty(t,"keyboardTool",{enumerable:!0,get:function(){return n(Le).default}});var De=a(108);Object.defineProperty(t,"length",{enumerable:!0,get:function(){return De.length}}),Object.defineProperty(t,"lengthTouch",{enumerable:!0,get:function(){return De.lengthTouch}});var Ue=a(109);Object.defineProperty(t,"magnify",{enumerable:!0,get:function(){return Ue.magnify}}),Object.defineProperty(t,"magnifyTouchDrag",{enumerable:!0,get:function(){return Ue.magnifyTouchDrag}});var Ae=a(56);Object.defineProperty(t,"mouseButtonRectangleTool",{enumerable:!0,get:function(){return n(Ae).default}});var ke=a(10);Object.defineProperty(t,"mouseButtonTool",{enumerable:!0,get:function(){return n(ke).default}});var Re=a(25);Object.defineProperty(t,"mouseWheelTool",{enumerable:!0,get:function(){return n(Re).default}});var je=a(41);Object.defineProperty(t,"multiTouchDragTool",{enumerable:!0,get:function(){return n(je).default}});var Ne=a(110);Object.defineProperty(t,"orientationMarkers",{enumerable:!0,get:function(){return n(Ne).default}});var He=a(111);Object.defineProperty(t,"pan",{enumerable:!0,get:function(){return He.pan}}),Object.defineProperty(t,"panTouchDrag",{enumerable:!0,get:function(){return He.panTouchDrag}});var Ve=a(112);Object.defineProperty(t,"panMultiTouch",{enumerable:!0,get:function(){return n(Ve).default}});var Be=a(113);Object.defineProperty(t,"probe",{enumerable:!0,get:function(){return Be.probe}}),Object.defineProperty(t,"probeTouch",{enumerable:!0,get:function(){return Be.probeTouch}});var We=a(114);Object.defineProperty(t,"rectangleRoi",{enumerable:!0,get:function(){return We.rectangleRoi}}),Object.defineProperty(t,"rectangleRoiTouch",{enumerable:!0,get:function(){return We.rectangleRoiTouch}});var Ge=a(115);Object.defineProperty(t,"rotate",{enumerable:!0,get:function(){return Ge.rotate}}),Object.defineProperty(t,"rotateTouchDrag",{enumerable:!0,get:function(){return Ge.rotateTouchDrag}});var ze=a(116);Object.defineProperty(t,"rotateTouch",{enumerable:!0,get:function(){return n(ze).default}});var Fe=a(117);Object.defineProperty(t,"saveAs",{enumerable:!0,get:function(){return n(Fe).default}});var Ye=a(118);Object.defineProperty(t,"seedAnnotate",{enumerable:!0,get:function(){return Ye.seedAnnotate}}),Object.defineProperty(t,"seedAnnotateTouch",{enumerable:!0,get:function(){return Ye.seedAnnotateTouch}});var Ke=a(119);Object.defineProperty(t,"simpleAngle",{enumerable:!0,get:function(){return Ke.simpleAngle}}),Object.defineProperty(t,"simpleAngleTouch",{enumerable:!0,get:function(){return Ke.simpleAngleTouch}});var Xe=a(18);Object.defineProperty(t,"simpleMouseButtonTool",{enumerable:!0,get:function(){return n(Xe).default}});var qe=a(120);Object.defineProperty(t,"textMarker",{enumerable:!0,get:function(){return qe.textMarker}}),Object.defineProperty(t,"textMarkerTouch",{enumerable:!0,get:function(){return qe.textMarkerTouch}});var $e=a(16);Object.defineProperty(t,"touchDragTool",{enumerable:!0,get:function(){return n($e).default}});var Ze=a(57);Object.defineProperty(t,"touchPinchTool",{enumerable:!0,get:function(){return n(Ze).default}});var Je=a(13);Object.defineProperty(t,"touchTool",{enumerable:!0,get:function(){return n(Je).default}});var Qe=a(121);Object.defineProperty(t,"wwwc",{enumerable:!0,get:function(){return Qe.wwwc}}),Object.defineProperty(t,"wwwcTouchDrag",{enumerable:!0,get:function(){return Qe.wwwcTouchDrag}});var et=a(122);Object.defineProperty(t,"wwwcRegion",{enumerable:!0,get:function(){return et.wwwcRegion}}),Object.defineProperty(t,"wwwcRegionTouch",{enumerable:!0,get:function(){return et.wwwcRegionTouch}});var tt=a(123);Object.defineProperty(t,"zoom",{enumerable:!0,get:function(){return tt.zoom}}),Object.defineProperty(t,"zoomWheel",{enumerable:!0,get:function(){return tt.zoomWheel}}),Object.defineProperty(t,"zoomTouchPinch",{enumerable:!0,get:function(){return tt.zoomTouchPinch}}),Object.defineProperty(t,"zoomTouchDrag",{enumerable:!0,get:function(){return tt.zoomTouchDrag}});var at=a(124);Object.defineProperty(t,"brush",{enumerable:!0,get:function(){return at.brush}});var nt=a(125);Object.defineProperty(t,"adaptiveBrush",{enumerable:!0,get:function(){return nt.adaptiveBrush}});var ot=a(126);Object.defineProperty(t,"version",{enumerable:!0,get:function(){return n(ot).default}});var rt=a(3);Object.defineProperty(t,"setToolOptions",{enumerable:!0,get:function(){return rt.setToolOptions}}),Object.defineProperty(t,"getToolOptions",{enumerable:!0,get:function(){return rt.getToolOptions}})},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.automaticPlanePositioning=t.referenceLines=void 0;var o=a(42),r=n(o),i=a(43),l=n(i),d=a(63),u=n(d),s=a(64),c=n(s),f=a(29),v=n(f),m={calculateReferenceLine:r.default,tools:c.default,renderActiveReferenceLine:v.default},g={calculateAutomaticPlanePositioning:l.default,tool:u.default,renderActiveReferenceLine:v.default};t.referenceLines=m,t.automaticPlanePositioning=g},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e){var t=s.default.$,a=e.detail,n=(0,c.getToolState)(e.currentTarget,m);if(void 0!==n){var o=n.data[0].synchronizationContext,r=o.getSourceElements(),i=n.data[0].renderer,l=a.canvasContext.canvas;s.default.cornerstone.setToPixelCoordinateSystem(a.enabledElement,l.getContext("2d")),r.forEach(function(n){if(n!==e.currentTarget)return t(n).data("autoPlanePosition")?void t(n).data("autoPlanePosition",!1):void(t(n).data("mouseWheel")&&(i(l,a,e.currentTarget,n),t(n).data("mouseWheel",!1)))})}}function r(e,t,a){a=a||v.default,(0,c.addToolState)(e,m,{synchronizationContext:t,renderer:a}),e.removeEventListener(d.default.IMAGE_RENDERED,o),e.addEventListener(d.default.IMAGE_RENDERED,o),s.default.cornerstone.updateImage(e)}function i(e){e.removeEventListener(d.default.IMAGE_RENDERED,o),s.default.cornerstone.updateImage(e)}Object.defineProperty(t,"__esModule",{value:!0});var l=a(1),d=n(l),u=a(0),s=n(u),c=a(2),f=a(29),v=n(f),m="automaticPlanePositioning",g={enable:r,disable:i};t.default=g},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e){var t=s.default.$,a=e.detail,n=(0,c.getToolState)(e.currentTarget,m);if(void 0!==n){var o=n.data[0].synchronizationContext,r=o.getSourceElements(),i=n.data[0].renderer,l=a.canvasContext.canvas;s.default.cornerstone.setToPixelCoordinateSystem(a.enabledElement,l.getContext("2d")),t(e.currentTarget).data("mouseWheel")||r.forEach(function(n){n!==e.currentTarget&&t(n).data("mouseWheel")&&i(l,a,e.currentTarget,n)})}}function r(e,t,a){a=a||v.default,(0,c.addToolState)(e,m,{synchronizationContext:t,renderer:a}),e.removeEventListener(d.default.IMAGE_RENDERED,o),e.addEventListener(d.default.IMAGE_RENDERED,o),s.default.cornerstone.updateImage(e)}function i(e){e.removeEventListener(d.default.IMAGE_RENDERED,o),s.default.cornerstone.updateImage(e)}Object.defineProperty(t,"__esModule",{value:!0});var l=a(1),d=n(l),u=a(0),s=n(u),c=a(2),f=a(29),v=n(f),m="referenceLines",g={enable:r,disable:i};t.default=g},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){for(var t=(0,l.default)(e),a="",n=t.x<0?"R":"L",o=t.y<0?"A":"P",i=t.z<0?"F":"H",d=new r.default.cornerstoneMath.Vector3(Math.abs(t.x),Math.abs(t.y),Math.abs(t.z)),u=0;u<3;u++)if(d.x>1e-4&&d.x>d.y&&d.x>d.z)a+=n,d.x=0;else if(d.y>1e-4&&d.y>d.x&&d.y>d.z)a+=o,d.y=0;else{if(!(d.z>1e-4&&d.z>d.x&&d.z>d.y))break;a+=i,d.z=0}return a};var o=a(0),r=n(o),i=a(17),l=n(i)},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.replace("H","f");return t=t.replace("F","h"),t=t.replace("R","l"),t=t.replace("L","r"),t=t.replace("A","p"),t=t.replace("P","a"),t=t.toUpperCase()}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,a){return o.default.cornerstone.setToPixelCoordinateSystem(e,t,.1),{fontSize:a/e.viewport.scale/.1,lineHeight:a/e.viewport.scale/.1,fontScale:.1}};var n=a(0),o=function(e){return e&&e.__esModule?e:{default:e}}(n)},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e){var t=d.default.cornerstone,a=[];e.timeSeries.stacks.forEach(function(n){var o=void 0;o=!0===n.preventCache?t.loadImage(n.imageIds[e.imageIdIndex]):t.loadAndCacheImage(n.imageIds[e.imageIdIndex]),o.then(function(t){var n=Math.round(e.handles.end.x)+Math.round(e.handles.end.y)*t.width,o=t.getPixelData()[n];a.push(o)})}),e.lineSample.set(a)}function r(e){var t=(0,v.getToolState)(e.element,"timeSeries");if(void 0!==t&&void 0!==t.data&&0!==t.data.length){var a=t.data[0],n={timeSeries:a,lineSample:new p.default,imageIdIndex:a.stacks[a.currentStackIndex].currentImageIdIndex,visible:!0,handles:{end:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!0}}};return o(n),g.default.add(n),n}}function i(e){var t=d.default.cornerstone,a=e.detail,n=(0,v.getToolState)(e.currentTarget,x);if(n){var o=a.canvasContext;o.setTransform(1,0,0,1,0,0);for(var r=T.default.getFont(),i=0;i<n.data.length;i++){o.save();var l=n.data[i];o.beginPath(),(0,f.default)(o,a,l.handles,"white"),o.stroke(),o.font=r;var u={x:l.handles.end.x+3,y:l.handles.end.y-3},s=t.pixelToCanvas(a.element,u);o.fillStyle="white",(0,y.default)(o,l.handles.end.x+", "+l.handles.end.y,s.x,s.y,"white"),o.restore()}}}Object.defineProperty(t,"__esModule",{value:!0});var l=a(0),d=n(l),u=a(10),s=n(u),c=a(11),f=n(c),v=a(2),m=a(69),g=n(m),h=a(70),p=n(h),E=a(14),T=n(E),M=a(7),y=n(M),x="probe4D",O=(0,s.default)({createNewMeasurement:r,onImageRendered:i,toolType:x});t.default=O},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(){var e=d.default.cornerstone,t=this;t.measurements=[],this.add=function(a){var n=t.measurements.push(a),o={index:n,measurement:a};(0,s.default)(e.events,i.default.MEASUREMENT_ADDED,o)},this.remove=function(a){var n=t.measurements[a];t.measurements.splice(a,1);var o={index:a,measurement:n};(0,s.default)(e.events,i.default.MEASUREMENT_REMOVED,o)}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(1),i=n(r),l=a(0),d=n(l),u=a(5),s=n(u),c=new o;t.default=c},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){var e=l.default.cornerstone,t=this;t.samples=[],this.set=function(a){t.samples=a,(0,u.default)(e.events,r.default.LINE_SAMPLE_UPDATED)}};var o=a(1),r=n(o),i=a(0),l=n(i),d=a(5),u=n(d)},function(e,t,a){"use strict";function n(e,t){if(void 0===e)throw new Error("playClip: element must not be undefined");void 0===t&&(t=30);var a=(0,r.getToolState)(e,"timeSeries");if(void 0!==a&&void 0!==a.data&&0!==a.data.length){var n=(0,r.getToolState)(e,d),o=void 0;void 0===n||0===n.data.length?(o={intervalId:void 0,framesPerSecond:t,lastFrameTimeStamp:void 0,frameRate:0},(0,r.addToolState)(e,d,o)):(o=n.data[0],o.framesPerSecond=t),void 0===o.intervalId&&(o.intervalId=setInterval(function(){o.framesPerSecond>0?(0,l.default)(e,1,!0):(0,l.default)(e,-1,!0)},1e3/Math.abs(o.framesPerSecond)))}}function o(e){var t=(0,r.getToolState)(e,d);if(t&&t.data&&t.data.length){var a=t.data[0];clearInterval(a.intervalId),a.intervalId=void 0}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(2),i=a(40),l=function(e){return e&&e.__esModule?e:{default:e}}(i),d="timeSeriesPlayer",u={start:n,stop:o};t.default=u},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e){var t=e.detail,a=t.element;a.removeEventListener(s.default.MOUSE_DRAG,i),a.removeEventListener(s.default.MOUSE_UP,o),a.removeEventListener(s.default.MOUSE_CLICK,o)}function r(e){var t=e.detail,a=t.element,n=(0,x.getToolOptions)(O,a);if((0,M.default)(t.which,n.mouseButtonMask))return n.deltaY=0,(0,x.setToolOptions)(O,a,n),a.addEventListener(s.default.MOUSE_DRAG,i),a.addEventListener(s.default.MOUSE_UP,o),a.addEventListener(s.default.MOUSE_CLICK,o),e.stopImmediatePropagation(),!1}function i(e){var t=e.detail,a=t.element;e.data.deltaY+=t.deltaPoints.page.y;var n=(0,y.getToolState)(t.element,"timeSeries");if(void 0!==n&&void 0!==n.data&&0!==n.data.length){var o=n.data[0],r=a.offsetHeight/o.stacks.length;if(void 0!==e.data.options&&void 0!==e.data.options.timeSeriesScrollSpeed&&(r=e.data.options.timeSeriesScrollSpeed),e.data.deltaY>=r||e.data.deltaY<=-r){var i=Math.round(e.data.deltaY/r),l=e.data.deltaY%r;(0,E.default)(t.element,i),e.data.deltaY=l}return!1}}function l(e){var t=e.detail,a=-t.direction;(0,E.default)(t.element,a)}function d(e){var t=e.originalEvent.detail,a={deltaY:0};a.deltaY+=t.deltaPoints.page.y;var n=(0,y.getToolState)(t.element,"stack");if(void 0!==n&&void 0!==n.data&&0!==n.data.length){if(a.deltaY>=3||a.deltaY<=-3){var o=a.deltaY/3,r=a.deltaY%3;(0,E.default)(a.element,o),a.deltaY=r}return!1}}Object.defineProperty(t,"__esModule",{value:!0}),t.timeSeriesScrollTouchDrag=t.timeSeriesScrollWheel=t.timeSeriesScroll=void 0;var u=a(1),s=n(u),c=a(18),f=n(c),v=a(16),m=n(v),g=a(25),h=n(g),p=a(40),E=n(p),T=a(4),M=n(T),y=a(2),x=a(3),O="timeSeriesScroll",P=(0,f.default)(r,O),_=(0,h.default)(l),b=(0,m.default)(d);t.timeSeriesScroll=P,t.timeSeriesScrollWheel=_,t.timeSeriesScrollTouchDrag=b},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,a){if(a!==t){var n=o.default.cornerstone,r=n.getViewport(t),i=n.getViewport(a);void 0!==i&&(i.voi.windowWidth===r.voi.windowWidth&&i.voi.windowCenter===r.voi.windowCenter&&i.invert===r.invert||(i.voi.windowWidth=r.voi.windowWidth,i.voi.windowCenter=r.voi.windowCenter,i.invert=r.invert,e.setViewport(a,i)))}};var n=a(0),o=function(e){return e&&e.__esModule?e:{default:e}}(n)},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,a){var n=o.default.$;a!==t&&(o.default.cornerstone.updateImage(a),n(a).data("mouseWheel")&&n(a).data("mouseWheel",!1))};var n=a(0),o=function(e){return e&&e.__esModule?e:{default:e}}(n)},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e){return e.filter(function(e,t,a){return a.indexOf(e)===t})}function r(e,t){function a(e,t){v.length&&m.length&&(g=!0,m.forEach(function(a){var n=m.indexOf(a);if(-1!==n){var o=h.imageIds.targetElements[n],r=v.indexOf(e);if(-1!==r){var l=h.imageIds.sourceElements[r],d=void 0;l===o?d=0:void 0!==h.distances[l]&&(d=h.distances[l][o]),p(s,e,a,t,d),i(a).data("autoPlanePosition")&&i(a).data("autoPlanePosition",!1)}}}),g=!1)}function n(e){var t=e.detail;!0!==g&&(i(e.currentTarget).data("mouseWheel",!0),a(e.currentTarget,t))}function r(e){var t=e.detail.element;s.remove(t),(0,f.clearToolOptionsByElement)(t)}var i=u.default.$,d=u.default.cornerstone,s=this,v=[],m=[],g=!1,h={},p=t;this.setHandler=function(e){p=e},this.getHandler=function(){return p},this.getDistances=function(){v.length&&m.length&&(h.distances={},h.imageIds={sourceElements:[],targetElements:[]},v.forEach(function(e){var t=d.getEnabledElement(e);if(t&&t.image){var a=t.image.imageId,n=d.metaData.get("imagePlaneModule",a);if(n&&n.imagePositionPatient){var o=(0,c.default)(n.imagePositionPatient);h.hasOwnProperty(t)||(h.distances[a]={},h.imageIds.sourceElements.push(a),m.forEach(function(t){var n=d.getEnabledElement(t);if(n&&n.image){var r=n.image.imageId;if(h.imageIds.targetElements.push(r),e!==t&&a!==r&&!h.distances[a].hasOwnProperty(r)){var i=d.metaData.get("imagePlaneModule",r);if(i&&i.imagePositionPatient){var l=(0,c.default)(i.imagePositionPatient);h.distances[a][r]=l.clone().sub(o)}}}}),Object.keys(h.distances[a]).length||delete h.distances[a])}}}))},this.addSource=function(t){-1===v.indexOf(t)&&(v.push(t),e.split(" ").forEach(function(e){t.addEventListener(e,n)}),s.getDistances(),s.updateDisableHandlers())},this.addTarget=function(e){-1===m.indexOf(e)&&(m.push(e),s.getDistances(),p(s,e,e,0),s.updateDisableHandlers())},this.add=function(e){s.addSource(e),s.addTarget(e)},this.removeSource=function(t){var o=v.indexOf(t);-1!==o&&(v.splice(o,1),e.split(" ").forEach(function(e){t.addEventListener(e,n)}),s.getDistances(),a(t),s.updateDisableHandlers())},this.removeTarget=function(e){var t=m.indexOf(e);-1!==t&&(m.splice(t,1),s.getDistances(),p(s,e,e,0),s.updateDisableHandlers())},this.remove=function(e){s.removeTarget(e),s.removeSource(e)},this.getSourceElements=function(){return v},this.getTargetElements=function(){return m},this.displayImage=function(e,t,a){g=!0,d.displayImage(e,t,a),g=!1},this.setViewport=function(e,t){g=!0,d.setViewport(e,t),g=!1},this.updateDisableHandlers=function(){o(v.concat(m)).forEach(function(e){e.removeEventListener(l.default.ELEMENT_DISABLED,r),e.addEventListener(l.default.ELEMENT_DISABLED,r)})},this.destroy=function(){o(v.concat(m)).forEach(function(e){s.remove(e)})}}Object.defineProperty(t,"__esModule",{value:!0});var i=a(1),l=n(i),d=a(0),u=n(d),s=a(17),c=n(s),f=a(3);t.default=r},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,a,n){if(t!==a&&n&&n.direction){var o=r.default.cornerstone,l=(0,i.getToolState)(a,"stack"),u=l.data[0],s=u.currentImageIdIndex+n.direction;if(s=Math.min(Math.max(s,0),u.imageIds.length-1),u.currentImageIdIndex!==s){var c=d.default.getStartLoadHandler(),f=d.default.getEndLoadHandler(),v=d.default.getErrorLoadingHandler();c&&c(a);var m=void 0;m=!0===u.preventCache?o.loadImage(u.imageIds[s]):o.loadAndCacheImage(u.imageIds[s]),m.then(function(t){var n=o.getViewport(a);u.currentImageIdIndex=s,e.displayImage(a,t,n),f&&f(a,t)},function(e){var t=u.imageIds[s];v&&v(a,t,e)})}}};var o=a(0),r=n(o),i=a(2),l=a(9),d=n(l)},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,a){if(a!==t){var n=r.default.cornerstone,o=n.getEnabledElement(t).image,l=n.metaData.get("imagePlaneModule",o.imageId);if(void 0!==l&&void 0!==l.imagePositionPatient){var u=(0,s.default)(l.imagePositionPatient),c=(0,i.getToolState)(a,"stack"),f=c.data[0],v=Number.MAX_VALUE,m=-1;if(f.imageIds.forEach(function(e,t){var a=n.metaData.get("imagePlaneModule",e);if(void 0!==a&&void 0!==a.imagePositionPatient){var o=(0,s.default)(a.imagePositionPatient),r=o.distanceToSquared(u);r<v&&(v=r,m=t)}}),m!==f.currentImageIdIndex){var g=d.default.getStartLoadHandler(),h=d.default.getEndLoadHandler(),p=d.default.getErrorLoadingHandler();if(g&&g(a),-1!==m){var E=void 0;E=!0===f.preventCache?n.loadImage(f.imageIds[m]):n.loadAndCacheImage(f.imageIds[m]),E.then(function(t){var o=n.getViewport(a);f.currentImageIdIndex=m,e.displayImage(a,t,o),h&&h(a,t)},function(e){var t=f.imageIds[m];p&&p(a,t,e)})}}}}};var o=a(0),r=n(o),i=a(2),l=a(9),d=n(l),u=a(17),s=n(u)},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,a,n,o){if(a!==t){var l=r.default.cornerstone,u=l.getEnabledElement(t),c=l.metaData.get("imagePlaneModule",u.image.imageId),f=(0,s.default)(c.imagePositionPatient),v=(0,i.getToolState)(a,"stack"),m=v.data[0],g=Number.MAX_VALUE,h=-1;if(o){var p=f.clone().add(o);if(m.imageIds.forEach(function(e,t){var a=l.metaData.get("imagePlaneModule",e),n=(0,s.default)(a.imagePositionPatient),o=p.distanceToSquared(n);o<g&&(g=o,h=t)}),h!==m.currentImageIdIndex&&-1!==h){var E=d.default.getStartLoadHandler(),T=d.default.getEndLoadHandler(),M=d.default.getErrorLoadingHandler();E&&E(a);var y=void 0;y=!0===m.preventCache?l.loadImage(m.imageIds[h]):l.loadAndCacheImage(m.imageIds[h]),y.then(function(t){var n=l.getViewport(a);m.currentImageIdIndex=h,e.displayImage(a,t,n),T&&T(a,t)},function(e){var t=m.imageIds[h];M&&M(a,t,e)})}}}};var o=a(0),r=n(o),i=a(2),l=a(9),d=n(l),u=a(17),s=n(u)},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,a){if(a!==t){var n=r.default.cornerstone,o=(0,i.getToolState)(t,"stack"),l=o.data[0],u=(0,i.getToolState)(a,"stack"),s=u.data[0],c=l.currentImageIdIndex;if((c=Math.min(Math.max(c,0),s.imageIds.length-1))!==s.currentImageIdIndex){var f=d.default.getStartLoadHandler(),v=d.default.getEndLoadHandler(),m=d.default.getErrorLoadingHandler();f&&f(a);var g=void 0;g=!0===s.preventCache?n.loadImage(s.imageIds[c]):n.loadAndCacheImage(s.imageIds[c]),g.then(function(t){var o=n.getViewport(a);s.currentImageIdIndex=c,e.displayImage(a,t,o),v&&v(a,t)},function(e){var t=s.imageIds[c];m&&m(a,t,e)})}}};var o=a(0),r=n(o),i=a(2),l=a(9),d=n(l)},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,a){if(a!==t){var n=o.default.cornerstone,r=n.getViewport(t),i=n.getViewport(a);void 0!==i&&(i.scale===r.scale&&i.translation.x===r.translation.x&&i.translation.y===r.translation.y||(0!==r.scale&&(i.scale=r.scale),i.scale=r.scale,i.translation.x=r.translation.x,i.translation.y=r.translation.y,e.setViewport(a,i)))}};var n=a(0),o=function(e){return e&&e.__esModule?e:{default:e}}(n)},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,a){var n=o.default.cornerstone;if(a!==t){var r=n.getViewport(t),i=n.getViewport(a);void 0!==i&&i.rotation!==r.rotation&&(i.rotation=r.rotation,e.setViewport(a,i))}};var n=a(0),o=function(e){return e&&e.__esModule?e:{default:e}}(n)},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,a,n){var o=r.default.cornerstone,l=r.default.$,u=l(a).parent(),s=l(u).find(".overlay"),c=l(s[0]).find("div"),f=l(s[1]).find("div"),v=l(s[2]).find("div"),m=l(s[3]).find("div");if(t!==a&&n&&n.direction){var g=(0,i.getToolState)(t,"stack"),h=(0,i.getToolState)(a,"stack");if(g&&h){var p=g.data[0],E=h.data[0],T=n.newImageIdIndex+(E.layoutIndex-p.layoutIndex);if(T>E.imageIds.length-1){E.currentImageIdIndex=T,l(a).hide(),s.text().length>0&&(c.hide(),f.hide(),v.hide(),m.hide());var M=l(a).parent().find(".overlay-text");M.length<1&&(M=l('<div class="overlay overlay-text">NO IMAGE</div>').appendTo(l(a).parent()).show());var y=l(a).parent().width()/2,x=l(a).parent().height()/2;return void M.css({top:x,left:y-M.width()/2})}if(l(a).show(),l(a).parent().find(".overlay-text").remove(),c.show(),f.show(),v.show(),m.show(),E.currentImageIdIndex!==T){var O=d.default.getStartLoadHandler(),P=d.default.getEndLoadHandler(),_=d.default.getErrorLoadingHandler();O&&O(a);var b=void 0;E.imageIds[T]&&(b=!0===E.preventCache?o.loadImage(E.imageIds[T]):o.loadAndCacheImage(E.imageIds[T]),b.then(function(t){var n=o.getViewport(a);E.currentImageIdIndex=T,e.displayImage(a,t,n),P&&P(a,t)},function(e){var t=E.imageIds[T];_&&_(a,t,e)}))}}}};var o=a(0),r=n(o),i=a(2),l=a(9),d=n(l)},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,a){if(a!==t){var n=r.default.cornerstone,o=(0,i.getToolState)(a,"stack"),l=o.data[0],u=n.getEnabledElement(t).image,c=n.getEnabledElement(a).image;if(u&&c){var f=n.metaData.get("imagePlaneModule",u.imageId),v=n.metaData.get("imagePlaneModule",c.imageId);if(f&&v&&f.pixelSpacing&&v.pixelSpacing&&f.rows&&f.columns&&f.rowCosines&&f.columnCosines&&f.imagePositionPatient&&v.rowCosines&&v.columnCosines&&v.imagePositionPatient&&f.frameOfReferenceUID===v.frameOfReferenceUID){var m=(0,s.default)(l,f,v);if(null===m||void 0===m)return void n.updateImage(a);var g=m;if((g=Math.min(Math.max(g,0),l.imageIds.length-1))!==l.currentImageIdIndex){var h=d.default.getStartLoadHandler(),p=d.default.getEndLoadHandler(),E=d.default.getErrorLoadingHandler();h&&h(a);var T=void 0;T=!0===l.preventCache?n.loadImage(l.imageIds[g]):n.loadAndCacheImage(l.imageIds[g]),T.then(function(t){var o=n.getViewport(a);l.currentImageIdIndex=g,e.displayImage(a,t,o),p&&p(a,t)},function(e){var t=l.imageIds[g];E&&E(a,t,e)})}}}}};var o=a(0),r=n(o),i=a(2),l=a(9),d=n(l),u=a(43),s=n(u)},function(e,t,a){"use strict";function n(e,t){function a(a,n,r){if(!(e.indexOf(n)>=0))return t.add(a,n,r);!1===o.hasOwnProperty(n)&&(o[n]={data:[]}),o[n].data.push(r)}function n(a,n){return e.indexOf(n)>=0?(!1===o.hasOwnProperty(n)&&(o[n]={data:[]}),o[n]):t.get(a,n)}var o={};return{get:n,add:a}}function o(e,t){t=t||["timeSeries"];var a=(0,i.getElementToolStateManager)(e);void 0===a&&(a=r.globalImageIdSpecificToolStateManager);var o=n(t,a);l.push(o),(0,i.setElementToolStateManager)(e,o)}Object.defineProperty(t,"__esModule",{value:!0}),t.newTimeSeriesSpecificToolStateManager=t.addTimeSeriesStateManager=void 0;var r=a(19),i=a(2),l=[];t.addTimeSeriesStateManager=o,t.newTimeSeriesSpecificToolStateManager=n},function(e,t,a){"use strict";function n(e,t){function a(){return i}function n(e){i=e}function o(a,n,o){if(!(e.indexOf(n)>=0))return t.add(a,n,o);!1===i.hasOwnProperty(n)&&(i[n]={data:[]}),i[n].data.push(o)}function r(a,n){return e.indexOf(n)>=0?(!1===i.hasOwnProperty(n)&&(i[n]={data:[]}),i[n]):t.get(a,n)}var i={};return{get:r,add:o,saveToolState:a,restoreToolState:n,toolState:i}}function o(e,t){var a=(0,i.getElementToolStateManager)(e);a||(a=r.globalImageIdSpecificToolStateManager);var o=["stack","stackPrefetch","playClip","volume","slab","referenceLines","crosshairs","stackRenderer"];t&&(o=o.concat(t));var d=n(o,a);l.push(d),(0,i.setElementToolStateManager)(e,d)}Object.defineProperty(t,"__esModule",{value:!0}),t.addStackStateManager=t.newStackSpecificToolStateManager=t.stackSpecificStateManager=void 0;var r=a(19),i=a(2),l=[],d={newStackSpecificToolStateManager:n,addStackStateManager:o};t.stackSpecificStateManager=d,t.newStackSpecificToolStateManager=n,t.addStackStateManager=o},function(e,t,a){"use strict";function n(){function e(e,t,a){!1===n.hasOwnProperty(e)&&(n[e]={});var o=n[e];!1===o.hasOwnProperty(t)&&(o[t]={data:[]}),o[t].data.push(a)}function t(e,t){if(!1!==n.hasOwnProperty(e)){var a=n[e];if(!1!==a.hasOwnProperty(t)){return a[t]}}}function a(e,t,a){if(!1!==n.hasOwnProperty(e)){var o=n[e];if(!1!==o.hasOwnProperty(t)){for(var r=o[t],i=-1,l=0;l<r.data.length;l++)r.data[l]===a&&(i=l);-1!==i&&r.data.splice(i,1)}}}var n={};return{get:t,add:e,remove:a}}Object.defineProperty(t,"__esModule",{value:!0});var o=n();t.newFrameOfReferenceSpecificToolStateManager=n,t.globalFrameOfReferenceSpecificToolStateManager=o},function(e,t,a){"use strict";function n(e){var t={imageIdToolState:l.globalImageIdSpecificToolStateManager.saveToolState(),elementToolState:{},elementViewport:{}};return e.forEach(function(e){var a=(0,d.getElementToolStateManager)(e);a!==l.globalImageIdSpecificToolStateManager&&(t.elementToolState[e.id]=a.saveToolState(),t.elementViewport[e.id]=i.default.cornerstone.getViewport(e))}),t}function o(e){if(e.hasOwnProperty("imageIdToolState")&&e.hasOwnProperty("elementToolState")&&e.hasOwnProperty("elementViewport")){var t=i.default.cornerstone;return l.globalImageIdSpecificToolStateManager.restoreToolState(e.imageIdToolState),Object.keys(e.elementViewport).forEach(function(a){var n=document.getElementById(a);if(n&&e.elementToolState.hasOwnProperty(a)){var o=(0,d.getElementToolStateManager)(n);if(o!==l.globalImageIdSpecificToolStateManager){o.restoreToolState(e.elementToolState[a]);var r=e.elementViewport[a];t.setViewport(n,r),t.updateImage(n)}}}),e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(0),i=function(e){return e&&e.__esModule?e:{default:e}}(r),l=a(19),d=a(2),u={save:n,restore:o};t.default=u},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e){var t=e.detail,a=t.keyCode;if(a===u.UP||a===u.DOWN){var n=1;a===u.DOWN&&(n=-1),(0,i.default)(t.element,n)}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(31),i=n(r),l=a(51),d=n(l),u={UP:38,DOWN:40},s=(0,d.default)(o);t.default=s},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e){var t=e.detail,a=t.element;a.removeEventListener(s.default.MOUSE_DRAG,l),a.removeEventListener(s.default.MOUSE_UP,o),a.removeEventListener(s.default.MOUSE_CLICK,o)}function r(e){var t=e.detail,a=t.element,n=(0,P.getToolOptions)(_,a);if((0,M.default)(t.which,n.mouseButtonMask))return n.deltaY=0,(0,P.setToolOptions)(_,a,n),a.addEventListener(s.default.MOUSE_DRAG,l),a.addEventListener(s.default.MOUSE_UP,o),a.addEventListener(s.default.MOUSE_CLICK,o),e.stopImmediatePropagation(),!1}function i(e){var t=e.detail,a=-t.direction,n=b.getConfiguration(),o=!1,r=!0;n&&(o=void 0!==n.loop&&n.loop,r=void 0===n.allowSkipping||n.allowSkipping),(0,x.default)(t.element,a,o,r)}function l(e){var t=e.detail,a=t.element,n=(0,O.getToolState)(a,"stack");if(n&&n.data&&n.data.length){var o=n.data[0],r=b.getConfiguration(),i=!0;r&&void 0!==r.allowSkipping&&(i=r.allowSkipping);var l=Math.max(2,a.offsetHeight/Math.max(o.imageIds.length,8));r&&r.stackScrollSpeed&&(l=r.stackScrollSpeed);var d=(0,P.getToolOptions)(_,a),u=d.deltaY||0;if(u+=t.deltaPoints.page.y,Math.abs(u)>=l){var s=Math.round(u/l);(0,x.default)(a,s,!1,i),d.deltaY=u%l}else d.deltaY=u;(0,P.setToolOptions)(_,a,d),e.preventDefault(),e.stopPropagation()}}function d(e){var t=e.detail,a=L.getConfiguration();a&&a.testPointers(t)&&l(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.stackScrollMultiTouch=t.stackScrollTouchDrag=t.stackScrollWheel=t.stackScroll=void 0;var u=a(1),s=n(u),c=a(16),f=n(c),v=a(41),m=n(v),g=a(18),h=n(g),p=a(25),E=n(p),T=a(4),M=n(T),y=a(31),x=n(y),O=a(2),P=a(3),_="stackScroll",b=(0,h.default)(r,_),S=(0,E.default)(i),C={eventData:{deltaY:0}},I=(0,f.default)(l,"stackScrollTouchDrag",C),w={testPointers:function(e){return e.numPointers>=3}},L=(0,m.default)(d,C);L.setConfiguration(w),t.stackScroll=b,t.stackScrollWheel=S,t.stackScrollTouchDrag=I,t.stackScrollMultiTouch=L},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){e=Math.round(e)||0,t=Math.round(t)||0;var a=[],n=t-e+1;if(n<=0)return a;for(;n--;)a[n]=t--;return a}function r(e,t){var a=[],n=[];return e.forEach(function(e){e<t?a.push(e):e>t&&n.push(e)}),{low:e.indexOf(C(a)),high:e.indexOf(I(n))}}function i(e){function t(e){var t=d.indicesToRequest.indexOf(e);t>-1&&d.indicesToRequest.splice(t,1)}function a(e){t(i.imageIds.indexOf(e.imageId))}function n(t){console.log("prefetch errored: "+t),f&&f(e,s,t,"stackPrefetch")}var o=(0,y.getToolState)(e,"stack");if(o&&o.data&&o.data.length){var i=o.data[0],l=(0,y.getToolState)(e,O);if(l){var d=l.data[0]||{};if(d.indicesToRequest&&d.indicesToRequest.length||(d.enabled=!1),!1!==d.enabled){l.data[0].indicesToRequest.sort(function(e,t){return e-t});if(d.indicesToRequest.slice().forEach(function(e){var a=i.imageIds[e];if(a){h.default.cornerstone.imageCache.getImageLoadObject(a)&&t(e)}}),d.indicesToRequest.length){E.default.clearRequestStack(P);for(var u=r(d.indicesToRequest,i.currentImageIdIndex),s=void 0,c=void 0,f=M.default.getErrorLoadingHandler(),v=u.low,m=u.high;v>=0||m<d.indicesToRequest.length;){var g=i.currentImageIdIndex,p=g-d.indicesToRequest[v]>_.maxImagesToPrefetch,T=d.indicesToRequest[m]-g>_.maxImagesToPrefetch,x=!p&&v>=0,b=!T&&m<d.indicesToRequest.length;if(!b&&!x)break;x&&(c=d.indicesToRequest[v--],s=i.imageIds[c],E.default.addRequest(e,s,P,!1,a,n)),b&&(c=d.indicesToRequest[m++],s=i.imageIds[c],E.default.addRequest(e,s,P,!1,a,n))}E.default.startGrabbing()}}}}}function l(e){return function(t){var a=t.detail,n=void 0;try{n=(0,y.getToolState)(e,"stack")}catch(e){return}if(n&&n.data&&n.data.length){var o=n.data[0],r=o.imageIds.indexOf(a.imageId);if(!(r<0)){var i=(0,y.getToolState)(e,O);i&&i.data&&i.data.length&&i.data[0].indicesToRequest.push(r)}}}}function d(e){clearTimeout(b),b=setTimeout(function(){var t=e.target;try{i(t)}catch(e){return}},S)}function u(e){(0,y.getToolState)(e,O).data=[];var t=(0,y.getToolState)(e,"stack");if(t&&t.data&&t.data.length){var a=t.data[0];if(!0===a.preventCache)return void console.warn("A stack that should not be cached was given the stackPrefetch");var n={indicesToRequest:o(0,a.imageIds.length-1),enabled:!0,direction:1},r=n.indicesToRequest.indexOf(a.currentImageIdIndex);n.indicesToRequest.splice(r,1),(0,y.addToolState)(e,O,n),i(e),e.removeEventListener(m.default.NEW_IMAGE,d),e.addEventListener(m.default.NEW_IMAGE,d);var u=l(e);h.default.cornerstone.events.removeEventListener(m.default.IMAGE_CACHE_PROMISE_REMOVED,u),h.default.cornerstone.events.addEventListener(m.default.IMAGE_CACHE_PROMISE_REMOVED,u)}}function s(e){clearTimeout(b),e.removeEventListener(m.default.NEW_IMAGE,d);var t=l(e);h.default.cornerstone.events.removeEventListener(m.default.IMAGE_CACHE_PROMISE_REMOVED,t);var a=(0,y.getToolState)(e,O);a&&a.data.length&&(a.data[0].enabled=!1,E.default.clearRequestStack(P))}function c(){return _}function f(e){_=e,e.maxSimultaneousRequests&&(0,x.setMaxSimultaneousRequests)(e.maxSimultaneousRequests)}Object.defineProperty(t,"__esModule",{value:!0});var v=a(1),m=n(v),g=a(0),h=n(g),p=a(30),E=n(p),T=a(9),M=n(T),y=a(2),x=a(22),O="stackPrefetch",P="prefetch",_={maxImagesToPrefetch:1/0},b=void 0,S=10,C=function(e){return Math.max.apply(null,e)},I=function(e){return Math.min.apply(null,e)},w={enable:u,disable:s,getConfiguration:c,setConfiguration:f};t.default=w},function(e,t,a){"use strict";function n(e){var t=e.detail,a=t.element,n=t.enabledElement.canvas.width,o=t.enabledElement.canvas.height;if(!n||!o)return!1;var r=t.enabledElement.canvas.getContext("2d");r.setTransform(1,0,0,1,0,0),r.save();var d=u.getConfiguration();r.fillStyle=d.backgroundColor,"horizontal"===d.orientation?r.fillRect(0,o-l,n,l):r.fillRect(0,0,l,o);var s=(0,i.getToolState)(a,"stack");if(s&&s.data&&s.data.length){var c=s.data[0].imageIds,f=s.data[0].currentImageIdIndex,v=n/c.length,m=o/c.length,g=v*f,h=m*f;r.fillStyle=d.fillColor,"horizontal"===d.orientation?r.fillRect(g,o-l,v,l):r.fillRect(0,h,l,m),r.restore()}}Object.defineProperty(t,"__esModule",{value:!0});var o=a(26),r=function(e){return e&&e.__esModule?e:{default:e}}(o),i=a(2),l=6,d={backgroundColor:"rgb(19, 63, 141)",fillColor:"white",orientation:"horizontal"},u=(0,r.default)(n);u.setConfiguration(d),t.default=u},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(93),o=function(e){return e&&e.__esModule?e:{default:e}}(n),r={};r.FusionRenderer=o.default,t.default=r},function(e,t,a){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),r=a(0),i=function(e){return e&&e.__esModule?e:{default:e}}(r),l=a(2),d=function(){function e(){n(this,e),this.currentImageIdIndex=0,this.layerIds=[],this.findImageFn=void 0}return o(e,[{key:"render",value:function(e,t){var a=this;if(!Number.isInteger(this.currentImageIdIndex))throw new Error("FusionRenderer: render - Image ID Index is not an integer");if(!this.findImageFn)throw new Error("No findImage function has been defined");if(!t){t=(0,l.getToolState)(e,"stack").data}var n=i.default.cornerstone,o=t[0],r=o.imageIds[this.currentImageIdIndex],d=t.slice(1,t.length);n.loadAndCacheImage(r).then(function(t){var i=a.layerIds[0];i?n.setLayerImage(e,t,i):(i=n.addLayer(e,t,o.options),a.layerIds.push(i)),n.displayImage(e,t),d.forEach(function(t,o){var l=a.findImageFn(t.imageIds,r),d=o+1,u=a.layerIds[d];u||(u=n.addLayer(e,void 0,t.options),a.layerIds.push(u)),l?n.loadAndCacheImage(l).then(function(t){n.setLayerImage(e,t,u),n.updateImage(e)}):(n.setLayerImage(e,void 0,u),n.setActiveLayer(e,i),n.updateImage(e))})})}}]),e}();t.default=d},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){var a=void 0,n=void 0,o=void 0,r=0,i=e.length,l=[];for(l.isTimeVarying=!1,("number"!=typeof t||t<=0)&&(t=1),a=1;a<i;a++)o=Number(e[a])/t|0,l.push(o),1===a?n=o:o!==n&&(l.isTimeVarying=!0),r+=o;return l.length>0&&(o=l.isTimeVarying?r/l.length|0:l[0],l.push(o)),l}function r(e){var t=e.intervalId;void 0!==t&&(e.intervalId=void 0,e.usingFrameTimeVector?clearTimeout(t):clearInterval(t))}function i(e){var t={element:e};(0,p.default)(e,s.default.CLIP_STOPPED,t)}function l(e,t){var a=void 0,n=void 0;if(void 0===e)throw new Error("playClip: element must not be undefined");var l=(0,g.getToolState)(e,"stack");if(l&&l.data&&l.data.length){var d=f.default.cornerstone,u=void 0;if(l.data.length>1){var s=(0,g.getToolState)(e,"stackRenderer");s&&s.data&&s.data.length&&(u=s.data[0])}var c=l.data[0],v=(0,g.getToolState)(e,E);v&&v.data&&v.data.length?(a=v.data[0],r(a)):(a={intervalId:void 0,framesPerSecond:30,lastFrameTimeStamp:void 0,frameRate:0,frameTimeVector:void 0,ignoreFrameTimeVector:!1,usingFrameTimeVector:!1,speed:1,reverse:!1,loop:!0},(0,g.addToolState)(e,E,a)),(t<0||t>0)&&(a.framesPerSecond=Number(t),a.reverse=a.framesPerSecond<0,a.ignoreFrameTimeVector=!0),!0!==a.ignoreFrameTimeVector&&a.frameTimeVector&&a.frameTimeVector.length===c.imageIds.length&&(n=o(a.frameTimeVector,a.speed));var h=function(){var t=void 0,n=void 0,o=void 0,s=void 0,f=c.currentImageIdIndex,v=c.imageIds.length;if(a.reverse?f--:f++,!a.loop&&(f<0||f>=v)){r(a),i(e);var g=document.getElementsByClassName("tool-play")[0];return g.classList.remove("icon-play"),void g.classList.add("icon-stop")}f>=v&&(f=0),f<0&&(f=v-1),f!==c.currentImageIdIndex&&(n=m.default.getStartLoadHandler(),o=m.default.getEndLoadHandler(),s=m.default.getErrorLoadingHandler(),n&&n(e),t=!0===c.preventCache?d.loadImage(c.imageIds[f]):d.loadAndCacheImage(c.imageIds[f]),t.then(function(t){try{c.currentImageIdIndex=f,u?(u.currentImageIdIndex=f,u.render(e,l.data)):d.displayImage(e,t),o&&o(e,t)}catch(e){return}},function(t){var a=c.imageIds[f];s&&s(e,a,t)}))};n&&n.length>0&&n.isTimeVarying?(a.usingFrameTimeVector=!0,a.intervalId=setTimeout(function e(){a.intervalId=setTimeout(e,n[c.currentImageIdIndex]),h()},0)):(a.usingFrameTimeVector=!1,a.intervalId=setInterval(h,1e3/Math.abs(a.framesPerSecond)))}}function d(e){var t=(0,g.getToolState)(e,E);t&&t.data&&t.data.length&&r(t.data[0])}Object.defineProperty(t,"__esModule",{value:!0}),t.stopClip=t.playClip=void 0;var u=a(1),s=n(u),c=a(0),f=n(c),v=a(9),m=n(v),g=a(2),h=a(5),p=n(h),E="playClip";t.playClip=l,t.stopClip=d},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e){var t=c.default.cornerstone,a=e.currentTarget,n=t.getEnabledElement(a);if(n.image){var o={event:window.event||e,element:a,viewport:t.getViewport(a),image:n.image,currentPoints:{page:{x:m,y:g},image:t.pageToPixel(a,m,g)},keyCode:e.keyCode,which:e.which};o.currentPoints.canvas=t.pixelToCanvas(a,o.currentPoints.image);var r={keydown:u.default.KEY_DOWN,keypress:u.default.KEY_PRESS,keyup:u.default.KEY_UP};(0,v.default)(a,r[e.type],o)}}function r(e){m=e.pageX,g=e.pageY}function i(e){h.forEach(function(t){e.removeEventListener(t,o),e.addEventListener(t,o)}),e.removeEventListener("mousemove",r),e.addEventListener("mousemove",r)}function l(e){h.forEach(function(t){e.removeEventListener(t,o)}),e.removeEventListener("mousemove",r)}Object.defineProperty(t,"__esModule",{value:!0});var d=a(1),u=n(d),s=a(0),c=n(s),f=a(5),v=n(f),m=void 0,g=void 0,h=["keydown","keypress","keyup"],p={enable:i,disable:l};t.default=p},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e){return"number"!=typeof e.buttons?e.which:0===e.buttons?0:e.buttons%2==1?1:e.buttons%4==2?3:e.buttons%8==4?2:0}function r(){y=!1}function i(e){var t=m.default.cornerstone,a=e.currentTarget,n=f.default.MOUSE_DOUBLE_CLICK,o=t.getEnabledElement(a);if(o.image){var r={page:m.default.cornerstoneMath.point.pageToPoint(e),image:t.pageToPixel(a,e.pageX,e.pageY),client:{x:e.clientX,y:e.clientY}};r.canvas=t.pixelToCanvas(a,r.image);var i=(0,h.default)(r),l={event:e,which:e.which,viewport:t.getViewport(a),image:o.image,element:a,startPoints:r,lastPoints:i,currentPoints:r,deltaPoints:{x:0,y:0},type:n};(0,M.default)(a,n,l)}}function l(e){function t(e){var t=f.default.MOUSE_DRAG,a={page:m.default.cornerstoneMath.point.pageToPoint(e),image:n.pageToPixel(i,e.pageX,e.pageY),client:{x:e.clientX,y:e.clientY}};a.canvas=n.pixelToCanvas(i,a.image);var o={page:m.default.cornerstoneMath.point.subtract(a.page,c.page),image:m.default.cornerstoneMath.point.subtract(a.image,c.image),client:m.default.cornerstoneMath.point.subtract(a.client,c.client),canvas:m.default.cornerstoneMath.point.subtract(a.canvas,c.canvas)},r={which:g,viewport:n.getViewport(i),image:u.image,element:i,startPoints:s,lastPoints:c,currentPoints:a,deltaPoints:o,type:t,ctrlKey:e.ctrlKey,metaKey:e.metaKey,shiftKey:e.shiftKey};return(0,M.default)(r.element,t,r),c=(0,h.default)(a),(0,E.default)(e)}function a(e){clearTimeout(x);var o=f.default.MOUSE_UP;y&&(o=f.default.MOUSE_CLICK);var r={page:m.default.cornerstoneMath.point.pageToPoint(e),image:n.pageToPixel(i,e.pageX,e.pageY),client:{x:e.clientX,y:e.clientY}};r.canvas=n.pixelToCanvas(i,r.image);var l={page:m.default.cornerstoneMath.point.subtract(r.page,c.page),image:m.default.cornerstoneMath.point.subtract(r.image,c.image),client:m.default.cornerstoneMath.point.subtract(r.client,c.client),canvas:m.default.cornerstoneMath.point.subtract(r.canvas,c.canvas)},v={event:e,which:g,viewport:n.getViewport(i),image:u.image,element:i,startPoints:s,lastPoints:c,currentPoints:r,deltaPoints:l,type:o};(0,M.default)(v.element,o,v),document.removeEventListener("mousemove",t),document.removeEventListener("mouseup",a),i.addEventListener("mousemove",d),y=!0}x=setTimeout(r,O);var n=m.default.cornerstone,i=e.currentTarget,l=f.default.MOUSE_DOWN,u=n.getEnabledElement(i);if(u.image){i.removeEventListener("mousemove",d);var s={page:m.default.cornerstoneMath.point.pageToPoint(e),image:n.pageToPixel(i,e.pageX,e.pageY),client:{x:e.clientX,y:e.clientY}};s.canvas=n.pixelToCanvas(i,s.image);var c=(0,h.default)(s),v={event:e,which:o(e),viewport:n.getViewport(i),image:u.image,element:i,startPoints:s,lastPoints:c,currentPoints:s,deltaPoints:{x:0,y:0},type:l};(0,M.default)(v.element,l,v)&&(v.type=f.default.MOUSE_DOWN_ACTIVATE,(0,M.default)(v.element,f.default.MOUSE_DOWN_ACTIVATE,v));var g=o(e);return document.addEventListener("mousemove",t),document.addEventListener("mouseup",a),(0,E.default)(e)}}function d(e){var t=m.default.cornerstone,a=e.currentTarget,n=f.default.MOUSE_MOVE,o=t.getEnabledElement(a);if(o.image){var r={page:m.default.cornerstoneMath.point.pageToPoint(e),image:t.pageToPixel(a,e.pageX,e.pageY),client:{x:e.clientX,y:e.clientY}};r.canvas=t.pixelToCanvas(a,r.image);var i=(0,h.default)(r),l={page:m.default.cornerstoneMath.point.pageToPoint(e),image:t.pageToPixel(a,e.pageX,e.pageY),client:{x:e.clientX,y:e.clientY}};l.canvas=t.pixelToCanvas(a,l.image);var d={page:m.default.cornerstoneMath.point.subtract(l.page,i.page),image:m.default.cornerstoneMath.point.subtract(l.image,i.image),client:m.default.cornerstoneMath.point.subtract(l.client,i.client),canvas:m.default.cornerstoneMath.point.subtract(l.canvas,i.canvas)},u={viewport:t.getViewport(a),image:o.image,element:a,startPoints:r,lastPoints:i,currentPoints:l,deltaPoints:d,type:n};(0,M.default)(a,n,u),i=(0,h.default)(l)}}function u(e){e.removeEventListener("mousedown",l),e.removeEventListener("mousemove",d),e.removeEventListener("dblclick",i)}function s(e){u(e),e.addEventListener("mousedown",l),e.addEventListener("mousemove",d),e.addEventListener("dblclick",i)}Object.defineProperty(t,"__esModule",{value:!0});var c=a(1),f=n(c),v=a(0),m=n(v),g=a(36),h=n(g),p=a(34),E=n(p),T=a(5),M=n(T),y=!0,x=void 0,O=200,P={enable:s,disable:u};t.default=P},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e){if(!("mousewheel"===e.type&&0===e.wheelDeltaY||"DOMMouseScroll"===e.type&&1===e.axis)){e.preventDefault();var t=s.default.cornerstone,a=e.currentTarget,n=t.getEnabledElement(a);if(n.image){var o=void 0,r=void 0;void 0!==e.pageX&&void 0!==e.pageY?(o=e.pageX,r=e.pageY):(o=e.x,r=e.y);var i=t.pageToPixel(a,o,r);e=window.event&&window.event.wheelDelta?window.event:e;var l=void 0;l=e.wheelDelta?e.wheelDelta:e.deltaY?-e.deltaY:e.detail?-e.detail:e.wheelDelta;var u=l<0?-1:1,c={element:a,viewport:t.getViewport(a),image:n.image,direction:u,pageX:o,pageY:r,imageX:i.x,imageY:i.y};(0,f.default)(a,d.default.MOUSE_WHEEL,c)}}}function r(e){i(e),v.forEach(function(t){e.addEventListener(t,o)})}function i(e){v.forEach(function(t){e.removeEventListener(t,o)})}Object.defineProperty(t,"__esModule",{value:!0});var l=a(1),d=n(l),u=a(0),s=n(u),c=a(5),f=n(c),v=["mousewheel","DOMMouseScroll"],m={enable:r,disable:i};t.default=m},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e){var t=s.default.cornerstone,a=e.currentTarget||e.srcEvent.currentTarget,n=t.getEnabledElement(a);if(n.image){var o=void 0,r=void 0,i=void 0,l=void 0,u=void 0;switch(e.preventDefault(),(e.pointers&&e.pointers.length>1||e.touches&&e.touches.length>1)&&(L=!1,clearTimeout(b)),e.type){case"tap":L=!1,clearTimeout(b),y={page:s.default.cornerstoneMath.point.pageToPoint(e.pointers[0]),image:t.pageToPixel(a,e.pointers[0].pageX,e.pointers[0].pageY),client:{x:e.pointers[0].clientX,y:e.pointers[0].clientY}},y.canvas=t.pixelToCanvas(a,y.image),o=d.default.TAP,P={event:e,viewport:t.getViewport(a),image:n.image,element:a,currentPoints:y,type:o,isTouchEvent:!0},(0,E.default)(a,o,P);break;case"doubletap":L=!1,clearTimeout(b),y={page:s.default.cornerstoneMath.point.pageToPoint(e.pointers[0]),image:t.pageToPixel(a,e.pointers[0].pageX,e.pointers[0].pageY),client:{x:e.pointers[0].clientX,y:e.pointers[0].clientY}},y.canvas=t.pixelToCanvas(a,y.image),o=d.default.DOUBLE_TAP,P={event:e,viewport:t.getViewport(a),image:n.image,element:a,currentPoints:y,type:o,isTouchEvent:!0},(0,E.default)(a,o,P);break;case"pinchstart":L=!1,clearTimeout(b),C=1;break;case"pinchmove":if(L=!1,clearTimeout(b),!0===w){C=e.scale,w=!1;break}r=(e.scale-C)/C,M={page:e.center,image:t.pageToPixel(a,e.center.x,e.center.y)},M.canvas=t.pixelToCanvas(a,M.image),o=d.default.TOUCH_PINCH,P={event:e,startPoints:M,viewport:t.getViewport(a),image:n.image,element:a,direction:e.scale<1?1:-1,scaleChange:r,type:o,isTouchEvent:!0},(0,E.default)(a,o,P),C=e.scale;break;case"touchstart":C=1,clearTimeout(b),clearTimeout(_),_=setTimeout(function(){M={page:s.default.cornerstoneMath.point.pageToPoint(e.touches[0]),image:t.pageToPixel(a,e.touches[0].pageX,e.touches[0].pageY),client:{x:e.touches[0].clientX,y:e.touches[0].clientY}},M.canvas=t.pixelToCanvas(a,M.image),o=d.default.TOUCH_START,e.touches.length>1&&(o=d.default.MULTI_TOUCH_START),P={event:e,viewport:t.getViewport(a),image:n.image,element:a,startPoints:M,currentPoints:M,type:o,isTouchEvent:!0},!0===(0,E.default)(a,o,P)&&(o=d.default.TOUCH_START_ACTIVE,e.touches.length>1&&(o=d.default.MULTI_TOUCH_START_ACTIVE),P.type=o,(0,E.default)(a,o,P)),x=(0,f.default)(M)},50),L=!0,S=0,b=setTimeout(function(){L&&(y={page:s.default.cornerstoneMath.point.pageToPoint(e.touches[0]),image:t.pageToPixel(a,e.touches[0].pageX,e.touches[0].pageY),client:{x:e.touches[0].clientX,y:e.touches[0].clientY}},y.canvas=t.pixelToCanvas(a,M.image),o=d.default.TOUCH_PRESS,P={event:e,viewport:t.getViewport(a),image:n.image,element:a,currentPoints:y,type:o,isTouchEvent:!0},(0,E.default)(a,o,P))},U);break;case"touchend":C=1,L=!1,clearTimeout(b),setTimeout(function(){M={page:s.default.cornerstoneMath.point.pageToPoint(e.changedTouches[0]),image:t.pageToPixel(a,e.changedTouches[0].pageX,e.changedTouches[0].pageY),client:{x:e.changedTouches[0].clientX,y:e.changedTouches[0].clientY}},M.canvas=t.pixelToCanvas(a,M.image),o=d.default.TOUCH_END,P={event:e,viewport:t.getViewport(a),image:n.image,element:a,startPoints:M,currentPoints:M,type:o,isTouchEvent:!0},(0,E.default)(a,o,P)},50);break;case"panmove":i={x:e.deltaX-D.x,y:e.deltaY-D.y},D={x:e.deltaX,y:e.deltaY},y={page:{x:x.page.x+i.x,y:x.page.y+i.y},image:t.pageToPixel(a,x.page.x+i.x,x.page.y+i.y),client:{x:x.client.x+i.x,y:x.client.y+i.y}},y.canvas=t.pixelToCanvas(a,y.image),O={page:s.default.cornerstoneMath.point.subtract(y.page,x.page),image:s.default.cornerstoneMath.point.subtract(y.image,x.image),client:s.default.cornerstoneMath.point.subtract(y.client,x.client),canvas:s.default.cornerstoneMath.point.subtract(y.canvas,x.canvas)},S+=Math.sqrt(O.page.x*O.page.x+O.page.y*O.page.y),S>A&&(L=!1,clearTimeout(b)),o=d.default.TOUCH_DRAG,e.pointers.length>1&&(o=d.default.MULTI_TOUCH_DRAG),P={viewport:t.getViewport(a),image:n.image,element:a,startPoints:M,lastPoints:x,currentPoints:y,deltaPoints:O,numPointers:e.pointers.length,type:o,isTouchEvent:!0},(0,E.default)(a,o,P),x=(0,f.default)(y);break;case"panstart":D={x:e.deltaX,y:e.deltaY},y={page:s.default.cornerstoneMath.point.pageToPoint(e.pointers[0]),image:t.pageToPixel(a,e.pointers[0].pageX,e.pointers[0].pageY),client:{x:e.pointers[0].clientX,y:e.pointers[0].clientY}},y.canvas=t.pixelToCanvas(a,y.image),x=(0,f.default)(y);break;case"panend":return L=!1,(clearTimeout(b),x)?(y={page:s.default.cornerstoneMath.point.pageToPoint(e.pointers[0]),image:t.pageToPixel(a,e.pointers[0].pageX,e.pointers[0].pageY),client:{x:e.pointers[0].clientX,y:e.pointers[0].clientY}},y.canvas=t.pixelToCanvas(a,y.image),O={page:s.default.cornerstoneMath.point.subtract(y.page,x.page),image:s.default.cornerstoneMath.point.subtract(y.image,x.image),client:s.default.cornerstoneMath.point.subtract(y.client,x.client),canvas:s.default.cornerstoneMath.point.subtract(y.canvas,x.canvas)},o=d.default.TOUCH_DRAG_END,P={event:e.srcEvent,viewport:t.getViewport(a),image:n.image,element:a,startPoints:M,lastPoints:x,currentPoints:y,deltaPoints:O,type:o,isTouchEvent:!0},(0,E.default)(a,o,P),l=e.pointers.length-e.changedPointers.length,2===l&&(w=!0),(0,m.default)(e)):!1;case"rotatemove":L=!1,clearTimeout(b),u=e.rotation-I,I=e.rotation,o=d.default.TOUCH_ROTATE,P={event:e.srcEvent,viewport:t.getViewport(a),image:n.image,element:a,rotation:u,type:o},(0,E.default)(a,o,P)}return!1}}function r(e){i(e);var t=s.default.Hammer,a={inputClass:t.SUPPORT_POINTER_EVENTS?t.PointerEventInput:t.TouchInput},n=new t.Manager(e,a),r={pointers:0,direction:t.DIRECTION_ALL,threshold:0},l=new t.Pan(r),d=new t.Pinch({threshold:0}),u=new t.Rotate({threshold:0});d.recognizeWith(l),d.recognizeWith(u),u.recognizeWith(l);var c=new t.Tap({event:"doubletap",taps:2,interval:1500,threshold:50,posThreshold:50});c.recognizeWith(l),n.add([c,l,u,d]),n.on("tap doubletap panstart panmove panend pinchstart pinchmove rotatemove",o),h.default.enable(e),["touchstart","touchend"].forEach(function(t){e.addEventListener(t,o)});var f=(0,T.getToolOptions)(k,e);f.hammer=n,(0,T.setToolOptions)(k,e,f)}function i(e){h.default.disable(e),["touchstart","touchend"].forEach(function(t){e.removeEventListener(t,o)});var t=(0,T.getToolOptions)(k,e),a=t.hammer;a&&a.off("tap doubletap panstart panmove panend pinchstart pinchmove rotatemove",o)}Object.defineProperty(t,"__esModule",{value:!0});var l=a(1),d=n(l),u=a(0),s=n(u),c=a(36),f=n(c),v=a(34),m=n(v),g=a(54),h=n(g),p=a(5),E=n(p),T=a(3),M=void 0,y=void 0,x=void 0,O=void 0,P=void 0,_=void 0,b=void 0,S=void 0,C=1,I=0,w=!1,L=!1,D=void 0,U=700,A=5,k="touchInput",R={enable:r,disable:i};t.default=R},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e){return{visible:!0,active:!0,handles:{start:{x:e.currentPoints.image.x-20,y:e.currentPoints.image.y+10,highlight:!0,active:!1},end:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!0},start2:{x:e.currentPoints.image.x-20,y:e.currentPoints.image.y+10,highlight:!0,active:!1},end2:{x:e.currentPoints.image.x,y:e.currentPoints.image.y+20,highlight:!0,active:!1}}}}function r(e,t,a){var n=u.default.cornerstone,o={start:n.pixelToCanvas(e,t.handles.start),end:n.pixelToCanvas(e,t.handles.end)},r=u.default.cornerstoneMath.lineSegment.distanceToPoint(o,a);return r<5||(o.start=n.pixelToCanvas(e,t.handles.start2),o.end=n.pixelToCanvas(e,t.handles.end2),(r=u.default.cornerstoneMath.lineSegment.distanceToPoint(o,a))<5)}function i(e){var t=e.detail,a=(0,b.getToolState)(e.currentTarget,D);if(void 0!==a){var n=t.canvasContext.canvas.getContext("2d");n.setTransform(1,0,0,1,0,0);for(var o=void 0,r=T.default.getToolWidth(),i=y.default.getFont(),l=U.getConfiguration(),d=u.default.cornerstone,s=0;s<a.data.length;s++){n.save(),l&&l.shadow&&(n.shadowColor=l.shadowColor||"#000000",n.shadowOffsetX=l.shadowOffsetX||1,n.shadowOffsetY=l.shadowOffsetY||1);var c=a.data[s];o=c.active?O.default.getActiveColor():O.default.getToolColor(),n.beginPath(),n.strokeStyle=o,n.lineWidth=r;var f=d.pixelToCanvas(t.element,c.handles.start),v=d.pixelToCanvas(t.element,c.handles.end);n.moveTo(f.x,f.y),n.lineTo(v.x,v.y),f=d.pixelToCanvas(t.element,c.handles.start2),v=d.pixelToCanvas(t.element,c.handles.end2),n.moveTo(f.x,f.y),n.lineTo(v.x,v.y),n.stroke(),(0,_.default)(n,t,c.handles),n.fillStyle=o;var m=(Math.ceil(c.handles.start.x)-Math.ceil(c.handles.end.x))*t.image.columnPixelSpacing,h=(Math.ceil(c.handles.start.y)-Math.ceil(c.handles.end.y))*t.image.rowPixelSpacing,E=(Math.ceil(c.handles.start2.x)-Math.ceil(c.handles.end2.x))*t.image.columnPixelSpacing,M=(Math.ceil(c.handles.start2.y)-Math.ceil(c.handles.end2.y))*t.image.rowPixelSpacing,x=Math.acos(Math.abs((m*E+h*M)/(Math.sqrt(m*m+h*h)*Math.sqrt(E*E+M*M))));x*=180/Math.PI;var P=(0,p.default)(x,2),S=P.toString()+String.fromCharCode(parseInt("00B0",16)),C=(f.x+v.x)/2,I=(f.y+v.y)/2;n.font=i,(0,g.default)(n,S,C,I,o),n.restore()}}}function l(e){var t=e.detail,a=t.element,n=u.default.cornerstone,o=(0,L.getToolOptions)(D,a),i=void 0;if((0,C.default)(t.which,o.mouseButtonMask)){var l=t.currentPoints.canvas,d=(0,b.getToolState)(a,D);if(d)for(var s=0;s<d.data.length;s++)if(i=d.data[s],r(a,i,l)||(0,w.default)(i.handles.textBox,l))return(0,b.removeToolState)(a,D,i),n.updateImage(a),e.stopImmediatePropagation(),!1}}Object.defineProperty(t,"__esModule",{value:!0}),t.angleTouch=t.angle=void 0;var d=a(0),u=n(d),s=a(10),c=n(s),f=a(13),v=n(f),m=a(7),g=n(m),h=a(32),p=n(h),E=a(8),T=n(E),M=a(14),y=n(M),x=a(6),O=n(x),P=a(11),_=n(P),b=a(2),S=a(4),C=n(S),I=a(12),w=n(I),L=a(3),D="angle",U=(0,c.default)({mouseDoubleClickCallback:l,createNewMeasurement:o,onImageRendered:i,pointNearTool:r,toolType:D}),A=(0,v.default)({createNewMeasurement:o,onImageRendered:i,pointNearTool:r,toolType:D});t.angle=U,t.angleTouch=A},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e){e(prompt("Enter your annotation:"))}function r(e,t,a){a(prompt("Change your annotation:"))}function i(e){function t(e){null===e?(0,G.removeToolState)(a,F,n):n.text=e,n.active=!1,o.updateImage(a),a.addEventListener(m.default.MOUSE_MOVE,K.mouseMoveCallback),a.addEventListener(m.default.MOUSE_DOWN,K.mouseDownCallback),a.addEventListener(m.default.MOUSE_DOWN_ACTIVATE,K.mouseDownActivateCallback),a.addEventListener(m.default.MOUSE_DOUBLE_CLICK,K.mouseDoubleClickCallback)}var a=e.element,n=l(e),o=h.default.cornerstone;(0,G.addToolState)(a,F,n),a.removeEventListener(m.default.MOUSE_MOVE,K.mouseMoveCallback),a.removeEventListener(m.default.MOUSE_DOWN,K.mouseDownCallback),a.removeEventListener(m.default.MOUSE_DOWN_ACTIVATE,K.mouseDownActivateCallback),a.removeEventListener(m.default.MOUSE_DOUBLE_CLICK,K.mouseDoubleClickCallback),o.updateImage(a),(0,A.default)(e,F,n,n.handles.end,function(){(0,N.default)(e,n.handles)&&(0,G.removeToolState)(a,F,n);var r=K.getConfiguration();void 0===n.text&&r.getTextCallback(t),o.updateImage(a)})}function l(e){return{visible:!0,active:!0,handles:{start:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!1},end:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!1},textBox:{active:!1,hasMoved:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0}}}}function d(e,t,a){var n=h.default.cornerstone,o={start:n.pixelToCanvas(e,t.handles.start),end:n.pixelToCanvas(e,t.handles.end)};return h.default.cornerstoneMath.lineSegment.distanceToPoint(o,a)<25}function u(e){var t=e.detail,a=(0,G.getToolState)(e.currentTarget,F);if(a){var n=t.enabledElement,o=h.default.cornerstone,r=t.canvasContext.canvas.getContext("2d");r.setTransform(1,0,0,1,0,0);for(var i=void 0,l=P.default.getToolWidth(),d=b.default.getFont(),u=K.getConfiguration(),s=0;s<a.data.length;s++){r.save(),u&&u.shadow&&(r.shadowColor=u.shadowColor||"#000000",r.shadowOffsetX=u.shadowOffsetX||1,r.shadowOffsetY=u.shadowOffsetY||1);var c=a.data[s];i=c.active?C.default.getActiveColor():C.default.getToolColor();var f=o.pixelToCanvas(t.element,c.handles.start),v=o.pixelToCanvas(t.element,c.handles.end);u.arrowFirst?(0,D.default)(r,v,f,i,l):(0,D.default)(r,f,v,i,l);var m={drawHandlesIfActive:u&&u.drawHandlesOnHover};if(u.drawHandles&&(0,w.default)(r,t,c.handles,i,m),c.text&&""!==c.text){r.font=d;var g=r.measureText(c.text).width+10,p=b.default.getFontSize()+10,E=Math.max(g,p)/2+5;v.x<f.x&&(E=-E);var T=void 0;if(!c.handles.textBox.hasMoved){T=u.arrowFirst?{x:v.x-g/2+E,y:v.y-p/2}:{x:f.x-g/2-E,y:f.y-p/2};var M=o.internal.getTransform(n);M.invert();var y=M.transformPoint(T.x,T.y);c.handles.textBox.x=y.x,c.handles.textBox.y=y.y}T=o.pixelToCanvas(t.element,c.handles.textBox);var O=(0,x.default)(r,c.text,T.x,T.y,i);if(c.handles.textBox.boundingBox=O,c.handles.textBox.hasMoved){var _={start:{},end:{}},S={x:(f.x+v.x)/2,y:(f.y+v.y)/2},I=[f,v,S];_.end.x=T.x,_.end.y=T.y,_.start=h.default.cornerstoneMath.point.findClosestPoint(I,_.end);var L=[{x:O.left+O.width/2,y:O.top},{x:O.left,y:O.top+O.height/2},{x:O.left+O.width/2,y:O.top+O.height},{x:O.left+O.width,y:O.top+O.height/2}];_.end=h.default.cornerstoneMath.point.findClosestPoint(L,_.start),r.beginPath(),r.strokeStyle=i,r.lineWidth=l,r.setLineDash([2,3]),r.moveTo(_.start.x,_.start.y),r.lineTo(_.end.x,_.end.y),r.stroke()}}r.restore()}}}function s(e){function t(e){null===e?(0,G.removeToolState)(a,F,n):n.text=e,n.active=!1,o.updateImage(a),a.addEventListener(m.default.TOUCH_PRESS,X.pressCallback),a.addEventListener(m.default.TOUCH_START_ACTIVE,X.touchDownActivateCallback),a.addEventListener(m.default.TAP,X.tapCallback)}var a=e.element,n=l(e),o=h.default.cornerstone;(0,G.addToolState)(a,F,n),a.removeEventListener(m.default.TOUCH_PRESS,X.pressCallback),a.removeEventListener(m.default.TOUCH_START_ACTIVE,X.touchDownActivateCallback),a.removeEventListener(m.default.TAP,X.tapCallback),o.updateImage(a),(0,R.default)(e,F,n,n.handles.end,function(){o.updateImage(a),(0,N.default)(e,n.handles)&&(0,G.removeToolState)(a,F,n);var r=K.getConfiguration();void 0===n.text&&r.getTextCallback(t)})}function c(e){function t(e,t,a){!0===a?(0,G.removeToolState)(n,F,e):e.text=t,e.active=!1,o.updateImage(n)}var a=e.detail,n=a.element,o=h.default.cornerstone,r=(0,z.getToolOptions)(F,n),i=void 0;if((0,V.default)(a.which,r.mouseButtonMask)){var l=K.getConfiguration(),u=a.currentPoints.canvas,s=(0,G.getToolState)(n,F);if(s)for(var c=0;c<s.data.length;c++)if(i=s.data[c],d(n,i,u)||(0,W.default)(i.handles.textBox,u))return i.active=!0,o.updateImage(n),l.changeTextCallback(i,a,t),e.stopImmediatePropagation(),!1}}function f(e){function t(e,t,a){console.log("pressCallback doneChangingTextCallback"),!0===a?(0,G.removeToolState)(n,F,e):e.text=t,e.active=!1,o.updateImage(n),n.addEventListener(m.default.TOUCH_START,X.touchStartCallback),n.addEventListener(m.default.TOUCH_START_ACTIVE,X.touchDownActivateCallback),n.addEventListener(m.default.TAP,X.tapCallback)}var a=e.detail,n=a.element,o=h.default.cornerstone,r=void 0,i=K.getConfiguration(),l=a.currentPoints.canvas,u=(0,G.getToolState)(n,F);if(u){if(a.handlePressed)return n.removeEventListener(m.default.TOUCH_START,X.touchStartCallback),n.removeEventListener(m.default.TOUCH_START_ACTIVE,X.touchDownActivateCallback),n.removeEventListener(m.default.TAP,X.tapCallback),i.changeTextCallback(a.handlePressed,a,t),e.stopImmediatePropagation(),!1;for(var s=0;s<u.data.length;s++)if(r=u.data[s],d(n,r,l)||(0,W.default)(r.handles.textBox,l))return r.active=!0,o.updateImage(n),n.removeEventListener(m.default.TOUCH_START,X.touchStartCallback),n.removeEventListener(m.default.TOUCH_START_ACTIVE,X.touchDownActivateCallback),n.removeEventListener(m.default.TAP,X.tapCallback),i.changeTextCallback(r,a,t),e.stopImmediatePropagation(),!1;e.preventDefault(),e.stopPropagation()}}Object.defineProperty(t,"__esModule",{value:!0}),t.arrowAnnotateTouch=t.arrowAnnotate=void 0;var v=a(1),m=n(v),g=a(0),h=n(g),p=a(10),E=n(p),T=a(13),M=n(T),y=a(7),x=n(y),O=a(8),P=n(O),_=a(14),b=n(_),S=a(6),C=n(S),I=a(11),w=n(I),L=a(49),D=n(L),U=a(24),A=n(U),k=a(27),R=n(k),j=a(15),N=n(j),H=a(4),V=n(H),B=a(12),W=n(B),G=a(2),z=a(3),F="arrowAnnotate",Y={getTextCallback:o,changeTextCallback:r,drawHandles:!1,drawHandlesOnHover:!0,arrowFirst:!0},K=(0,E.default)({addNewMeasurement:i,createNewMeasurement:l,onImageRendered:u,pointNearTool:d,toolType:F,mouseDoubleClickCallback:c});K.setConfiguration(Y);var X=(0,M.default)({addNewMeasurement:s,createNewMeasurement:l,onImageRendered:u,pointNearTool:d,toolType:F,pressCallback:f});t.arrowAnnotate=K,t.arrowAnnotateTouch=X},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e){var t=e.detail;e.stopImmediatePropagation();var a=(0,y.getToolState)(e.currentTarget,C);if(a){var n=E.default.cornerstone,o=e.currentTarget,r=n.getEnabledElement(o),i=r.image.imageId,l=n.metaData.get("imagePlaneModule",i),d=t.currentPoints.image,u=(0,P.imagePointToPatientPoint)(d,l);a.data[0].synchronizationContext.getSourceElements().forEach(function(e){if(e!==o){var t=Number.MAX_VALUE,a=-1,r=(0,y.getToolState)(e,"stack");if(void 0!==r){var i=r.data[0];if(i.imageIds.forEach(function(e,o){var r=n.metaData.get("imagePlaneModule",e);if(r&&r.imagePositionPatient&&r.rowCosines&&r.columnCosines){var i=(0,b.default)(r.imagePositionPatient),l=(0,b.default)(r.rowCosines),d=(0,b.default)(r.columnCosines),s=d.clone().cross(l.clone()),c=Math.abs(s.clone().dot(i)-s.clone().dot(u));c<t&&(t=c,a=o)}}),a!==i.currentImageIdIndex&&-1!==a&&void 0!==i.imageIds[a]){var l=M.default.getStartLoadHandler(),d=M.default.getEndLoadHandler(),s=M.default.getErrorLoadingHandler();l&&l(e);var c=void 0;c=!0===i.preventCache?n.loadImage(i.imageIds[a]):n.loadAndCacheImage(i.imageIds[a]),c.then(function(t){var o=n.getViewport(e);i.currentImageIdIndex=a,n.displayImage(e,t,o),d&&d(e,t)},function(t){var n=i.imageIds[a];s&&s(e,n,t)})}}}})}}function r(e){var t=e.detail,a=t.element;a.removeEventListener(h.default.MOUSE_DRAG,l),a.removeEventListener(h.default.MOUSE_UP,r)}function i(e){var t=e.detail,a=t.element,n=(0,S.getToolOptions)(C,a);(0,O.default)(t.which,n.mouseButtonMask)&&(a.addEventListener(h.default.MOUSE_DRAG,l),a.addEventListener(h.default.MOUSE_UP,r),o(e),e.preventDefault(),e.stopPropagation())}function l(e){o(e),e.preventDefault(),e.stopPropagation()}function d(e,t,a){(0,S.setToolOptions)(C,e,{mouseButtonMask:t}),(0,y.clearToolState)(e,C),(0,y.addToolState)(e,C,{synchronizationContext:a}),e.removeEventListener(h.default.MOUSE_DOWN,i),e.addEventListener(h.default.MOUSE_DOWN,i)}function u(e){e.removeEventListener(h.default.MOUSE_DOWN,i)}function s(e){var t=e.detail,a=t.element;a.removeEventListener(h.default.TOUCH_DRAG,f),a.removeEventListener(h.default.TOUCH_DRAG_END,s)}function c(e){var t=e.detail,a=t.element;return a.addEventListener(h.default.TOUCH_DRAG,f),a.addEventListener(h.default.TOUCH_DRAG_END,s),o(e),!1}function f(e){o(e),e.preventDefault(),e.stopPropagation()}function v(e,t){(0,y.clearToolState)(e,C),(0,y.addToolState)(e,C,{synchronizationContext:t}),e.removeEventListener(h.default.TOUCH_START,c),e.addEventListener(h.default.TOUCH_START,c)}function m(e){e.removeEventListener(h.default.TOUCH_START,c)}Object.defineProperty(t,"__esModule",{value:!0}),t.crosshairsTouch=t.crosshairs=void 0;var g=a(1),h=n(g),p=a(0),E=n(p),T=a(9),M=n(T),y=a(2),x=a(4),O=n(x),P=a(28),_=a(17),b=n(_),S=a(3),C="crosshairs",I={activate:d,deactivate:u,enable:d,disable:u},w={activate:v,deactivate:m,enable:v,disable:m};t.crosshairs=I,t.crosshairsTouch=w},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e){l.default.cornerstone.fitToWindow(e.element)}function r(e){var t=e.detail;s.strategy(t),e.preventDefault(),e.stopPropagation()}Object.defineProperty(t,"__esModule",{value:!0});var i=a(0),l=n(i),d=a(55),u=n(d),s=(0,u.default)(r);s.strategies={default:o},s.strategy=o,t.default=s},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e){var t=v.default.cornerstone,a=t.getEnabledElement(e.element),n=a.canvas.getContext("2d");n.setTransform(1,0,0,1,0,0);var o=y.default.getActiveColor(),r=T.default.getFont(),i=T.default.getFontSize(),l=U.getConfiguration();n.save(),l&&l.shadow&&(n.shadowColor=l.shadowColor||"#000000",n.shadowOffsetX=l.shadowOffsetX||1,n.shadowOffsetY=l.shadowOffsetY||1);var d=Math.round(e.currentPoints.image.x),u=Math.round(e.currentPoints.image.y),s=void 0,c=void 0,f=void 0;if(!(d<0||u<0||d>=e.image.columns||u>=e.image.rows)){if(e.image.color)s=(0,_.default)(e.element,d,u,1,1),c=d+", "+u,f="R: "+s[0]+" G: "+s[1]+" B: "+s[2]+" A: "+s[3];else{s=t.getStoredPixels(e.element,d,u,1,1);var m=s[0],g=m*e.image.slope+e.image.intercept,h=(0,S.default)(e.image,m);c=d+", "+u,f="SP: "+m+" MO: "+parseFloat(g.toFixed(3)),h&&(f+=" SUV: "+parseFloat(h.toFixed(3)))}var p={x:e.currentPoints.image.x+3,y:e.currentPoints.image.y-3},E=t.pixelToCanvas(e.element,p);n.font=r,n.fillStyle=o,(0,O.default)(n,f,E.x,E.y+i+5,o),(0,O.default)(n,c,E.x,E.y,o),n.restore()}}function r(e){var t=v.default.cornerstone,a=e.element,n=t.getEnabledElement(a),o=n.image,r=n.canvas.getContext("2d");r.setTransform(1,0,0,1,0,0);var i=y.default.getActiveColor(),l=T.default.getFont(),d=U.getConfiguration();r.save(),d&&d.shadow&&(r.shadowColor=d.shadowColor||"#000000",r.shadowOffsetX=d.shadowOffsetX||1,r.shadowOffsetY=d.shadowOffsetY||1);var u=t.metaData.get("generalSeriesModule",o.imageId),s=void 0;u&&(s=u.modality);var c=void 0;c=!0===e.isTouchEvent?t.pageToPixel(a,e.currentPoints.page.x,e.currentPoints.page.y-4*T.default.getFontSize()):t.pageToPixel(a,e.currentPoints.page.x,e.currentPoints.page.y-T.default.getFontSize()/2);var f=void 0,m="";if(!(c.x<0||c.y<0||c.x>=o.columns||c.y>=o.rows)){if(o.color)f=(0,_.default)(a,c.x,c.y,1,1),m="R: "+f[0]+" G: "+f[1]+" B: "+f[2];else{f=t.getStoredPixels(a,c.x,c.y,1,1);var g=f[0],h=g*e.image.slope+e.image.intercept,p=parseFloat(h.toFixed(2));if("CT"===s)m+="HU: "+p;else if("PT"===s){m+=p;var E=(0,S.default)(e.image,g);E&&(m+=" SUV: "+parseFloat(E.toFixed(2)))}else m+=p}var M=t.pixelToCanvas(a,c);r.font=l,r.fillStyle=i;var x=void 0,P=r.measureText(m).width;x=!0===e.isTouchEvent?{x:-P/2-5,y:-T.default.getFontSize()-10-12}:{x:12,y:-(T.default.getFontSize()+10)/2},r.beginPath(),r.strokeStyle=i,r.arc(M.x,M.y,6,0,2*Math.PI),r.stroke(),(0,O.default)(r,m,M.x+x.x,M.y+x.y,i),r.restore()}}function i(e){var t=e.detail,a=t.element;a.removeEventListener(c.default.IMAGE_RENDERED,d),a.removeEventListener(c.default.MOUSE_DRAG,u),a.removeEventListener(c.default.MOUSE_UP,i),a.removeEventListener(c.default.MOUSE_CLICK,i),v.default.cornerstone.updateImage(t.element)}function l(e){var t=e.detail,a=t.element,n=(0,w.getToolOptions)(L,a);(0,I.default)(t.which,n.mouseButtonMask)&&(a.addEventListener(c.default.IMAGE_RENDERED,d),a.addEventListener(c.default.MOUSE_DRAG,u),a.addEventListener(c.default.MOUSE_UP,i),a.addEventListener(c.default.MOUSE_CLICK,i),U.strategy(t),e.preventDefault(),e.stopPropagation())}function d(){D&&(U.strategy(D),D=null)}function u(e){var t=e.detail,a=t.element;D=t,v.default.cornerstone.updateImage(a),e.preventDefault(),e.stopPropagation()}Object.defineProperty(t,"__esModule",{value:!0}),t.dragProbeTouch=t.dragProbe=void 0;var s=a(1),c=n(s),f=a(0),v=n(f),m=a(18),g=n(m),h=a(16),p=n(h),E=a(14),T=n(E),M=a(6),y=n(M),x=a(7),O=n(x),P=a(35),_=n(P),b=a(20),S=n(b),C=a(4),I=n(C),w=a(3),L="dragProbe",D=void 0,U=(0,g.default)(l,L);U.strategies={default:o,minimal:r},U.strategy=o;var A={fireOnTouchStart:!0},k=(0,p.default)(u,L,A);t.dragProbe=U,t.dragProbeTouch=k},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e){return{visible:!0,active:!0,invalidated:!0,handles:{start:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!1},end:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!0},textBox:{active:!1,hasMoved:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0}}}}function r(e,t,a,n){var o=f.default.cornerstone,r=o.pixelToCanvas(e,t.handles.start),i=o.pixelToCanvas(e,t.handles.end),l={left:Math.min(r.x,i.x)+n/2,top:Math.min(r.y,i.y)+n/2,width:Math.abs(r.x-i.x)-n,height:Math.abs(r.y-i.y)-n},d={left:Math.min(r.x,i.x)-n/2,top:Math.min(r.y,i.y)-n/2,width:Math.abs(r.x-i.x)+n,height:Math.abs(r.y-i.y)+n},u=(0,C.default)(l,a);return!(!(0,C.default)(d,a)||u)}function i(e,t,a){return r(e,t,a,15)}function l(e,t,a){return r(e,t,a,25)}function d(e){var t=e.toString().split(".");return t[0]=t[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),t.join(".")}function u(e){var t=e.detail,a=(0,U.getToolState)(e.currentTarget,H);if(a){var n=f.default.cornerstone,o=t.image,r=t.element,i=E.default.getToolWidth(),l=V.getConfiguration(),u=t.canvasContext.canvas.getContext("2d"),s=n.metaData.get("generalSeriesModule",o.imageId),c=void 0;s&&(c=s.modality),u.setTransform(1,0,0,1,0,0);for(var v=0;v<a.data.length;v++){u.save();var m=a.data[v];l&&l.shadow&&(u.shadowColor=l.shadowColor||"#000000",u.shadowOffsetX=l.shadowOffsetX||1,u.shadowOffsetY=l.shadowOffsetY||1);var g=M.default.getColorIfActive(m.active),h=n.pixelToCanvas(r,m.handles.start),p=n.pixelToCanvas(r,m.handles.end),T=Math.min(h.x,p.x),y=Math.min(h.y,p.y),O=Math.abs(h.x-p.x),_=Math.abs(h.y-p.y);if(u.beginPath(),u.strokeStyle=g,u.lineWidth=i,(0,b.default)(u,T,y,O,_),u.closePath(),l&&l.drawHandlesOnHover)if(!0===m.active)(0,x.default)(u,t,m.handles,g);else{var S={drawHandlesIfActive:!0};(0,x.default)(u,t,m.handles,g,S)}else(0,x.default)(u,t,m.handles,g);var C=void 0,I=void 0,L=void 0;if(!1===m.invalidated)I=m.meanStdDev,L=m.meanStdDevSUV,C=m.area;else{var A={left:Math.round(Math.min(m.handles.start.x,m.handles.end.x)),top:Math.round(Math.min(m.handles.start.y,m.handles.end.y)),width:Math.round(Math.abs(m.handles.start.x-m.handles.end.x)),height:Math.round(Math.abs(m.handles.start.y-m.handles.end.y))};if(!o.color){var k=n.getPixels(r,A.left,A.top,A.width,A.height);I=(0,w.default)(k,A),"PT"===c&&(L={mean:(0,D.default)(o,(I.mean-o.intercept)/o.slope),stdDev:(0,D.default)(o,(I.stdDev-o.intercept)/o.slope)}),I&&!isNaN(I.mean)&&(m.meanStdDev=I,m.meanStdDevSUV=L)}var R=o.columnPixelSpacing||1,j=o.rowPixelSpacing||1;C=Math.PI*(A.width*R/2)*(A.height*j/2),isNaN(C)||(m.area=C),m.invalidated=!1}var N=[];if(I&&void 0!==I.mean){var B="";"CT"===c&&(B=" HU");var W="平均值: "+d(I.mean.toFixed(2))+B,G="标准差: "+d(I.stdDev.toFixed(2))+B;if(L&&void 0!==L.mean){W+=" SUV: "+d(L.mean.toFixed(2)),G+=" SUV: "+d(L.stdDev.toFixed(2))}N.push(W),N.push(G)}if(C){var z=" mm"+String.fromCharCode(178);o.rowPixelSpacing&&o.columnPixelSpacing||(z=" pixels"+String.fromCharCode(178));var F="面积: "+d(C.toFixed(2))+z;N.push(F)}m.handles.textBox.hasMoved||(m.handles.textBox.x=Math.max(m.handles.start.x,m.handles.end.x),m.handles.textBox.y=(m.handles.start.y+m.handles.end.y)/2);var Y=n.pixelToCanvas(r,m.handles.textBox),K={centering:{x:!1,y:!0}},X=(0,P.default)(u,N,Y.x,Y.y,g,K);if(m.handles.textBox.boundingBox=X,m.handles.textBox.hasMoved){var q={start:{},end:{x:Y.x,y:Y.y}},$=[{x:T+O/2,y:y},{x:T,y:y+_/2},{x:T+O/2,y:y+_},{x:T+O,y:y+_/2}];q.start=f.default.cornerstoneMath.point.findClosestPoint($,q.end);var Z=[{x:X.left+X.width/2,y:X.top},{x:X.left,y:X.top+X.height/2},{x:X.left+X.width/2,y:X.top+X.height},{x:X.left+X.width,y:X.top+X.height/2}];q.end=f.default.cornerstoneMath.point.findClosestPoint(Z,q.start),u.beginPath(),u.strokeStyle=g,u.lineWidth=i,u.setLineDash([2,3]),u.moveTo(q.start.x,q.start.y),u.lineTo(q.end.x,q.end.y),u.stroke()}u.restore()}}}function s(e){var t=e.detail,a=t.element,n=f.default.cornerstone,o=(0,N.getToolOptions)(H,a),r=void 0;if((0,k.default)(t.which,o.mouseButtonMask)){var l=t.currentPoints.canvas,d=(0,U.getToolState)(a,H);if(d)for(var u=0;u<d.data.length;u++)if(r=d.data[u],i(a,r,l)||(0,j.default)(r.handles.textBox,l))return(0,U.removeToolState)(a,H,r),n.updateImage(a),e.stopImmediatePropagation(),!1}}Object.defineProperty(t,"__esModule",{value:!0}),t.ellipticalRoiTouch=t.ellipticalRoi=void 0;var c=a(0),f=n(c),v=a(10),m=n(v),g=a(13),h=n(g),p=a(8),E=n(p),T=a(6),M=n(T),y=a(11),x=n(y),O=a(7),P=n(O),_=a(47),b=n(_),S=a(33),C=n(S),I=a(50),w=n(I),L=a(20),D=n(L),U=a(2),A=a(4),k=n(A),R=a(12),j=n(R),N=a(3),H="ellipticalRoi",V=(0,m.default)({mouseDoubleClickCallback:s,createNewMeasurement:o,onImageRendered:u,pointNearTool:i,toolType:H}),B=(0,h.default)({createNewMeasurement:o,onImageRendered:u,pointNearTool:l,toolType:H});t.ellipticalRoi=V,t.ellipticalRoiTouch=B},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e){var t=(0,L.getToolState)(e.element,U);if(void 0!==t){var a=k.getConfiguration(),n=t.data[a.currentTool],o={x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!0,lines:[]};n.handles.length&&n.handles[a.currentHandle-1].lines.push(e.currentPoints.image),n.handles.push(o),a.currentHandle+=1,a.freehand=!1,x.default.cornerstone.updateImage(e.element)}}function r(e,t){var a=(0,L.getToolState)(e.element,U);if(void 0!==a){var n=a.data[t];if(void 0!==n.handles)for(var o=e.currentPoints.canvas,r=0;r<n.handles.length;r++){var i=x.default.cornerstone.pixelToCanvas(e.element,n.handles[r]);if(x.default.cornerstoneMath.point.distance(i,o)<5)return r}}}function i(e){var t=(0,L.getToolState)(e.element,U);if(t)for(var a=void 0,n=0;n<t.data.length;n++)if(void 0!==(a=r(e,n)))return{handleNearby:a,toolIndex:n}}function l(e){var t=e.detail;if(t.element.removeEventListener(M.default.MOUSE_UP,l),void 0!==(0,L.getToolState)(t.element,U)){var a=k.getConfiguration();t.event.shiftKey||(a.freehand=!1),x.default.cornerstone.updateImage(t.element)}}function d(e){var t=e.detail,a=(0,L.getToolState)(t.element,U);if(a){var n=k.getConfiguration(),o=a.data[n.currentTool],i=Math.max(t.currentPoints.image.x,0);i=Math.min(i,t.image.width),n.mouseLocation.handles.start.x=i;var l=Math.max(t.currentPoints.image.y,0);l=Math.min(l,t.image.height),n.mouseLocation.handles.start.y=l;var d=n.currentHandle;if(n.modifying&&(o.active=!0,o.highlight=!0,o.handles[d].x=n.mouseLocation.handles.start.x,o.handles[d].y=n.mouseLocation.handles.start.y,d)){var u=o.handles[d-1].lines.length-1,s=o.handles[d-1].lines[u];s.x=n.mouseLocation.handles.start.x,s.y=n.mouseLocation.handles.start.y}if(n.freehand)o.handles[d-1].lines.push(t.currentPoints.image);else{var c=r(t,n.currentTool);void 0!==c&&c<o.handles.length-1&&(n.mouseLocation.handles.start.x=o.handles[c].x,n.mouseLocation.handles.start.y=o.handles[c].y)}x.default.cornerstone.updateImage(t.element)}}function u(e){var t=e.element;t.addEventListener(M.default.MOUSE_MOVE,d),t.addEventListener(M.default.MOUSE_UP,l);var a={visible:!0,active:!0,handles:[]},n=k.getConfiguration();n.mouseLocation.handles.start.x=e.currentPoints.image.x,n.mouseLocation.handles.start.y=e.currentPoints.image.y,(0,L.addToolState)(e.element,U,a);var o=(0,L.getToolState)(e.element,U);n.currentTool=o.data.length-1}function s(e,t){var a=e.element,n=(0,L.getToolState)(e.element,U);if(n){var o=k.getConfiguration(),r=n.data[o.currentTool];r.active=!1,r.highlight=!1,void 0!==t&&r.handles[o.currentHandle-1].lines.push({x:r.handles[t].x,y:r.handles[t].y}),o.modifying&&(o.modifying=!1),o.currentHandle=0,o.currentTool=-1,a.removeEventListener(M.default.MOUSE_MOVE,d),x.default.cornerstone.updateImage(e.element)}}function c(e){var t=e.detail,a=t.element,n=(0,D.getToolOptions)(U,a);if((0,w.default)(t.which,n.mouseButtonMask)){var c=(0,L.getToolState)(t.element,U),f=void 0,v=void 0,m=k.getConfiguration(),g=m.currentTool;if(m.modifying)return void s(t);if(g<0){var h=i(t);h?(f=h.handleNearby,v=h.toolIndex,void 0!==f&&(a.addEventListener(M.default.MOUSE_MOVE,d),a.addEventListener(M.default.MOUSE_UP,l),m.modifying=!0,m.currentHandle=f,m.currentTool=v)):(u(t),o(t))}else g>=0&&c.data[g].active&&(f=r(t,g),void 0!==f?s(t,f):t.event.shiftKey?m.freehand=!0:o(t));e.preventDefault(),e.stopPropagation()}}function f(e){var t=e.detail,a=(0,L.getToolState)(e.currentTarget,U);if(void 0!==a){var n=x.default.cornerstone,o=k.getConfiguration(),r=t.canvasContext.canvas.getContext("2d");r.setTransform(1,0,0,1,0,0);for(var i=void 0,l=P.default.getToolWidth(),d=b.default.getFillColor(),u=0;u<a.data.length;u++){r.save();var s=a.data[u];s.active?(i=b.default.getActiveColor(),d=b.default.getFillColor()):(i=b.default.getToolColor(),d=b.default.getToolColor());var c=void 0;if(s.handles.length)for(var f=0;f<s.handles.length;f++){c=s.handles[f];var v=n.pixelToCanvas(t.element,c);r.beginPath(),r.strokeStyle=i,r.lineWidth=l,r.moveTo(v.x,v.y);for(var m=0;m<s.handles[f].lines.length;m++){var g=n.pixelToCanvas(t.element,s.handles[f].lines[m]);r.lineTo(g.x,g.y),r.stroke()}var h=n.pixelToCanvas(t.element,o.mouseLocation.handles.start);f===s.handles.length-1&&(!s.active||o.freehand||o.modifying||(r.lineTo(h.x,h.y),r.stroke()))}var p={fill:d};s.active&&(0,C.default)(r,t,o.mouseLocation.handles,i,p),(0,C.default)(r,t,s.handles,i,p),r.restore()}}}function v(e){e.removeEventListener(M.default.MOUSE_DOWN,c),e.removeEventListener(M.default.MOUSE_UP,l),e.removeEventListener(M.default.MOUSE_MOVE,d),e.removeEventListener(M.default.IMAGE_RENDERED,f),e.addEventListener(M.default.IMAGE_RENDERED,f),x.default.cornerstone.updateImage(e)}function m(e){e.removeEventListener(M.default.MOUSE_DOWN,c),e.removeEventListener(M.default.MOUSE_UP,l),e.removeEventListener(M.default.MOUSE_MOVE,d),e.removeEventListener(M.default.IMAGE_RENDERED,f),x.default.cornerstone.updateImage(e)}function g(e,t){(0,D.setToolOptions)(U,e,{mouseButtonMask:t}),e.removeEventListener(M.default.MOUSE_DOWN,c),e.removeEventListener(M.default.MOUSE_UP,l),e.removeEventListener(M.default.MOUSE_MOVE,d),e.removeEventListener(M.default.IMAGE_RENDERED,f),e.addEventListener(M.default.IMAGE_RENDERED,f),e.addEventListener(M.default.MOUSE_DOWN,c),x.default.cornerstone.updateImage(e)}function h(e){e.removeEventListener(M.default.MOUSE_DOWN,c),e.removeEventListener(M.default.MOUSE_UP,l),e.removeEventListener(M.default.MOUSE_MOVE,d),e.removeEventListener(M.default.IMAGE_RENDERED,f),e.addEventListener(M.default.IMAGE_RENDERED,f),x.default.cornerstone.updateImage(e)}function p(){return A}function E(e){A=e}Object.defineProperty(t,"__esModule",{value:!0}),t.freehand=void 0;var T=a(1),M=n(T),y=a(0),x=n(y),O=a(8),P=n(O),_=a(6),b=n(_),S=a(11),C=n(S),I=a(4),w=n(I),L=a(2),D=a(3),U="freehand",A={mouseLocation:{handles:{start:{highlight:!0,active:!0}}},freehand:!1,modifying:!1,currentHandle:0,currentTool:-1},k={enable:v,disable:m,activate:g,deactivate:h,getConfiguration:p,setConfiguration:E};t.freehand=k},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e){var t=(0,M.getToolState)(e.event.currentTarget,y);if(!(t&&t.data&&t.data.length>0)){return{visible:!0,active:!0,handles:{start:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!1},end:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!0}}}}}function r(e,t,a){var n=u.default.cornerstone,o=n.pixelToCanvas(e,t.handles.start),r=n.pixelToCanvas(e,t.handles.end),i={left:Math.min(o.x,r.x),top:Math.min(o.y,r.y),width:Math.abs(o.x-r.x),height:Math.abs(o.y-r.y)},l=!1;return a.x>=i.left&&a.x<=i.left+i.width&&a.y>=i.top&&a.y<=i.top+i.height&&(l=!0),l}function i(e,t,a){var n=u.default.cornerstone,o=n.pixelToCanvas(e,t.handles.start),r=n.pixelToCanvas(e,t.handles.end),i={left:Math.min(o.x,r.x),top:Math.min(o.y,r.y),width:Math.abs(o.x-r.x),height:Math.abs(o.y-r.y)};return u.default.cornerstoneMath.rect.distanceToPoint(i,a)<5}function l(e){var t=e.detail,a=(0,M.getToolState)(e.currentTarget,y);if(void 0!==a){var n=u.default.cornerstone,o=t.canvasContext.canvas.getContext("2d");o.setTransform(1,0,0,1,0,0);var r=void 0,i=g.default.getToolWidth();o.save();var l=a.data[0];if(l){r=l.active?p.default.getActiveColor():p.default.getToolColor();var d=n.pixelToCanvas(t.element,l.handles.start),s=n.pixelToCanvas(t.element,l.handles.end),c={left:Math.min(d.x,s.x),top:Math.min(d.y,s.y),width:Math.abs(d.x-s.x),height:Math.abs(d.y-s.y)};o.beginPath(),o.strokeStyle="transparent",o.rect(0,0,o.canvas.clientWidth,o.canvas.clientHeight),o.rect(c.width+c.left,c.top,-c.width,c.height),o.stroke(),o.fillStyle="rgba(0,0,0,0.7)",o.fill(),o.closePath(),o.beginPath(),o.strokeStyle=r,o.lineWidth=i,o.setLineDash([4]),o.strokeRect(c.left,c.top,c.width,c.height),o.setLineDash([]),(0,T.default)(o,t,l.handles,r),o.restore()}}}Object.defineProperty(t,"__esModule",{value:!0}),t.highlightTouch=t.highlight=void 0;var d=a(0),u=n(d),s=a(56),c=n(s),f=a(13),v=n(f),m=a(8),g=n(m),h=a(6),p=n(h),E=a(11),T=n(E),M=a(2),y="highlight",x=(0,c.default)({createNewMeasurement:o,onImageRendered:l,pointNearTool:i,pointInsideRect:r,toolType:y},!0),O=(0,v.default)({createNewMeasurement:o,onImageRendered:l,pointNearTool:i,pointInsideRect:r,toolType:y},!0);t.highlight=x,t.highlightTouch=O},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e){var t=e.detail,a=t.image,n=a.stats,o=t.canvasContext.canvas.getContext("2d");o.setTransform(1,0,0,1,0,0);var r=[];Object.keys(n).forEach(function(e){var t=e+" : "+n[e];r.push(t)}),(0,d.default)(o,r,0,0,"orange"),r.forEach(function(e){console.log(e)})}Object.defineProperty(t,"__esModule",{value:!0});var r=a(26),i=n(r),l=a(7),d=n(l),u=(0,i.default)(o);t.default=u},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e){return{visible:!0,active:!0,handles:{start:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!1},end:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!0},textBox:{active:!1,hasMoved:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0}}}}function r(e,t,a){var n=u.default.cornerstone,o={start:n.pixelToCanvas(e,t.handles.start),end:n.pixelToCanvas(e,t.handles.end)};return u.default.cornerstoneMath.lineSegment.distanceToPoint(o,a)<25}function i(e){var t=e.detail,a=(0,x.getToolState)(e.currentTarget,C);if(a){var n=u.default.cornerstone,o=t.canvasContext.canvas.getContext("2d"),r=t.image,i=t.element;o.setTransform(1,0,0,1,0,0);var l=p.default.getToolWidth(),d=I.getConfiguration(),s=n.metaData.get("imagePlaneModule",r.imageId),c=void 0,f=void 0;s?(c=s.rowPixelSpacing||s.rowImagePixelSpacing,f=s.columnPixelSpacing||s.colImagePixelSpacing):(c=r.rowPixelSpacing,f=r.columnPixelSpacing);for(var v=0;v<a.data.length;v++){o.save(),d&&d.shadow&&(o.shadowColor=d.shadowColor||"#000000",o.shadowOffsetX=d.shadowOffsetX||1,o.shadowOffsetY=d.shadowOffsetY||1);var m=a.data[v],h=T.default.getColorIfActive(m.active),E=n.pixelToCanvas(i,m.handles.start),M=n.pixelToCanvas(i,m.handles.end);o.beginPath(),o.strokeStyle=h,o.lineWidth=l,o.moveTo(E.x,E.y),o.lineTo(M.x,M.y),o.stroke();var O={drawHandlesIfActive:d&&d.drawHandlesOnHover};(0,y.default)(o,t,m.handles,h,O),o.fillStyle=h;var P=(m.handles.end.x-m.handles.start.x)*(c||1),_=(m.handles.end.y-m.handles.start.y)*(f||1),b=Math.sqrt(P*P+_*_);m.length=b;var S=" mm";c&&f||(S=" pixels");var w=""+b.toFixed(2)+S;if(!m.handles.textBox.hasMoved){var L={x:Math.max(m.handles.start.x,m.handles.end.x)};L.x===m.handles.start.x?L.y=m.handles.start.y:L.y=m.handles.end.y,m.handles.textBox.x=L.x,m.handles.textBox.y=L.y}var D=n.pixelToCanvas(t.element,m.handles.textBox);D.x+=10;var U={centering:{x:!1,y:!0}},A=(0,g.default)(o,w,D.x,D.y,h,U);if(m.handles.textBox.boundingBox=A,m.handles.textBox.hasMoved){var k={start:{},end:{}},R={x:(E.x+M.x)/2,y:(E.y+M.y)/2},j=[E,M,R];k.end.x=D.x,k.end.y=D.y,k.start=u.default.cornerstoneMath.point.findClosestPoint(j,k.end);var N=[{x:A.left+A.width/2,y:A.top},{x:A.left,y:A.top+A.height/2},{x:A.left+A.width/2,y:A.top+A.height},{x:A.left+A.width,y:A.top+A.height/2}];k.end=u.default.cornerstoneMath.point.findClosestPoint(N,k.start),o.beginPath(),o.strokeStyle=h,o.lineWidth=l,o.setLineDash([2,3]),o.moveTo(k.start.x,k.start.y),o.lineTo(k.end.x,k.end.y),o.stroke()}o.restore()}}}function l(e){var t=e.detail,a=t.element,n=u.default.cornerstone,o=(0,S.getToolOptions)(C,a),i=void 0;if((0,P.default)(t.which,o.mouseButtonMask)){var l=t.currentPoints.canvas,d=(0,x.getToolState)(a,C);if(d)for(var s=0;s<d.data.length;s++)if(i=d.data[s],r(a,i,l)||(0,b.default)(i.handles.textBox,l))return(0,x.removeToolState)(a,C,i),n.updateImage(a),e.stopImmediatePropagation(),!1}}Object.defineProperty(t,"__esModule",{value:!0}),t.lengthTouch=t.length=void 0;var d=a(0),u=n(d),s=a(10),c=n(s),f=a(13),v=n(f),m=a(7),g=n(m),h=a(8),p=n(h),E=a(6),T=n(E),M=a(11),y=n(M),x=a(2),O=a(4),P=n(O),_=a(12),b=n(_),S=a(3),C="length",I=(0,c.default)({mouseDoubleClickCallback:l,createNewMeasurement:o,onImageRendered:i,pointNearTool:r,toolType:C}),w=(0,v.default)({createNewMeasurement:o,onImageRendered:i,pointNearTool:r,toolType:C});t.length=I,t.lengthTouch=w},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e){var t=e.detail,a=t.element;a.removeEventListener(T.default.MOUSE_DRAG,u),a.removeEventListener(T.default.MOUSE_UP,o),a.removeEventListener(T.default.MOUSE_CLICK,o),a.removeEventListener(T.default.NEW_IMAGE,l),r(t)}function r(e){e.element.querySelector(".magnifyTool").style.display="none",document.body.style.cursor="default"}function i(e){var t=e.detail,a=t.element,n=(0,S.getToolOptions)(C,a);(0,b.default)(t.which,n.mouseButtonMask)&&(a.addEventListener(T.default.MOUSE_DRAG,u),a.addEventListener(T.default.MOUSE_UP,o),a.addEventListener(T.default.MOUSE_CLICK,o),L=t.currentPoints,a.addEventListener(T.default.NEW_IMAGE,l),s(t),e.preventDefault(),e.stopPropagation())}function l(e){var t=e.detail;t.currentPoints=L,s(t)}function d(e){var t=e.detail,a=t.element;a.removeEventListener(T.default.TOUCH_DRAG_END,d),a.removeEventListener(T.default.TOUCH_END,d),a.removeEventListener(T.default.NEW_IMAGE,l),r(t)}function u(e){var t=e.detail,a=t.element;L=t.currentPoints,s(t),!0===t.isTouchEvent&&(a.addEventListener(T.default.TOUCH_DRAG_END,d),a.addEventListener(T.default.TOUCH_END,d)),e.preventDefault(),e.stopPropagation()}function s(e){var t=e.element,a=t.querySelector(".magnifyTool");a||c(e.element);var n=D.getConfiguration(),o=n.magnifySize,r=n.magnificationLevel,i=t.querySelector("canvas:not(.magnifyTool)");i.getContext("2d").setTransform(1,0,0,1,0,0);var l=a.getContext("2d");l.setTransform(1,0,0,1,0,0);var d=o/r,u=y.default.cornerstone.pixelToCanvas(e.element,e.currentPoints.image);!0===e.isTouchEvent&&(u.y-=1.25*d),u.x=Math.max(u.x,0),u.x=Math.min(u.x,i.width),u.y=Math.max(u.y,0),u.y=Math.min(u.y,i.height),l.clearRect(0,0,o,o),l.fillStyle="transparent",l.fillRect(0,0,o,o);var s={x:u.x-.5*d,y:u.y-.5*d};"Safari"===w&&(s.x=Math.max(s.x,0),s.y=Math.max(s.y,0)),s.x=Math.min(s.x,i.width),s.y=Math.min(s.y,i.height);var f={x:(i.width-s.x)*r,y:(i.height-s.y)*r};l.drawImage(i,s.x,s.y,i.width-s.x,i.height-s.y,0,0,f.x,f.y),a.style.top=u.y-.5*o+"px",a.style.left=u.x-.5*o+"px",a.style.display="block",document.body.style.cursor="none"}function c(e){if(null===e.querySelector(".magnifyTool")){var t=document.createElement("canvas");t.classList.add("magnifyTool");var a=D.getConfiguration();t.width=a.magnifySize,t.height=a.magnifySize,t.style.position="absolute",e.appendChild(t)}}function f(e){var t=e.querySelector(".magnifyTool");t&&e.removeChild(t)}function v(e){e.removeEventListener(T.default.MOUSE_DOWN,i),f(e)}function m(e){if(!w){var t=(0,P.getBrowserInfo)(),a=t.split(" ");w=a[0]}c(e)}function g(e,t){(0,S.setToolOptions)(C,e,{mouseButtonMask:t}),e.removeEventListener(T.default.MOUSE_DOWN,i),e.addEventListener(T.default.MOUSE_DOWN,i),c(e)}function h(){return I}function p(e){I=e}Object.defineProperty(t,"__esModule",{value:!0}),t.magnifyTouchDrag=t.magnify=void 0;var E=a(1),T=n(E),M=a(0),y=n(M),x=a(16),O=n(x),P=a(22),_=a(4),b=n(_),S=a(3),C="magnify",I={magnifySize:100,magnificationLevel:2},w=void 0,L=void 0,D={enable:m,activate:g,deactivate:v,disable:v,getConfiguration:h,setConfiguration:p},U={fireOnTouchStart:!0,activateCallback:c,disableCallback:f},A=(0,O.default)(u,C,U);t.magnify=D,t.magnifyTouchDrag=A},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e){var t=d.default.cornerstone,a=t.getEnabledElement(e),n=t.metaData.get("imagePlaneModule",a.image.imageId);if(n&&n.rowCosines&&n.columnCosines){var o=s.default.getOrientationString(n.rowCosines),r=s.default.getOrientationString(n.columnCosines),i=s.default.invertOrientationString(o);return{top:s.default.invertOrientationString(r),bottom:r,left:i,right:o}}}function r(e){var t=d.default.cornerstone,a=t.getEnabledElement(e),n=void 0;n={x:a.image.width/2,y:5};var o=t.pixelToCanvas(e,n);n={x:a.image.width/2,y:a.image.height-5};var r=t.pixelToCanvas(e,n);n={x:5,y:a.image.height/2};var i=t.pixelToCanvas(e,n);return n={x:a.image.width-10,y:a.image.height/2},{top:o,bottom:r,left:i,right:t.pixelToCanvas(e,n)}}function i(e){var t=e.detail,a=t.element,n=o(a);if(n){var i=r(a,n),l=t.canvasContext.canvas.getContext("2d");l.setTransform(1,0,0,1,0,0);var d=m.default.getToolColor(),u={top:l.measureText(n.top).width,left:l.measureText(n.left).width,right:l.measureText(n.right).width,bottom:l.measureText(n.bottom).width};(0,h.default)(l,n.top,i.top.x-u.top/2,i.top.y,d),(0,h.default)(l,n.left,i.left.x-u.left/2,i.left.y,d);var s=p.getConfiguration();s&&s.drawAllMarkers&&((0,h.default)(l,n.right,i.right.x-u.right/2,i.right.y,d),(0,h.default)(l,n.bottom,i.bottom.x-u.bottom/2,i.bottom.y,d))}}Object.defineProperty(t,"__esModule",{value:!0});var l=a(0),d=n(l),u=a(44),s=n(u),c=a(26),f=n(c),v=a(6),m=n(v),g=a(7),h=n(g),p=(0,f.default)(i);t.default=p},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e){var t=e.detail,a=t.element;a.removeEventListener(d.default.MOUSE_DRAG,i),a.removeEventListener(d.default.MOUSE_UP,o),a.removeEventListener(d.default.MOUSE_CLICK,o)}function r(e){var t=e.detail,a=t.element,n=(0,p.getToolOptions)(E,a);(0,h.default)(t.which,n.mouseButtonMask)&&(a.addEventListener(d.default.MOUSE_DRAG,i),a.addEventListener(d.default.MOUSE_UP,o),a.addEventListener(d.default.MOUSE_CLICK,o),e.preventDefault(),e.stopPropagation())}function i(e){var t=e.detail,a=t.viewport.scale,n=t.viewport.scale;t.image.rowPixelSpacing<t.image.columnPixelSpacing?a*=t.image.columnPixelSpacing/t.image.rowPixelSpacing:t.image.columnPixelSpacing<t.image.rowPixelSpacing&&(n*=t.image.rowPixelSpacing/t.image.columnPixelSpacing),t.viewport.translation.x+=t.deltaPoints.page.x/a,t.viewport.translation.y+=t.deltaPoints.page.y/n,s.default.cornerstone.setViewport(t.element,t.viewport),e.preventDefault(),e.stopPropagation()}Object.defineProperty(t,"__esModule",{value:!0}),t.panTouchDrag=t.pan=void 0;var l=a(1),d=n(l),u=a(0),s=n(u),c=a(18),f=n(c),v=a(16),m=n(v),g=a(4),h=n(g),p=a(3),E="pan",T=(0,f.default)(r,E),M=(0,m.default)(i,E);t.pan=T,t.panTouchDrag=M},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e){var t=e.detail,a=s.getConfiguration();a&&a.testPointers(t)&&(t.viewport.translation.x+=t.deltaPoints.page.x/t.viewport.scale,t.viewport.translation.y+=t.deltaPoints.page.y/t.viewport.scale,i.default.cornerstone.setViewport(t.element,t.viewport),e.preventDefault(),e.stopPropagation())}Object.defineProperty(t,"__esModule",{value:!0});var r=a(0),i=n(r),l=a(41),d=n(l),u={testPointers:function(e){return e.numPointers>=2}},s=(0,d.default)(o);s.setConfiguration(u),t.default=s},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e){return{visible:!0,active:!0,handles:{end:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!0}}}}function r(e,t,a){var n=u.default.cornerstone.pixelToCanvas(e,t.handles.end);return u.default.cornerstoneMath.point.distance(n,a)<5}function i(e){var t=e.detail,a=(0,b.getToolState)(e.currentTarget,D);if(a){var n=u.default.cornerstone,o=t.canvasContext.canvas.getContext("2d");o.setTransform(1,0,0,1,0,0);for(var r=void 0,i=p.default.getFont(),l=p.default.getFontSize(),d=0;d<a.data.length;d++){o.save();var s=a.data[d];r=s.active?g.default.getActiveColor():g.default.getToolColor(),(0,T.default)(o,t,s.handles,r);var c=Math.round(s.handles.end.x),f=Math.round(s.handles.end.y),v=void 0,m=void 0,h=void 0;if(c<0||f<0||c>=t.image.columns||f>=t.image.rows)return;if(t.image.color)m=c+", "+f,v=(0,O.default)(t.element,c,f,1,1),h="R: "+v[0]+" G: "+v[1]+" B: "+v[2];else{v=n.getStoredPixels(t.element,c,f,1,1);var E=v[0],M=E*t.image.slope+t.image.intercept,x=(0,_.default)(t.image,E);m=c+", "+f,h="SP: "+E+" MO: "+parseFloat(M.toFixed(3)),x&&(h+=" SUV: "+parseFloat(x.toFixed(3)))}var P={x:s.handles.end.x+3,y:s.handles.end.y-3},S=n.pixelToCanvas(t.element,P);o.font=i,o.fillStyle=r,(0,y.default)(o,h,S.x,S.y+l+5,r),(0,y.default)(o,m,S.x,S.y,r),o.restore()}}}function l(e){var t=e.detail,a=t.element,n=u.default.cornerstone,o=(0,L.getToolOptions)(D,a),i=void 0;if((0,C.default)(t.which,o.mouseButtonMask)){var l=t.currentPoints.canvas,d=(0,b.getToolState)(a,D);if(d)for(var s=0;s<d.data.length;s++)if(i=d.data[s],r(a,i,l)||(0,w.default)(i.handles.textBox,l))return(0,b.removeToolState)(a,D,i),n.updateImage(a),e.stopImmediatePropagation(),!1}}Object.defineProperty(t,"__esModule",{value:!0}),t.probeTouch=t.probe=void 0;var d=a(0),u=n(d),s=a(10),c=n(s),f=a(13),v=n(f),m=a(6),g=n(m),h=a(14),p=n(h),E=a(11),T=n(E),M=a(7),y=n(M),x=a(35),O=n(x),P=a(20),_=n(P),b=a(2),S=a(4),C=n(S),I=a(12),w=n(I),L=a(3),D="probe",U=(0,c.default)({mouseDoubleClickCallback:l,createNewMeasurement:o,onImageRendered:i,pointNearTool:r,toolType:D}),A=(0,v.default)({createNewMeasurement:o,onImageRendered:i,pointNearTool:r,toolType:D});t.probe=U,t.probeTouch=A},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e){return{visible:!0,active:!0,invalidated:!0,handles:{start:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!1},end:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!0},textBox:{active:!1,hasMoved:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0}}}}function r(e,t,a){var n=c.default.cornerstone,o=n.pixelToCanvas(e,t.handles.start),r=n.pixelToCanvas(e,t.handles.end),i={left:Math.min(o.x,r.x),top:Math.min(o.y,r.y),width:Math.abs(o.x-r.x),height:Math.abs(o.y-r.y)};return c.default.cornerstoneMath.rect.distanceToPoint(i,a)<5}function i(e,t){for(var a=0,n=0,o=0,r=0,i=t.top;i<t.top+t.height;i++)for(var l=t.left;l<t.left+t.width;l++)a+=e[r],n+=e[r]*e[r],o++,r++;if(0===o)return{count:o,mean:0,variance:0,stdDev:0};var d=a/o,u=n/o-d*d;return{count:o,mean:d,variance:u,stdDev:Math.sqrt(u)}}function l(e){var t=e.toString().split(".");return t[0]=t[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),t.join(".")}function d(e){var t=e.detail,a=(0,b.getToolState)(e.currentTarget,D);if(a){var n=c.default.cornerstone,o=t.image,r=t.element,d=p.default.getToolWidth(),u=U.getConfiguration(),s=t.canvasContext.canvas.getContext("2d"),f=n.metaData.get("generalSeriesModule",o.imageId),v=void 0;f&&(v=f.modality),s.setTransform(1,0,0,1,0,0);for(var m=0;m<a.data.length;m++){s.save();var g=a.data[m];u&&u.shadow&&(s.shadowColor=u.shadowColor||"#000000",s.shadowOffsetX=u.shadowOffsetX||1,s.shadowOffsetY=u.shadowOffsetY||1);var h=T.default.getColorIfActive(g.active),E=n.pixelToCanvas(r,g.handles.start),M=n.pixelToCanvas(r,g.handles.end),x=Math.min(E.x,M.x),P=Math.min(E.y,M.y),S=Math.abs(E.x-M.x),C=Math.abs(E.y-M.y);if(s.beginPath(),s.strokeStyle=h,s.lineWidth=d,s.rect(x,P,S,C),s.stroke(),u&&u.drawHandlesOnHover)if(!0===g.active)(0,y.default)(s,t,g.handles,h);else{var I={drawHandlesIfActive:!0};(0,y.default)(s,t,g.handles,h,I)}else(0,y.default)(s,t,g.handles,h);var w=void 0,L=void 0,A=void 0;if(!1===g.invalidated)L=g.meanStdDev,A=g.meanStdDevSUV,w=g.area;else{var k={left:Math.min(g.handles.start.x,g.handles.end.x),top:Math.min(g.handles.start.y,g.handles.end.y),width:Math.abs(g.handles.start.x-g.handles.end.x),height:Math.abs(g.handles.start.y-g.handles.end.y)};if(!o.color){L=i(n.getPixels(r,k.left,k.top,k.width,k.height),k),"PT"===v&&(A={mean:(0,_.default)(o,(L.mean-o.intercept)/o.slope),stdDev:(0,_.default)(o,(L.stdDev-o.intercept)/o.slope)}),L&&!isNaN(L.mean)&&(g.meanStdDev=L,g.meanStdDevSUV=A)}w=k.width*(o.columnPixelSpacing||1)*(k.height*(o.rowPixelSpacing||1)),isNaN(w)||(g.area=w),g.invalidated=!1}var R=[];if(L&&L.mean){var j="";"CT"===v&&(j=" HU");var N="平均值: "+l(L.mean.toFixed(2))+j,H="标准差: "+l(L.stdDev.toFixed(2))+j;if(A&&void 0!==A.mean){N+=" SUV: "+l(A.mean.toFixed(2)),H+=" SUV: "+l(A.stdDev.toFixed(2))}R.push(N),R.push(H)}if(w){var V=" mm"+String.fromCharCode(178);o.rowPixelSpacing&&o.columnPixelSpacing||(V=" pixels"+String.fromCharCode(178));var B="面积: "+l(w.toFixed(2))+V;R.push(B)}g.handles.textBox.hasMoved||(g.handles.textBox.x=Math.max(g.handles.start.x,g.handles.end.x),g.handles.textBox.y=(g.handles.start.y+g.handles.end.y)/2);var W=n.pixelToCanvas(r,g.handles.textBox),G={centering:{x:!1,y:!0}},z=(0,O.default)(s,R,W.x,W.y,h,G);if(g.handles.textBox.boundingBox=z,g.handles.textBox.hasMoved){var F={start:{},end:{x:W.x,y:W.y}},Y=[{x:x+S/2,y:P},{x:x,y:P+C/2},{x:x+S/2,y:P+C},{x:x+S,y:P+C/2}];F.start=c.default.cornerstoneMath.point.findClosestPoint(Y,F.end);var K=[{x:z.left+z.width/2,y:z.top},{x:z.left,y:z.top+z.height/2},{x:z.left+z.width/2,y:z.top+z.height},{x:z.left+z.width,y:z.top+z.height/2}];F.end=c.default.cornerstoneMath.point.findClosestPoint(K,F.start),s.beginPath(),s.strokeStyle=h,s.lineWidth=d,s.setLineDash([2,3]),s.moveTo(F.start.x,F.start.y),s.lineTo(F.end.x,F.end.y),s.stroke()}s.restore()}}}function u(e){var t=e.detail,a=t.element,n=c.default.cornerstone,o=(0,L.getToolOptions)(D,a),i=void 0;if((0,C.default)(t.which,o.mouseButtonMask)){var l=t.currentPoints.canvas,d=(0,b.getToolState)(a,D);if(d)for(var u=0;u<d.data.length;u++)if(i=d.data[u],r(a,i,l)||(0,w.default)(i.handles.textBox,l))return(0,b.removeToolState)(a,D,i),n.updateImage(a),e.stopImmediatePropagation(),!1}}Object.defineProperty(t,"__esModule",{value:!0}),t.rectangleRoiTouch=t.rectangleRoi=void 0;var s=a(0),c=n(s),f=a(10),v=n(f),m=a(13),g=n(m),h=a(8),p=n(h),E=a(6),T=n(E),M=a(11),y=n(M),x=a(7),O=n(x),P=a(20),_=n(P),b=a(2),S=a(4),C=n(S),I=a(12),w=n(I),L=a(3),D="rectangleRoi",U=(0,v.default)({mouseDoubleClickCallback:u,createNewMeasurement:o,onImageRendered:d,pointNearTool:r,toolType:D}),A=(0,g.default)({createNewMeasurement:o,onImageRendered:d,pointNearTool:r,toolType:D});t.rectangleRoi=U,t.rectangleRoiTouch=A},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e){var t=e.element.getBoundingClientRect(e.element),a={x:e.currentPoints.client.x,y:e.currentPoints.client.y},n=e.element.clientWidth,o=e.element.clientHeight,r={x:a.x-t.left-n/2,y:-1*(a.y-t.top-o/2)},i=Math.atan2(r.y,r.x),l=i*(180/Math.PI),d=-1*l+90;e.viewport.rotation=d,v.default.cornerstone.setViewport(e.element,e.viewport)}function r(e){e.viewport.rotation+=e.deltaPoints.page.x/e.viewport.scale,v.default.cornerstone.setViewport(e.element,e.viewport)}function i(e){e.viewport.rotation+=e.deltaPoints.page.y/e.viewport.scale,v.default.cornerstone.setViewport(e.element,e.viewport)}function l(e){var t=e.detail,a=t.element;a.removeEventListener(c.default.MOUSE_DRAG,u),a.removeEventListener(c.default.MOUSE_UP,l),a.removeEventListener(c.default.MOUSE_CLICK,l)}function d(e){var t=e.detail,a=t.element,n=(0,M.getToolOptions)(y,a);(0,T.default)(t.which,n.mouseButtonMask)&&(a.addEventListener(c.default.MOUSE_DRAG,u),a.addEventListener(c.default.MOUSE_UP,l),a.addEventListener(c.default.MOUSE_CLICK,l),e.preventDefault(),e.stopPropagation())}function u(e){var t=e.detail;x.strategy(t),v.default.cornerstone.setViewport(t.element,t.viewport),e.preventDefault(),e.stopPropagation()}Object.defineProperty(t,"__esModule",{value:!0}),t.rotateTouchDrag=t.rotate=void 0;var s=a(1),c=n(s),f=a(0),v=n(f),m=a(18),g=n(m),h=a(16),p=n(h),E=a(4),T=n(E),M=a(3),y="rotate",x=(0,g.default)(d,y);x.strategies={default:o,horizontal:r,vertical:i},x.strategy=o;var O=(0,p.default)(u,y);t.rotate=x,t.rotateTouchDrag=O},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e){var t=e.detail;return t.viewport.rotation+=t.rotation,s.default.cornerstone.setViewport(t.element,t.viewport),!1}function r(e){e.removeEventListener(d.default.TOUCH_ROTATE,o)}function i(e){e.removeEventListener(d.default.TOUCH_ROTATE,o),e.addEventListener(d.default.TOUCH_ROTATE,o)}Object.defineProperty(t,"__esModule",{value:!0});var l=a(1),d=n(l),u=a(0),s=n(u),c={activate:i,disable:r};t.default=c},function(e,t,a){"use strict";function n(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"image/png",n=e.querySelector("canvas"),o=document.createElement("a");if(o.download=t,o.href=n.toDataURL(a,1),document.createEvent){var r=document.createEvent("MouseEvents");r.initMouseEvent("click",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),o.dispatchEvent(r)}else o.fireEvent&&o.fireEvent("onclick")}Object.defineProperty(t,"__esModule",{value:!0}),t.default=n},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e){e(prompt("Enter your annotation:"))}function r(e,t,a){a(prompt("Change your annotation:"))}function i(e){function t(e){null===e?(0,B.removeToolState)(n,G,r):r.text=e,r.active=!1,a.updateImage(n)}var a=h.default.cornerstone,n=e.element,o=F.getConfiguration(),r=l(e);(0,B.addToolState)(n,G,r),a.updateImage(n),(0,D.default)(e,G,r,r.handles.end,function(){(0,w.default)(e,r.handles)&&(0,B.removeToolState)(n,G,r),void 0===r.text&&o.getTextCallback(t),a.updateImage(n)})}function l(e){return{visible:!0,active:!0,handles:{end:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!1},textBox:{active:!1,hasMoved:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0}}}}function d(e,t,a){if(t.handles.end){var n=h.default.cornerstone.pixelToCanvas(e,t.handles.end);return h.default.cornerstoneMath.point.distance(n,a)<25}}function u(e){var t=e.detail,a=(0,B.getToolState)(e.currentTarget,G);if(a){var n=h.default.cornerstone,o=t.enabledElement,r=t.canvasContext.canvas.getContext("2d");r.setTransform(1,0,0,1,0,0);for(var i=t.canvasContext.canvas.width,l=void 0,d=b.default.getToolWidth(),u=P.default.getFont(),s=F.getConfiguration(),c=0;c<a.data.length;c++){r.save(),s&&s.shadow&&(r.shadowColor=s.shadowColor||"#000000",r.shadowOffsetX=s.shadowOffsetX||1,r.shadowOffsetY=s.shadowOffsetY||1);var f=a.data[c];l=f.active?C.default.getActiveColor():C.default.getToolColor();var v=n.pixelToCanvas(t.element,f.handles.end);(0,R.default)(r,v,l,d);var m={drawHandlesIfActive:s&&s.drawHandlesOnHover};if(s.drawHandles&&(0,A.default)(r,t,v,l,m),f.text&&""!==f.text){r.font=u;var g="";g=s.showCoordinates?f.text+" x: "+Math.round(f.handles.end.x)+" y: "+Math.round(f.handles.end.y):f.text;var p=r.measureText(g).width+10,E=P.default.getFontSize()+10,T=Math.max(p,E)/2+5;v.x>i/2&&(T=-T);var M=void 0;if(!f.handles.textBox.hasMoved){M={x:v.x-p/2+T,y:v.y-E/2};var y=n.internal.getTransform(o);y.invert();var O=y.transformPoint(M.x,M.y);f.handles.textBox.x=O.x,f.handles.textBox.y=O.y}M=n.pixelToCanvas(t.element,f.handles.textBox);var _=(0,x.default)(r,g,M.x,M.y,l);if(f.handles.textBox.boundingBox=_,f.handles.textBox.hasMoved){var S={start:{},end:{}};S.end.x=M.x,S.end.y=M.y,S.start=v;var I=[{x:_.left+_.width/2,y:_.top},{x:_.left,y:_.top+_.height/2},{x:_.left+_.width/2,y:_.top+_.height},{x:_.left+_.width,y:_.top+_.height/2}];S.end=h.default.cornerstoneMath.point.findClosestPoint(I,S.start),r.beginPath(),r.strokeStyle=l,r.lineWidth=d,r.setLineDash([2,3]),r.moveTo(S.start.x,S.start.y),r.lineTo(S.end.x,S.end.y),r.stroke()}}r.restore()}}}function s(e){function t(e){null===e?(0,B.removeToolState)(n,G,r):r.text=e,r.active=!1,a.updateImage(n)}var a=h.default.cornerstone,n=e.element,o=F.getConfiguration(),r=l(e);(0,B.addToolState)(n,G,r),a.updateImage(n),(0,D.default)(e,G,r,r.handles.end,function(){(0,w.default)(e,r.handles)&&(0,B.removeToolState)(n,G,r),void 0===r.text&&o.getTextCallback(t),a.updateImage(n)})}function c(e){function t(e,t,a){!0===a?(0,B.removeToolState)(o,G,e):e.text=t,e.active=!1,n.updateImage(o)}var a=e.detail,n=h.default.cornerstone,o=a.element,r=void 0,i=(0,W.getToolOptions)(G,o);if((0,N.default)(a.which,i.mouseButtonMask)){var l=F.getConfiguration(),u=a.currentPoints.canvas,s=(0,B.getToolState)(o,G);if(s){for(var c=0;c<s.data.length;c++)if(r=s.data[c],d(o,r,u)||(0,V.default)(r.handles.textBox,u))return r.active=!0,n.updateImage(o),l.changeTextCallback(r,a,t),e.stopImmediatePropagation(),!1;e.preventDefault(),e.stopPropagation()}}}function f(e){function t(e,t,a){console.log("pressCallback doneChangingTextCallback"),!0===a?(0,B.removeToolState)(o,G,e):e.text=t,e.active=!1,n.updateImage(o),o.addEventListener(m.default.TOUCH_START,Y.touchStartCallback),o.addEventListener(m.default.TOUCH_START_ACTIVE,Y.touchDownActivateCallback),o.addEventListener(m.default.TAP,Y.tapCallback)}var a=e.detail,n=h.default.cornerstone,o=a.element,r=void 0,i=F.getConfiguration(),l=a.currentPoints.canvas,u=(0,B.getToolState)(o,G);if(!u)return!1;if(a.handlePressed)return o.removeEventListener(m.default.TOUCH_START,Y.touchStartCallback),o.removeEventListener(m.default.TOUCH_START_ACTIVE,Y.touchDownActivateCallback),o.removeEventListener(m.default.TAP,Y.tapCallback),i.changeTextCallback(a.handlePressed,a,t),e.stopImmediatePropagation(),!1;for(var s=0;s<u.data.length;s++)if(r=u.data[s],d(o,r,l)||(0,V.default)(r.handles.textBox,l))return r.active=!0,n.updateImage(o),o.removeEventListener(m.default.TOUCH_START,Y.touchStartCallback),o.removeEventListener(m.default.TOUCH_START_ACTIVE,Y.touchDownActivateCallback),o.removeEventListener(m.default.TAP,Y.tapCallback),i.changeTextCallback(r,a,t),e.stopImmediatePropagation(),!1;e.preventDefault(),e.stopPropagation()}Object.defineProperty(t,"__esModule",{value:!0}),t.seedAnnotateTouch=t.seedAnnotate=void 0;var v=a(1),m=n(v),g=a(0),h=n(g),p=a(10),E=n(p),T=a(13),M=n(T),y=a(7),x=n(y),O=a(14),P=n(O),_=a(8),b=n(_),S=a(6),C=n(S),I=a(15),w=n(I),L=a(23),D=n(L),U=a(11),A=n(U),k=a(48),R=n(k),j=a(4),N=n(j),H=a(12),V=n(H),B=a(2),W=a(3),G="seedAnnotate",z={getTextCallback:o,changeTextCallback:r,drawHandles:!1,drawHandlesOnHover:!0,currentLetter:"A",currentNumber:0,showCoordinates:!0,countUp:!0},F=(0,E.default)({addNewMeasurement:i,createNewMeasurement:l,onImageRendered:u,pointNearTool:d,toolType:G,mouseDoubleClickCallback:c});F.setConfiguration(z);var Y=(0,M.default)({addNewMeasurement:s,createNewMeasurement:l,onImageRendered:u,pointNearTool:d,toolType:G,pressCallback:f});t.seedAnnotate=F,t.seedAnnotateTouch=Y},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e){return{visible:!0,active:!0,handles:{start:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!1},middle:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!0},end:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!1},textBox:{active:!1,hasMoved:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0}}}}function r(e,t,a){var n=m.default.cornerstone,o={start:n.pixelToCanvas(e,t.handles.start),end:n.pixelToCanvas(e,t.handles.middle)},r=m.default.cornerstoneMath.lineSegment.distanceToPoint(o,a);return r<25||(o.start=n.pixelToCanvas(e,t.handles.middle),o.end=n.pixelToCanvas(e,t.handles.end),(r=m.default.cornerstoneMath.lineSegment.distanceToPoint(o,a))<25)}function i(e){return Math.sqrt(Math.pow(e.x,2)+Math.pow(e.y,2))}function l(e){var t=e.detail,a=(0,j.getToolState)(e.currentTarget,G);if(a){var n=m.default.cornerstone,o=t.enabledElement,r=t.canvasContext.canvas.getContext("2d");r.setTransform(1,0,0,1,0,0);for(var l=void 0,d=P.default.getToolWidth(),u=x.default.getFont(),s=z.getConfiguration(),c=0;c<a.data.length;c++){r.save(),s&&s.shadow&&(r.shadowColor=s.shadowColor||"#000000",r.shadowOffsetX=s.shadowOffsetX||1,r.shadowOffsetY=s.shadowOffsetY||1);var f=a.data[c];l=f.active?b.default.getActiveColor():b.default.getToolColor();var v=n.pixelToCanvas(t.element,f.handles.start),g=n.pixelToCanvas(t.element,f.handles.middle),h=n.pixelToCanvas(t.element,f.handles.end);r.beginPath(),r.strokeStyle=l,r.lineWidth=d,r.moveTo(v.x,v.y),r.lineTo(g.x,g.y),r.lineTo(h.x,h.y),r.stroke();var p={drawHandlesIfActive:s&&s.drawHandlesOnHover};(0,A.default)(r,t,f.handles,l,p),r.fillStyle=l;var T=t.image.columnPixelSpacing||1,y=t.image.rowPixelSpacing||1,O="";t.image.rowPixelSpacing&&t.image.columnPixelSpacing||(O=" (isotropic)");var _={x:(Math.ceil(f.handles.middle.x)-Math.ceil(f.handles.start.x))*T,y:(Math.ceil(f.handles.middle.y)-Math.ceil(f.handles.start.y))*y},S={x:(Math.ceil(f.handles.end.x)-Math.ceil(f.handles.middle.x))*T,y:(Math.ceil(f.handles.end.y)-Math.ceil(f.handles.middle.y))*y},C={x:(Math.ceil(f.handles.end.x)-Math.ceil(f.handles.start.x))*T,y:(Math.ceil(f.handles.end.y)-Math.ceil(f.handles.start.y))*y},I=i(_),w=i(S),L=i(C),D=Math.acos((Math.pow(I,2)+Math.pow(w,2)-Math.pow(L,2))/(2*I*w));D*=180/Math.PI;var U=(0,M.default)(D,2);if(U){var k=U.toString()+String.fromCharCode(parseInt("00B0",16))+O,R=void 0;if(f.handles.textBox.hasMoved)R=n.pixelToCanvas(t.element,f.handles.textBox);else{R={x:g.x,y:g.y},r.font=u;var N=r.measureText(k).width;g.x<v.x?R.x-=15+N+10:R.x+=15;var H=n.internal.getTransform(o);H.invert();var V=H.transformPoint(R.x,R.y);f.handles.textBox.x=V.x,f.handles.textBox.y=V.y}var B={centering:{x:!1,y:!0}},W=(0,E.default)(r,k,R.x,R.y,l,B);if(f.handles.textBox.boundingBox=W,f.handles.textBox.hasMoved){var F={start:{},end:{}},Y=[v,h,g];F.end.x=R.x,F.end.y=R.y,F.start=m.default.cornerstoneMath.point.findClosestPoint(Y,F.end);var K=[{x:W.left+W.width/2,y:W.top},{x:W.left,y:W.top+W.height/2},{x:W.left+W.width/2,y:W.top+W.height},{x:W.left+W.width,y:W.top+W.height/2}];F.end=m.default.cornerstoneMath.point.findClosestPoint(K,F.start),r.beginPath(),r.strokeStyle=l,r.lineWidth=d,r.setLineDash([2,3]),r.moveTo(F.start.x,F.start.y),r.lineTo(F.end.x,F.end.y),r.stroke()}}r.restore()}}}function d(e){var t=m.default.cornerstone,a=o(e),n=e.element;(0,j.addToolState)(n,G,a),n.removeEventListener(f.default.MOUSE_MOVE,z.mouseMoveCallback),n.removeEventListener(f.default.MOUSE_DRAG,z.mouseMoveCallback),n.removeEventListener(f.default.MOUSE_DOWN,z.mouseDownCallback),n.removeEventListener(f.default.MOUSE_DOWN_ACTIVATE,z.mouseDownActivateCallback),t.updateImage(n),(0,w.default)(e,G,a,a.handles.middle,function(){if(a.active=!1,(0,C.default)(e,a.handles))return(0,j.removeToolState)(n,G,a),n.addEventListener(f.default.MOUSE_MOVE,z.mouseMoveCallback),n.addEventListener(f.default.MOUSE_DRAG,z.mouseMoveCallback),n.addEventListener(f.default.MOUSE_DOWN,z.mouseDownCallback),n.addEventListener(f.default.MOUSE_DOWN_ACTIVATE,z.mouseDownActivateCallback),void t.updateImage(n);a.handles.end.active=!0,t.updateImage(n),(0,w.default)(e,G,a,a.handles.end,function(){a.active=!1,(0,C.default)(e,a.handles)&&(0,j.removeToolState)(n,G,a),n.addEventListener(f.default.MOUSE_MOVE,z.mouseMoveCallback),n.addEventListener(f.default.MOUSE_DRAG,z.mouseMoveCallback),n.addEventListener(f.default.MOUSE_DOWN,z.mouseDownCallback),n.addEventListener(f.default.MOUSE_DOWN_ACTIVATE,z.mouseDownActivateCallback),t.updateImage(n)})})}function u(e){var t=m.default.cornerstone,a=o(e),n=e.element;(0,j.addToolState)(n,G,a),n.removeEventListener(f.default.TOUCH_DRAG,F.touchMoveCallback),n.removeEventListener(f.default.TOUCH_START_ACTIVE,F.touchDownActivateCallback),n.removeEventListener(f.default.TOUCH_START,F.touchStartCallback),n.removeEventListener(f.default.TAP,F.tapCallback),t.updateImage(n),(0,D.default)(e,G,a,a.handles.middle,function(){if((0,C.default)(e,a.handles))return(0,j.removeToolState)(n,G,a),n.addEventListener(f.default.TOUCH_DRAG,F.touchMoveCallback),n.addEventListener(f.default.TOUCH_START,F.touchStartCallback),n.addEventListener(f.default.TOUCH_START_ACTIVE,F.touchDownActivateCallback),n.addEventListener(f.default.TAP,F.tapCallback),void t.updateImage(n);(0,D.default)(e,G,a,a.handles.end,function(){(0,C.default)(e,a.handles)&&((0,j.removeToolState)(n,G,a),t.updateImage(n)),n.addEventListener(f.default.TOUCH_DRAG,F.touchMoveCallback),n.addEventListener(f.default.TOUCH_START,F.touchStartCallback),n.addEventListener(f.default.TOUCH_START_ACTIVE,F.touchDownActivateCallback),n.addEventListener(f.default.TAP,F.tapCallback)})})}function s(e){var t=e.detail,a=t.element,n=m.default.cornerstone,o=(0,W.getToolOptions)(G,a),i=void 0;if((0,H.default)(t.which,o.mouseButtonMask)){var l=t.currentPoints.canvas,d=(0,j.getToolState)(a,G);if(d)for(var u=0;u<d.data.length;u++)if(i=d.data[u],r(a,i,l)||(0,B.default)(i.handles.textBox,l))return(0,j.removeToolState)(a,G,i),n.updateImage(a),e.stopImmediatePropagation(),!1}}Object.defineProperty(t,"__esModule",{value:!0}),t.simpleAngleTouch=t.simpleAngle=void 0;var c=a(1),f=n(c),v=a(0),m=n(v),g=a(10),h=n(g),p=a(7),E=n(p),T=a(32),M=n(T),y=a(14),x=n(y),O=a(8),P=n(O),_=a(6),b=n(_),S=a(15),C=n(S),I=a(24),w=n(I),L=a(27),D=n(L),U=a(11),A=n(U),k=a(13),R=n(k),j=a(2),N=a(4),H=n(N),V=a(12),B=n(V),W=a(3),G="simpleAngle",z=(0,h.default)({mouseDoubleClickCallback:s,createNewMeasurement:o,addNewMeasurement:d,onImageRendered:l,pointNearTool:r,toolType:G}),F=(0,R.default)({createNewMeasurement:o,addNewMeasurement:u,onImageRendered:l,pointNearTool:r,toolType:G});t.simpleAngle=z,t.simpleAngleTouch=F},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e){var t=C.getConfiguration();if(t.current){var a={visible:!0,active:!0,text:t.current,handles:{end:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!0,hasBoundingBox:!0}}},n={left:0,top:0,width:e.image.width,height:e.image.height};if(f.default.cornerstoneMath.point.insideRect(a.handles.end,n)){var o=t.markers.indexOf(t.current);return t.ascending?(o+=1)>=t.markers.length&&(t.loop?o-=t.markers.length:o=-1):(o-=1)<0&&(t.loop?o+=t.markers.length:o=-1),t.current=t.markers[o],a}}}function r(e,t,a){if(t.handles.end.boundingBox){var n=f.default.cornerstoneMath.rect.distanceToPoint(t.handles.end.boundingBox,a),o=(0,E.default)(t.handles.end,a);return n<10||o}}function i(e){var t=e.detail,a=(0,_.getToolState)(t.element,S);if(a){var n=t.canvasContext.canvas.getContext("2d");n.setTransform(1,0,0,1,0,0);for(var o=C.getConfiguration(),r=0;r<a.data.length;r++){var i=a.data[r],l=M.default.getToolColor();i.active&&(l=M.default.getActiveColor()),n.save(),o&&o.shadow&&(n.shadowColor=o.shadowColor||"#000000",n.shadowOffsetX=o.shadowOffsetX||1,n.shadowOffsetY=o.shadowOffsetY||1),n.fillStyle=l;var d=n.measureText(i.text);i.textWidth=d.width+10;var u=f.default.cornerstone.pixelToCanvas(t.element,i.handles.end),s={centering:{x:!0,y:!0}};i.handles.end.boundingBox=(0,P.default)(n,i.text,u.x,u.y-10,l,s),n.restore()}}}function l(e){function t(e,t,a){!0===a?(0,_.removeToolState)(o,S,e):e.text=t,e.active=!1,n.updateImage(o),o.addEventListener(s.default.MOUSE_MOVE,C.mouseMoveCallback),o.addEventListener(s.default.MOUSE_DOWN,C.mouseDownCallback),o.addEventListener(s.default.MOUSE_DOWN_ACTIVATE,C.mouseDownActivateCallback),o.addEventListener(s.default.MOUSE_DOUBLE_CLICK,C.mouseDoubleClickCallback)}var a=e.detail,n=f.default.cornerstone,o=a.element,i=void 0,l=(0,b.getToolOptions)(S,o);if((0,x.default)(a.which,l.mouseButtonMask)){var d=C.getConfiguration(),u=a.currentPoints.canvas,c=(0,_.getToolState)(o,S);if(c){for(var v=0;v<c.data.length;v++)if(i=c.data[v],r(o,i,u))return i.active=!0,n.updateImage(o),o.removeEventListener(s.default.MOUSE_MOVE,C.mouseMoveCallback),o.removeEventListener(s.default.MOUSE_DOWN,C.mouseDownCallback),o.removeEventListener(s.default.MOUSE_DOWN_ACTIVATE,C.mouseDownActivateCallback),o.removeEventListener(s.default.MOUSE_DOUBLE_CLICK,C.mouseDoubleClickCallback),d.changeTextCallback(i,a,t),e.stopImmediatePropagation(),e.preventDefault(),void e.stopPropagation();e.preventDefault(),e.stopPropagation()}}}function d(e){function t(e,t,a){!0===a?(0,_.removeToolState)(o,S,e):e.text=t,e.active=!1,n.updateImage(o),o.addEventListener(s.default.TOUCH_DRAG,I.touchMoveCallback),o.addEventListener(s.default.TOUCH_START_ACTIVE,I.touchDownActivateCallback),o.addEventListener(s.default.TOUCH_START,I.touchStartCallback),o.addEventListener(s.default.TAP,I.tapCallback),o.addEventListener(s.default.TOUCH_PRESS,I.pressCallback)}var a=e.detail,n=f.default.cornerstone,o=a.element,i=void 0,l=C.getConfiguration(),d=a.currentPoints.canvas,u=(0,_.getToolState)(o,S);if(!u)return!1;if(a.handlePressed)return a.handlePressed.active=!0,n.updateImage(o),o.removeEventListener(s.default.TOUCH_DRAG,I.touchMoveCallback),o.removeEventListener(s.default.TOUCH_START_ACTIVE,I.touchDownActivateCallback),o.removeEventListener(s.default.TOUCH_START,I.touchStartCallback),o.removeEventListener(s.default.TAP,I.tapCallback),o.removeEventListener(s.default.TOUCH_PRESS,I.pressCallback),l.changeTextCallback(a.handlePressed,a,t),e.stopImmediatePropagation(),e.preventDefault(),void e.stopPropagation();for(var c=0;c<u.data.length;c++)if(i=u.data[c],r(o,i,d))return i.active=!0,n.updateImage(o),o.removeEventListener(s.default.TOUCH_DRAG,I.touchMoveCallback),o.removeEventListener(s.default.TOUCH_START_ACTIVE,I.touchDownActivateCallback),o.removeEventListener(s.default.TOUCH_START,I.touchStartCallback),o.removeEventListener(s.default.TAP,I.tapCallback),o.removeEventListener(s.default.TOUCH_PRESS,I.pressCallback),l.changeTextCallback(i,a,t),e.stopImmediatePropagation(),e.preventDefault(),void e.stopPropagation();e.preventDefault(),e.stopPropagation()}Object.defineProperty(t,"__esModule",{value:!0}),t.textMarkerTouch=t.textMarker=void 0;var u=a(1),s=n(u),c=a(0),f=n(c),v=a(10),m=n(v),g=a(13),h=n(g),p=a(12),E=n(p),T=a(6),M=n(T),y=a(4),x=n(y),O=a(7),P=n(O),_=a(2),b=a(3),S="textMarker",C=(0,m.default)({createNewMeasurement:o,onImageRendered:i,pointNearTool:r,toolType:S,mouseDoubleClickCallback:l}),I=(0,h.default)({createNewMeasurement:o,onImageRendered:i,pointNearTool:r,toolType:S,pressCallback:d});t.textMarker=C,t.textMarkerTouch=I},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e){var t=e.detail,a=t.element;a.removeEventListener(s.default.MOUSE_DRAG,l),a.removeEventListener(s.default.MOUSE_UP,o),a.removeEventListener(s.default.MOUSE_CLICK,o)}function r(e){var t=e.detail,a=t.element,n=(0,T.getToolOptions)(M,a);(0,E.default)(t.which,n.mouseButtonMask)&&(a.addEventListener(s.default.MOUSE_DRAG,l),a.addEventListener(s.default.MOUSE_UP,o),a.addEventListener(s.default.MOUSE_CLICK,o),e.preventDefault(),e.stopPropagation())}function i(e){var t=e.image.maxPixelValue*e.image.slope+e.image.intercept,a=e.image.minPixelValue*e.image.slope+e.image.intercept,n=t-a,o=n/1024,r=e.deltaPoints.page.x*o,i=e.deltaPoints.page.y*o;e.viewport.voi.windowWidth+=r,e.viewport.voi.windowCenter+=i}function l(e){var t=e.detail;y.strategy(t),f.default.cornerstone.setViewport(t.element,t.viewport)}function d(e){var t=e.detail;e.stopImmediatePropagation();var a=t,n=a.image.maxPixelValue*a.image.slope+a.image.intercept,o=a.image.minPixelValue*a.image.slope+a.image.intercept,r=n-o,i=r/1024,l=a.deltaPoints.page.x*i,d=a.deltaPoints.page.y*i,u=y.getConfiguration();u.orientation?0===u.orientation?(a.viewport.voi.windowWidth+=l,a.viewport.voi.windowCenter+=d):(a.viewport.voi.windowWidth+=d,a.viewport.voi.windowCenter+=l):(a.viewport.voi.windowWidth+=l,a.viewport.voi.windowCenter+=d),f.default.cornerstone.setViewport(a.element,a.viewport)}Object.defineProperty(t,"__esModule",{value:!0}),t.wwwcTouchDrag=t.wwwc=void 0;var u=a(1),s=n(u),c=a(0),f=n(c),v=a(18),m=n(v),g=a(16),h=n(g),p=a(4),E=n(p),T=a(3),M="wwwc",y=(0,m.default)(r,M);y.strategies={default:i},y.strategy=i;var x=(0,h.default)(d);t.wwwc=y,t.wwwcTouchDrag=x},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t,a){var n=e.length;if(n<2)return{min:t,max:a,mean:(t+a)/2};for(var o=a,r=t,i=0,l=0;l<n;l++){var d=e[l];o=Math.min(o,d),r=Math.max(r,d),i+=d}return{min:o,max:r,mean:i/n}}function r(e){var t=e.detail,a=t.element,n=(0,S.getToolState)(a,U);n&&n.data&&(n.data=[]),a.removeEventListener(M.default.MOUSE_MOVE,c),a.removeEventListener(M.default.MOUSE_DRAG,c),a.removeEventListener(M.default.MOUSE_UP,i),a.removeEventListener(M.default.MOUSE_CLICK,i),a.addEventListener(M.default.MOUSE_DOWN,u)}function i(e){var t=e.detail,a=t.element;a.removeEventListener(M.default.MOUSE_MOVE,c),a.removeEventListener(M.default.MOUSE_DRAG,c),a.removeEventListener(M.default.MOUSE_UP,i),a.removeEventListener(M.default.MOUSE_CLICK,i),a.addEventListener(M.default.MOUSE_DOWN,u);var n=(0,S.getToolState)(t.element,U);n&&n.data&&n.data.length&&(n.data[0].endPoint={x:t.currentPoints.image.x,y:t.currentPoints.image.y},l(t))}function l(e){var t=x.default.cornerstone,a=(0,S.getToolState)(e.element,U);if(a&&a.data&&a.data.length){var n=a.data[0].startPoint,r=a.data[0].endPoint,i=Math.abs(n.x-r.x),l=Math.abs(n.y-r.y),d=Math.min(n.x,r.x),u=Math.min(n.y,r.y);d=Math.max(d,0),d=Math.min(d,e.image.width),u=Math.max(u,0),u=Math.min(u,e.image.height),i=Math.floor(Math.min(i,Math.abs(e.image.width-d))),l=Math.floor(Math.min(l,Math.abs(e.image.height-u)));var s=(0,I.default)(e.element,d,u,i,l),c=o(s,e.image.minPixelValue,e.image.maxPixelValue),f=k.getConfiguration(),v=t.getViewport(e.element);void 0===f.minWindowWidth&&(f.minWindowWidth=10),v.voi.windowWidth=Math.max(Math.abs(c.max-c.min),f.minWindowWidth),v.voi.windowCenter=c.mean,t.setViewport(e.element,v),a.data=[],t.updateImage(e.element)}}function d(e){var t=e.detail,a=t.element;a.removeEventListener(M.default.MOUSE_MOVE,d),a.removeEventListener(M.default.MOUSE_DRAG,d),a.addEventListener(M.default.MOUSE_MOVE,c),a.addEventListener(M.default.MOUSE_DRAG,c),a.addEventListener(M.default.MOUSE_CLICK,i),e.type===M.default.MOUSE_DRAG&&a.addEventListener(M.default.MOUSE_UP,i)}function u(e){var t=e.detail,a=t.element,n=(0,D.getToolOptions)(U,a);if((0,L.default)(t.which,n.mouseButtonMask))return a.addEventListener(M.default.MOUSE_DRAG,d),a.addEventListener(M.default.MOUSE_MOVE,d),a.removeEventListener(M.default.MOUSE_DOWN,u),s(t),!1}function s(e){var t=(0,S.getToolState)(e.element,U);t&&t.data&&(t.data=[]);var a={startPoint:{x:e.currentPoints.image.x,y:e.currentPoints.image.y}};(0,S.addToolState)(e.element,U,a)}function c(e){var t=e.detail,a=t.element,n=(0,S.getToolState)(a,U);n&&n.data&&n.data.length&&(n.data[0].endPoint={x:t.currentPoints.image.x,y:t.currentPoints.image.y},x.default.cornerstone.updateImage(a))}function f(e){var t=e.detail,a=t.element,n=t.canvasContext,o=x.default.cornerstone,r=(0,S.getToolState)(t.element,U);if(r&&r.data&&r.data.length){var i=r.data[0].startPoint,l=r.data[0].endPoint;if(i&&l){n.setTransform(1,0,0,1,0,0);var d=b.default.getActiveColor(),u=o.pixelToCanvas(a,i),s=o.pixelToCanvas(a,l),c=Math.min(u.x,s.x),f=Math.min(u.y,s.y),v=Math.abs(u.x-s.x),m=Math.abs(u.y-s.y),g=P.default.getToolWidth(),h=k.getConfiguration();n.save(),h&&h.shadow&&(n.shadowColor=h.shadowColor||"#000000",n.shadowOffsetX=h.shadowOffsetX||1,n.shadowOffsetY=h.shadowOffsetY||1),n.beginPath(),n.strokeStyle=d,n.lineWidth=g,n.rect(c,f,v,m),n.stroke(),n.restore()}}}function v(e){e.removeEventListener(M.default.MOUSE_DOWN,u),e.removeEventListener(M.default.MOUSE_UP,i),e.removeEventListener(M.default.MOUSE_CLICK,i),e.removeEventListener(M.default.MOUSE_DRAG,c),e.removeEventListener(M.default.MOUSE_MOVE,c),e.removeEventListener(M.default.IMAGE_RENDERED,f),e.removeEventListener(M.default.NEW_IMAGE,r),x.default.cornerstone.updateImage(e)}function m(e,t){if((0,D.setToolOptions)(U,e,{mouseButtonMask:t}),!(0,S.getToolState)(e,U)){var a=[];(0,S.addToolState)(e,U,a)}e.removeEventListener(M.default.MOUSE_DOWN,u),e.removeEventListener(M.default.MOUSE_UP,i),e.removeEventListener(M.default.MOUSE_CLICK,i),e.removeEventListener(M.default.MOUSE_DRAG,c),e.removeEventListener(M.default.MOUSE_MOVE,c),e.removeEventListener(M.default.IMAGE_RENDERED,f),e.removeEventListener(M.default.NEW_IMAGE,r),e.addEventListener(M.default.MOUSE_DOWN,u),e.addEventListener(M.default.IMAGE_RENDERED,f),e.addEventListener(M.default.NEW_IMAGE,r),x.default.cornerstone.updateImage(e)}function g(e){e.removeEventListener(M.default.TOUCH_DRAG,c),e.removeEventListener(M.default.TOUCH_START,s),e.removeEventListener(M.default.TOUCH_DRAG_END,l),e.removeEventListener(M.default.IMAGE_RENDERED,f)}function h(e){if(!(0,S.getToolState)(e,U)){var t=[];(0,S.addToolState)(e,U,t)}e.removeEventListener(M.default.TOUCH_DRAG,c),e.removeEventListener(M.default.TOUCH_START,s),e.removeEventListener(M.default.TOUCH_DRAG_END,l),e.removeEventListener(M.default.IMAGE_RENDERED,f),e.addEventListener(M.default.TOUCH_DRAG,c),e.addEventListener(M.default.TOUCH_START,s),e.addEventListener(M.default.TOUCH_DRAG_END,l),e.addEventListener(M.default.IMAGE_RENDERED,f)}function p(){return A}function E(e){A=e}Object.defineProperty(t,"__esModule",{value:!0}),t.wwwcRegionTouch=t.wwwcRegion=void 0;var T=a(1),M=n(T),y=a(0),x=n(y),O=a(8),P=n(O),_=a(6),b=n(_),S=a(2),C=a(46),I=n(C),w=a(4),L=n(w),D=a(3),U="wwwcRegion",A={minWindowWidth:10},k={activate:m,deactivate:v,disable:v,setConfiguration:E,getConfiguration:p},R={activate:h,deactivate:g,disable:g};t.wwwcRegion=k,t.wwwcRegionTouch=R},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){var a=D.getConfiguration(),n=Math.log(e.scale)/Math.log(1.7),o=n+t,r=Math.pow(1.7,o);return a.maxScale&&r>a.maxScale?e.scale=a.maxScale:a.minScale&&r<a.minScale?e.scale=a.minScale:e.scale=r,e}function r(e,t,a){return e.x=Math.max(e.x,0),e.y=Math.max(e.y,0),e.x=Math.min(e.x,t),e.y=Math.min(e.y,a),e}function i(e,t){if(t.hflip&&(e.x*=-1),t.vflip&&(e.y*=-1),0!==t.rotation){var a=t.rotation*Math.PI/180,n=Math.cos(a),o=Math.sin(a),r=e.x*n-e.y*o,i=e.x*o+e.y*n;e.x=r,e.y=i}return e}function l(e,t){var a=E.default.cornerstone,n=e.element,r=o(e.viewport,t);a.setViewport(n,r);var l=a.pageToPixel(n,e.startPoints.page.x,e.startPoints.page.y),d={x:e.startPoints.image.x-l.x,y:e.startPoints.image.y-l.y};d=i(d,r),r.translation.x-=d.x,r.translation.y-=d.y,a.setViewport(n,r)}function d(e,t){var a=e.element,n=e.image,l=D.getConfiguration(),d=o(e.viewport,t),u={x:0,y:0};if(t<0)d.scale<3&&(Math.abs(d.translation.x)<.01?d.translation.x=0:u.x=d.translation.x/8,Math.abs(d.translation.y)<.01?d.translation.y=0:u.y=d.translation.y/8);else{l&&l.preventZoomOutsideImage&&(L.image=r(L.image,n.width,n.height));var s={x:n.width/2-L.image.x,y:n.height/2-L.image.y};s=i(s,d);var c={x:d.translation.x-s.x,y:d.translation.y-s.y};Math.abs(c.x)<.01?d.translation.x=s.x:u.x=c.x/8,Math.abs(c.y)<.01?d.translation.y=s.y:u.y=c.y/8}d.translation.x-=u.x,d.translation.y-=u.y,E.default.cornerstone.setViewport(a,d)}function u(e,t){var a=e.element,n=o(e.viewport,t);E.default.cornerstone.setViewport(a,n)}function s(e){var t=e.detail,a=t.element;a.removeEventListener(h.default.MOUSE_DRAG,f),a.removeEventListener(h.default.MOUSE_UP,s),a.removeEventListener(h.default.MOUSE_CLICK,s)}function c(e){var t=e.detail,a=t.element,n=(0,I.getToolOptions)(w,a);(0,x.default)(t.which,n.mouseButtonMask)&&(L=t.startPoints,a.addEventListener(h.default.MOUSE_DRAG,f),a.addEventListener(h.default.MOUSE_UP,s),a.addEventListener(h.default.MOUSE_CLICK,s),e.preventDefault(),e.stopPropagation())}function f(e){var t=e.detail;if(!t.deltaPoints.page.y)return!1;var a=t.deltaPoints.page.y/100;D.strategy(t,a),e.preventDefault(),e.stopPropagation()}function v(e){var t=e.detail,a=-t.direction/4,n=D.getConfiguration();n&&n.invert&&(a*=-1);var r=o(t.viewport,a);E.default.cornerstone.setViewport(t.element,r)}function m(e){var t=e.detail,a=E.default.cornerstone,n=D.getConfiguration(),o=t.viewport,r=t.element;o.scale+=t.scaleChange*o.scale,n.maxScale&&o.scale>n.maxScale?o.scale=n.maxScale:n.minScale&&o.scale<n.minScale&&(o.scale=n.minScale),a.setViewport(r,o);var l=a.pageToPixel(r,t.startPoints.page.x,t.startPoints.page.y),d={x:t.startPoints.image.x-l.x,y:t.startPoints.image.y-l.y};d=i(d,o),o.translation.x-=d.x,o.translation.y-=d.y,a.setViewport(r,o)}Object.defineProperty(t,"__esModule",{value:!0}),t.zoomTouchDrag=t.zoomTouchPinch=t.zoomWheel=t.zoom=void 0;var g=a(1),h=n(g),p=a(0),E=n(p),T=a(18),M=n(T),y=a(4),x=n(y),O=a(25),P=n(O),_=a(57),b=n(_),S=a(16),C=n(S),I=a(3),w="zoom",L=void 0,D=(0,M.default)(c,w);D.strategies={default:l,translate:d,zoomToCenter:u},D.strategy=l;var U=(0,P.default)(v),A=(0,b.default)(m),k=(0,C.default)(f,w);t.zoom=D,t.zoomWheel=U,t.zoomTouchPinch=A,t.zoomTouchDrag=k},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e){var t=x.getConfiguration(),a=e.element,n=c.default.cornerstone.getLayer(a,t.brushLayerId),o=n.image,r=o.rows,i=o.columns,l=e.currentPoints.image,d=l.x,u=l.y,s=(0,f.getToolState)(a,E),v=s.data[0].pixelData,m=t.draw,g=t.radius;if(!(d<0||d>i||u<0||u>r)){var T=(0,h.default)(g,r,i,d,u);(0,p.drawBrushPixels)(T,v,m,i),n.invalid=!0,c.default.cornerstone.updateImage(a)}}function r(e){var t=e.detail;M=t.currentPoints.image,y=!1}function i(e){var t=e.detail;o(t),y=!0,M=t.currentPoints.image}function l(e){var t=e.detail;M=t.currentPoints.image,c.default.cornerstone.updateImage(t.element)}function d(e){var t=e.detail;o(t),y=!0,M=t.currentPoints.image}function u(e){var t=e.detail;if(M){var a=t.image,n=a.rows,o=a.columns,r=M,i=r.x,l=r.y;if(!(i<0||i>o||l<0||l>n)){var d=x.getConfiguration(),u=d.radius,s=t.canvasContext,c=y?d.dragColor:d.hoverColor,f=t.element;s.setTransform(1,0,0,1,0,0);var v=(0,h.default)(u,n,o,i,l);(0,p.drawBrushOnCanvas)(v,s,c,f)}}}Object.defineProperty(t,"__esModule",{value:!0}),t.brush=void 0;var s=a(0),c=n(s),f=a(2),v=a(58),m=n(v),g=a(59),h=n(g),p=a(60),E="brush",T={draw:1,radius:3,hoverColor:"green",dragColor:"yellow"},M=void 0,y=!1,x=(0,m.default)({onMouseMove:l,onMouseDown:i,onMouseUp:r,onDrag:d,toolType:"brush",onImageRendered:u});x.setConfiguration(T),t.brush=x},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t,a){var n=C.getConfiguration(),o=n.tolerance,r=Number.MAX_VALUE,i=-Number.MAX_VALUE;e.forEach(function(e){var n=e[1]*a+e[0],o=t[n];r=Math.min(o,r),i=Math.max(o,i)}),_=r-o,P=i+o}function r(e,t,a,n){for(var o=C.getConfiguration(),r=o.draw,i=Math.round(O.x),l=Math.round(O.y),d=null,u=[],s=o.radius;0!==d&&s>o.minRadius;){d=0,u=(0,T.default)(s,a,n,i,l);for(var c=0;c<u.length;c++){var f=u[c][0],v=u[c][1],m=v*n+f,g=e[m];if(g>P||g<_){d++;break}}s--}return 0===d&&(0,M.drawBrushPixels)(u,t,r,n),s}function i(e){var t=C.getConfiguration(),a=e.element,n=m.default.cornerstone.getLayer(a,t.brushLayerId),o=m.default.cornerstone.getLayers(a)[0],i=n.image,l=i.rows,d=i.columns,u=(0,g.getToolState)(a,y),s=u.data[0];b=r(o.image.getPixelData(),s.pixelData,l,d),n.invalid=!0,m.default.cornerstone.updateImage(a)}function l(e){var t=C.getConfiguration(),a=e.element,n=m.default.cornerstone.getLayer(a,t.brushLayerId),o=n.image,r=o.rows,i=o.columns,l=e.currentPoints.image,d=l.x,u=l.y,s=(0,g.getToolState)(a,y),c=s.data[0].pixelData,f=t.draw,v=t.radius;if(!(d<0||d>i||u<0||u>r)){var h=(0,T.default)(v,r,i,d,u);(0,M.drawBrushPixels)(h,c,f,i),n.invalid=!0,m.default.cornerstone.updateImage(a)}}function d(e){var t=e.detail;O=t.currentPoints.image;var a=C.getConfiguration();S=!1,b=a.radius,m.default.cornerstone.updateImage(t.element)}function u(e){var t=e.detail,a=t.element,n=C.getConfiguration(),r=m.default.cornerstone.getLayer(a,n.brushLayerId),d=m.default.cornerstone.getLayers(a)[0],u=t.currentPoints.image,s=u.x,c=u.y,f=r.image,v=f.rows,g=f.columns,h=(0,T.default)(n.radius,v,g,s,c);0===n.draw?l(t):(o(h,d.image.getPixelData(),g),i(t)),S=!0,O=t.currentPoints.image}function s(e){var t=e.detail;O=t.currentPoints.image,m.default.cornerstone.updateImage(t.element)}function c(e){var t=e.detail;0===x.draw?l(t):i(t),S=!0,O=t.currentPoints.image}function f(e){var t=e.detail;if(O){var a=t.image,n=a.rows,o=a.columns,r=O,i=r.x,l=r.y;if(!(i<0||i>o||l<0||l>n)){var d=C.getConfiguration(),u=t.canvasContext,s=S?d.dragColor:d.hoverColor,c=t.element;b=b||d.radius,u.setTransform(1,0,0,1,0,0);var f=(0,T.default)(b,n,o,i,l);(0,M.drawBrushOnCanvas)(f,u,s,c)}}}Object.defineProperty(t,"__esModule",{value:!0}),t.adaptiveBrush=void 0;var v=a(0),m=n(v),g=a(2),h=a(58),p=n(h),E=a(59),T=n(E),M=a(60),y="brush",x={draw:1,radius:3,tolerance:5,minRadius:1,hoverColor:"green",dragColor:"yellow"},O=void 0,P=void 0,_=void 0,b=void 0,S=void 0,C=(0,p.default)({onMouseMove:s,onMouseDown:u,onMouseUp:d,onDrag:c,toolType:"adaptiveBrush",onImageRendered:f});C.setConfiguration(x),t.adaptiveBrush=C},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default="2.1.0"}])});
//# sourceMappingURL=cornerstoneTools.min.js.map